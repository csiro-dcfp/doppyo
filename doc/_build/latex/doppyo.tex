%% Generated by Sphinx.
\def\sphinxdocclass{report}
\documentclass[letterpaper,10pt,english]{sphinxmanual}
\ifdefined\pdfpxdimen
   \let\sphinxpxdimen\pdfpxdimen\else\newdimen\sphinxpxdimen
\fi \sphinxpxdimen=.75bp\relax

\PassOptionsToPackage{warn}{textcomp}
\usepackage[utf8]{inputenc}
\ifdefined\DeclareUnicodeCharacter
% support both utf8 and utf8x syntaxes
  \ifdefined\DeclareUnicodeCharacterAsOptional
    \def\sphinxDUC#1{\DeclareUnicodeCharacter{"#1}}
  \else
    \let\sphinxDUC\DeclareUnicodeCharacter
  \fi
  \sphinxDUC{00A0}{\nobreakspace}
  \sphinxDUC{2500}{\sphinxunichar{2500}}
  \sphinxDUC{2502}{\sphinxunichar{2502}}
  \sphinxDUC{2514}{\sphinxunichar{2514}}
  \sphinxDUC{251C}{\sphinxunichar{251C}}
  \sphinxDUC{2572}{\textbackslash}
\fi
\usepackage{cmap}
\usepackage[T1]{fontenc}
\usepackage{amsmath,amssymb,amstext}
\usepackage{babel}



\usepackage{times}
\expandafter\ifx\csname T@LGR\endcsname\relax
\else
% LGR was declared as font encoding
  \substitutefont{LGR}{\rmdefault}{cmr}
  \substitutefont{LGR}{\sfdefault}{cmss}
  \substitutefont{LGR}{\ttdefault}{cmtt}
\fi
\expandafter\ifx\csname T@X2\endcsname\relax
  \expandafter\ifx\csname T@T2A\endcsname\relax
  \else
  % T2A was declared as font encoding
    \substitutefont{T2A}{\rmdefault}{cmr}
    \substitutefont{T2A}{\sfdefault}{cmss}
    \substitutefont{T2A}{\ttdefault}{cmtt}
  \fi
\else
% X2 was declared as font encoding
  \substitutefont{X2}{\rmdefault}{cmr}
  \substitutefont{X2}{\sfdefault}{cmss}
  \substitutefont{X2}{\ttdefault}{cmtt}
\fi


\usepackage[Bjarne]{fncychap}
\usepackage{sphinx}

\fvset{fontsize=\small}
\usepackage{geometry}

% Include hyperref last.
\usepackage{hyperref}
% Fix anchor placement for figures with captions.
\usepackage{hypcap}% it must be loaded after hyperref.
% Set up styles of URL: it should be placed after hyperref.
\urlstyle{same}
\addto\captionsenglish{\renewcommand{\contentsname}{Contents:}}

\usepackage{sphinxmessages}
\setcounter{tocdepth}{1}



\title{doppyo Documentation}
\date{Apr 02, 2019}
\release{}
\author{Dougie Squire}
\newcommand{\sphinxlogo}{\vbox{}}
\renewcommand{\releasename}{}
\makeindex
\begin{document}

\pagestyle{empty}
\sphinxmaketitle
\pagestyle{plain}
\sphinxtableofcontents
\pagestyle{normal}
\phantomsection\label{\detokenize{index::doc}}



\chapter{What is doppyo?}
\label{\detokenize{overview_doc:what-is-doppyo}}\label{\detokenize{overview_doc::doc}}
doppyo is a diagnostics/verification package for climate forecast systems. It is still in the early stages of development

Three modules are currently available:
\begin{enumerate}
\def\theenumi{\arabic{enumi}}
\def\labelenumi{\theenumi .}
\makeatletter\def\p@enumii{\p@enumi \theenumi .}\makeatother
\item {} 
\sphinxcode{\sphinxupquote{skill}} : functions for assessing one data set relative to another, usually model output(s) relative to observations or reanalyses

\item {} 
\sphinxcode{\sphinxupquote{diagnostic}} : functions for computing various atmospheric and oceanic diagnostics

\item {} 
\sphinxcode{\sphinxupquote{utils}} : general support and utility functions for the doppyo package

\end{enumerate}


\chapter{Installation}
\label{\detokenize{installation_doc:installation}}\label{\detokenize{installation_doc::doc}}
Need to host doppyo on public repo and provide instructions for installation


\chapter{Modules}
\label{\detokenize{modules_doc:modules}}\label{\detokenize{modules_doc::doc}}

\section{\sphinxstyleliteralintitle{\sphinxupquote{diagnostic}}}
\label{\detokenize{diagnostic_doc:module-diagnostic}}\label{\detokenize{diagnostic_doc:diagnostic}}\label{\detokenize{diagnostic_doc::doc}}\index{diagnostic (module)@\spxentry{diagnostic}\spxextra{module}}
doppyo functions for computing various ocean, atmosphere, \& climate diagnostics


\subsection{API}
\label{\detokenize{diagnostic_doc:api}}\index{velocity\_potential() (in module diagnostic)@\spxentry{velocity\_potential()}\spxextra{in module diagnostic}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{diagnostic_doc:diagnostic.velocity_potential}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{diagnostic.}}\sphinxbfcode{\sphinxupquote{velocity\_potential}}}{\emph{u}, \emph{v}, \emph{lat\_name=None}, \emph{lon\_name=None}}{}
Returns the velocity potential given fields of u and v

\begin{DUlineblock}{0em}
\item[] Author: Dougie Squire
\item[] Date: 11/07/2018
\end{DUlineblock}
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{description}
\item[{\sphinxstylestrong{u}}] \leavevmode{[}xarray DataArray{]}
Array containing fields of zonal velocity with at least coordinates latitude and longitude                     (following standard naming - see Notes)

\item[{\sphinxstylestrong{v}}] \leavevmode{[}xarray DataArray{]}
Array containing fields of meridional velocity with at least coordinates latitude and                     longitude (following standard naming - see Notes)

\item[{\sphinxstylestrong{lat\_name}}] \leavevmode{[}str, optional{]}
Name of latitude coordinate. If None, doppyo will attempt to determine lat\_name                     automatically

\item[{\sphinxstylestrong{lon\_name}}] \leavevmode{[}str, optional{]}
Name of longitude coordinate. If None, doppyo will attempt to determine lon\_name                     automatically

\end{description}

\item[{Returns}] \leavevmode\begin{description}
\item[{\sphinxstylestrong{velocity\_potential}}] \leavevmode{[}xarray DataArray{]}
Array containing values of velocity potential

\end{description}

\end{description}\end{quote}
\subsubsection*{Notes}

\begin{DUlineblock}{0em}
\item[] All input array coordinates must follow standard naming (see \sphinxcode{\sphinxupquote{doppyo.utils.get\_lat\_name()}},                 \sphinxcode{\sphinxupquote{doppyo.utils.get\_lon\_name()}}, etc)
\item[] This function utilises the windspharm package, which is a wrapper on pyspharm, which is a                 wrapper on SPHEREPACK. These packages require that the latitudinal and longitudinal grid                 is regular or Gaussian.
\item[] These calculations are not yet dask-compatible.
\end{DUlineblock}

To Do
\begin{itemize}
\item {} 
Make dask-compatible by either developing the windspharm package, or using a kernel approach

\end{itemize}
\subsubsection*{Examples}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{u} \PYG{o}{=} \PYG{n}{xr}\PYG{o}{.}\PYG{n}{DataArray}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{random}\PYG{o}{.}\PYG{n}{normal}\PYG{p}{(}\PYG{n}{size}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{6}\PYG{p}{,}\PYG{l+m+mi}{4}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} 
\PYG{g+gp}{... }                 \PYG{n}{coords}\PYG{o}{=}\PYG{p}{[}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{lat}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{75}\PYG{p}{,}\PYG{l+m+mi}{76}\PYG{p}{,}\PYG{l+m+mi}{30}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{lon}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{45}\PYG{p}{,}\PYG{l+m+mi}{316}\PYG{p}{,}\PYG{l+m+mi}{90}\PYG{p}{)}\PYG{p}{)}\PYG{p}{]}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{v} \PYG{o}{=} \PYG{n}{xr}\PYG{o}{.}\PYG{n}{DataArray}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{random}\PYG{o}{.}\PYG{n}{normal}\PYG{p}{(}\PYG{n}{size}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{6}\PYG{p}{,}\PYG{l+m+mi}{4}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} 
\PYG{g+gp}{... }                 \PYG{n}{coords}\PYG{o}{=}\PYG{p}{[}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{lat}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{75}\PYG{p}{,}\PYG{l+m+mi}{76}\PYG{p}{,}\PYG{l+m+mi}{30}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{lon}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{45}\PYG{p}{,}\PYG{l+m+mi}{316}\PYG{p}{,}\PYG{l+m+mi}{90}\PYG{p}{)}\PYG{p}{)}\PYG{p}{]}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{doppyo}\PYG{o}{.}\PYG{n}{diagnostic}\PYG{o}{.}\PYG{n}{velocity\PYGZus{}potential}\PYG{p}{(}\PYG{n}{u}\PYG{p}{,} \PYG{n}{v}\PYG{p}{)}
\PYG{g+go}{\PYGZlt{}xarray.DataArray \PYGZsq{}velocity\PYGZus{}potential\PYGZsq{} (lat: 6, lon: 4)\PYGZgt{}}
\PYG{g+go}{array([[  431486.75 ,   431486.75 ,   431486.75 ,   431486.75 ],}
\PYG{g+go}{       [ \PYGZhy{}240990.94 , \PYGZhy{}3553409.   ,  \PYGZhy{}970673.56 ,  2341744.5  ],}
\PYG{g+go}{       [ 3338223.5  ,  1497203.9  , \PYGZhy{}1723363.2  ,   117656.31 ],}
\PYG{g+go}{       [ 1009613.5  ,  1571693.6  ,   326689.3  ,  \PYGZhy{}235390.69 ],}
\PYG{g+go}{       [ \PYGZhy{}931064.8  ,  \PYGZhy{}124736.375, \PYGZhy{}2516887.8  , \PYGZhy{}3323216.   ],}
\PYG{g+go}{       [\PYGZhy{}1526244.   , \PYGZhy{}1526244.   , \PYGZhy{}1526244.   , \PYGZhy{}1526244.   ]], dtype=float32)}
\PYG{g+go}{Coordinates:}
\PYG{g+go}{  * lat      (lat) int64 75 45 15 \PYGZhy{}15 \PYGZhy{}45 \PYGZhy{}75}
\PYG{g+go}{  * lon      (lon) int64 45 135 225 315}
\PYG{g+go}{Attributes:}
\PYG{g+go}{    units:          m**2 s**\PYGZhy{}1}
\PYG{g+go}{    standard\PYGZus{}name:  atmosphere\PYGZus{}horizontal\PYGZus{}velocity\PYGZus{}potential}
\PYG{g+go}{    long\PYGZus{}name:      velocity potential}
\end{sphinxVerbatim}

\end{fulllineitems}

\index{stream\_function() (in module diagnostic)@\spxentry{stream\_function()}\spxextra{in module diagnostic}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{diagnostic_doc:diagnostic.stream_function}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{diagnostic.}}\sphinxbfcode{\sphinxupquote{stream\_function}}}{\emph{u}, \emph{v}, \emph{lat\_name=None}, \emph{lon\_name=None}}{}
Returns the stream function given fields of u and v

\begin{DUlineblock}{0em}
\item[] Author: Dougie Squire
\item[] Date: 11/07/2018
\end{DUlineblock}
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{description}
\item[{\sphinxstylestrong{u}}] \leavevmode{[}xarray DataArray{]}
Array containing fields of zonal velocity with at least coordinates latitude and longitude                     (following standard naming - see Notes)

\item[{\sphinxstylestrong{v}}] \leavevmode{[}xarray DataArray{]}
Array containing fields of meridional velocity with at least coordinates latitude and                     longitude (following standard naming - see Notes)

\item[{\sphinxstylestrong{lat\_name}}] \leavevmode{[}str, optional{]}
Name of latitude coordinate. If None, doppyo will attempt to determine lat\_name                     automatically

\item[{\sphinxstylestrong{lon\_name}}] \leavevmode{[}str, optional{]}
Name of longitude coordinate. If None, doppyo will attempt to determine lon\_name                     automatically

\end{description}

\item[{Returns}] \leavevmode\begin{description}
\item[{\sphinxstylestrong{stream\_function}}] \leavevmode{[}xarray DataArray{]}
Array containing values of stream function

\end{description}

\end{description}\end{quote}
\subsubsection*{Notes}

\begin{DUlineblock}{0em}
\item[] All input array coordinates must follow standard naming (see \sphinxcode{\sphinxupquote{doppyo.utils.get\_lat\_name()}},                 \sphinxcode{\sphinxupquote{doppyo.utils.get\_lon\_name()}}, etc)
\item[] This function utilises the windspharm package, which is a wrapper on pyspharm, which is a                 wrapper on SPHEREPACK. These packages require that the latitudinal and longitudinal grid                 is regular or Gaussian.
\item[] These calculations are not yet dask-compatible.
\end{DUlineblock}

To Do
\begin{itemize}
\item {} 
Make dask-compatible by either developing the windspharm package, or using a kernel approach

\end{itemize}
\subsubsection*{Examples}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{u} \PYG{o}{=} \PYG{n}{xr}\PYG{o}{.}\PYG{n}{DataArray}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{random}\PYG{o}{.}\PYG{n}{normal}\PYG{p}{(}\PYG{n}{size}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{6}\PYG{p}{,}\PYG{l+m+mi}{4}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} 
\PYG{g+gp}{... }                 \PYG{n}{coords}\PYG{o}{=}\PYG{p}{[}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{lat}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{75}\PYG{p}{,}\PYG{l+m+mi}{76}\PYG{p}{,}\PYG{l+m+mi}{30}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{lon}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{45}\PYG{p}{,}\PYG{l+m+mi}{316}\PYG{p}{,}\PYG{l+m+mi}{90}\PYG{p}{)}\PYG{p}{)}\PYG{p}{]}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{v} \PYG{o}{=} \PYG{n}{xr}\PYG{o}{.}\PYG{n}{DataArray}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{random}\PYG{o}{.}\PYG{n}{normal}\PYG{p}{(}\PYG{n}{size}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{6}\PYG{p}{,}\PYG{l+m+mi}{4}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} 
\PYG{g+gp}{... }                 \PYG{n}{coords}\PYG{o}{=}\PYG{p}{[}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{lat}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{75}\PYG{p}{,}\PYG{l+m+mi}{76}\PYG{p}{,}\PYG{l+m+mi}{30}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{lon}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{45}\PYG{p}{,}\PYG{l+m+mi}{316}\PYG{p}{,}\PYG{l+m+mi}{90}\PYG{p}{)}\PYG{p}{)}\PYG{p}{]}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{doppyo}\PYG{o}{.}\PYG{n}{diagnostic}\PYG{o}{.}\PYG{n}{stream\PYGZus{}function}\PYG{p}{(}\PYG{n}{u}\PYG{p}{,} \PYG{n}{v}\PYG{p}{)}
\PYG{g+go}{\PYGZlt{}xarray.DataArray \PYGZsq{}psi\PYGZsq{} (lat: 6, lon: 4)\PYGZgt{}}
\PYG{g+go}{array([[ \PYGZhy{}690643.6 ,  \PYGZhy{}690643.6 ,  \PYGZhy{}690643.6 ,  \PYGZhy{}690643.6 ],}
\PYG{g+go}{       [\PYGZhy{}2041977.8 , \PYGZhy{}1060127.  , \PYGZhy{}3052305.8 , \PYGZhy{}4034156.5 ],}
\PYG{g+go}{       [ 4112389.2 ,  4630193.5 , \PYGZhy{}5212595.5 , \PYGZhy{}5730399.5 ],}
\PYG{g+go}{       [  528500.75,  4670647.5 ,  2589393.  , \PYGZhy{}1552753.9 ],}
\PYG{g+go}{       [\PYGZhy{}2686391.2 ,  \PYGZhy{}707369.25,  4204334.  ,  2225311.5 ],}
\PYG{g+go}{       [ 1703481.9 ,  1703481.9 ,  1703481.9 ,  1703481.9 ]], dtype=float32)}
\PYG{g+go}{Coordinates:}
\PYG{g+go}{  * lat      (lat) int64 75 45 15 \PYGZhy{}15 \PYGZhy{}45 \PYGZhy{}75}
\PYG{g+go}{  * lon      (lon) int64 45 135 225 315}
\PYG{g+go}{Attributes:}
\PYG{g+go}{    units:          m**2 s**\PYGZhy{}1}
\PYG{g+go}{    standard\PYGZus{}name:  atmosphere\PYGZus{}horizontal\PYGZus{}streamfunction}
\PYG{g+go}{    long\PYGZus{}name:      streamfunction}
\end{sphinxVerbatim}

\end{fulllineitems}

\index{Rossby\_wave\_source() (in module diagnostic)@\spxentry{Rossby\_wave\_source()}\spxextra{in module diagnostic}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{diagnostic_doc:diagnostic.Rossby_wave_source}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{diagnostic.}}\sphinxbfcode{\sphinxupquote{Rossby\_wave\_source}}}{\emph{u}, \emph{v}, \emph{lat\_name=None}, \emph{lon\_name=None}}{}
Returns the Rossby wave source given fields of u and v

\begin{DUlineblock}{0em}
\item[] Author: Dougie Squire
\item[] Date: 11/07/2018
\end{DUlineblock}
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{description}
\item[{\sphinxstylestrong{u}}] \leavevmode{[}xarray DataArray{]}
Array containing fields of zonal velocity with at least coordinates latitude and longitude                     (following standard naming - see Notes)

\item[{\sphinxstylestrong{v}}] \leavevmode{[}xarray DataArray{]}
Array containing fields of meridional velocity with at least coordinates latitude and                     longitude (following standard naming - see Notes)

\item[{\sphinxstylestrong{lat\_name}}] \leavevmode{[}str, optional{]}
Name of latitude coordinate. If None, doppyo will attempt to determine lat\_name                     automatically

\item[{\sphinxstylestrong{lon\_name}}] \leavevmode{[}str, optional{]}
Name of longitude coordinate. If None, doppyo will attempt to determine lon\_name                     automatically

\end{description}

\item[{Returns}] \leavevmode\begin{description}
\item[{\sphinxstylestrong{Rossby\_wave\_source}}] \leavevmode{[}xarray DataArray{]}
Array containing values of Rossby wave source

\end{description}

\end{description}\end{quote}
\subsubsection*{Notes}

\begin{DUlineblock}{0em}
\item[] All input array coordinates must follow standard naming (see \sphinxcode{\sphinxupquote{doppyo.utils.get\_lat\_name()}},                 \sphinxcode{\sphinxupquote{doppyo.utils.get\_lon\_name()}}, etc)
\item[] This function utilises the windspharm package, which is a wrapper on pyspharm, which is a                 wrapper on SPHEREPACK. These packages require that the latitudinal and longitudinal grid                 is regular or Gaussian.
\item[] These calculations are not yet dask-compatible.
\end{DUlineblock}

To Do
\begin{itemize}
\item {} 
Make dask-compatible by either developing the windspharm package, or using a kernel approach

\end{itemize}
\subsubsection*{Examples}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{u} \PYG{o}{=} \PYG{n}{xr}\PYG{o}{.}\PYG{n}{DataArray}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{random}\PYG{o}{.}\PYG{n}{normal}\PYG{p}{(}\PYG{n}{size}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{6}\PYG{p}{,}\PYG{l+m+mi}{4}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} 
\PYG{g+gp}{... }                 \PYG{n}{coords}\PYG{o}{=}\PYG{p}{[}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{lat}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{75}\PYG{p}{,}\PYG{l+m+mi}{76}\PYG{p}{,}\PYG{l+m+mi}{30}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{lon}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{45}\PYG{p}{,}\PYG{l+m+mi}{316}\PYG{p}{,}\PYG{l+m+mi}{90}\PYG{p}{)}\PYG{p}{)}\PYG{p}{]}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{v} \PYG{o}{=} \PYG{n}{xr}\PYG{o}{.}\PYG{n}{DataArray}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{random}\PYG{o}{.}\PYG{n}{normal}\PYG{p}{(}\PYG{n}{size}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{6}\PYG{p}{,}\PYG{l+m+mi}{4}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} 
\PYG{g+gp}{... }                 \PYG{n}{coords}\PYG{o}{=}\PYG{p}{[}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{lat}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{75}\PYG{p}{,}\PYG{l+m+mi}{76}\PYG{p}{,}\PYG{l+m+mi}{30}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{lon}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{45}\PYG{p}{,}\PYG{l+m+mi}{316}\PYG{p}{,}\PYG{l+m+mi}{90}\PYG{p}{)}\PYG{p}{)}\PYG{p}{]}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{doppyo}\PYG{o}{.}\PYG{n}{diagnostic}\PYG{o}{.}\PYG{n}{Rossby\PYGZus{}wave\PYGZus{}source}\PYG{p}{(}\PYG{n}{u}\PYG{p}{,} \PYG{n}{v}\PYG{p}{)}
\PYG{g+go}{\PYGZlt{}xarray.DataArray \PYGZsq{}rws\PYGZsq{} (lat: 6, lon: 4)\PYGZgt{}}
\PYG{g+go}{array([[ 4.382918,  4.382918,  4.382918,  4.382918],}
\PYG{g+go}{       [\PYGZhy{}2.226769,  5.020311, \PYGZhy{}2.600087, \PYGZhy{}9.838818],}
\PYG{g+go}{       [ 2.1693  , \PYGZhy{}2.133569,  0.498156,  4.818402],}
\PYG{g+go}{       [\PYGZhy{}1.404836,  0.192032,  0.112654, \PYGZhy{}1.494616],}
\PYG{g+go}{       [\PYGZhy{}0.103261,  4.518184,  0.648616, \PYGZhy{}4.05276 ],}
\PYG{g+go}{       [ 4.070806,  4.070806,  4.070806,  4.070806]])}
\PYG{g+go}{Coordinates:}
\PYG{g+go}{  * lat      (lat) int64 75 45 15 \PYGZhy{}15 \PYGZhy{}45 \PYGZhy{}75}
\PYG{g+go}{  * lon      (lon) int64 45 135 225 315}
\PYG{g+go}{Attributes:}
\PYG{g+go}{    units:      1e\PYGZhy{}11/s\PYGZca{}2}
\PYG{g+go}{    long\PYGZus{}name:  Rossby wave source}
\end{sphinxVerbatim}

\end{fulllineitems}

\index{divergent() (in module diagnostic)@\spxentry{divergent()}\spxextra{in module diagnostic}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{diagnostic_doc:diagnostic.divergent}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{diagnostic.}}\sphinxbfcode{\sphinxupquote{divergent}}}{\emph{u}, \emph{v}, \emph{lat\_name=None}, \emph{lon\_name=None}}{}
Returns the irrotational (divergent) component of u and v

\begin{DUlineblock}{0em}
\item[] Author: Dougie Squire
\item[] Date: 11/07/2018
\end{DUlineblock}
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{description}
\item[{\sphinxstylestrong{u}}] \leavevmode{[}xarray DataArray{]}
Array containing fields of zonal velocity with at least coordinates latitude and longitude                     (following standard naming - see Notes)

\item[{\sphinxstylestrong{v}}] \leavevmode{[}xarray DataArray{]}
Array containing fields of meridional velocity with at least coordinates latitude and                     longitude (following standard naming - see Notes)

\item[{\sphinxstylestrong{lat\_name}}] \leavevmode{[}str, optional{]}
Name of latitude coordinate. If None, doppyo will attempt to determine lat\_name                     automatically

\item[{\sphinxstylestrong{lon\_name}}] \leavevmode{[}str, optional{]}
Name of longitude coordinate. If None, doppyo will attempt to determine lon\_name                     automatically

\end{description}

\item[{Returns}] \leavevmode\begin{description}
\item[{\sphinxstylestrong{divergent}}] \leavevmode{[}xarray Dataset{]}
\begin{DUlineblock}{0em}
\item[] Dataset containing the following variables:
\item[] u\_chi; array containing the irrotational component of u
\item[] v\_chi; array containing the irrotational component of v
\end{DUlineblock}

\end{description}

\end{description}\end{quote}
\subsubsection*{Notes}

\begin{DUlineblock}{0em}
\item[] All input array coordinates must follow standard naming (see \sphinxcode{\sphinxupquote{doppyo.utils.get\_lat\_name()}},                 \sphinxcode{\sphinxupquote{doppyo.utils.get\_lon\_name()}}, etc)
\item[] This function utilises the windspharm package, which is a wrapper on pyspharm, which is a                 wrapper on SPHEREPACK. These packages require that the latitudinal and longitudinal grid                 is regular or Gaussian.
\item[] These calculations are not yet dask-compatible.
\end{DUlineblock}

To Do
\begin{itemize}
\item {} 
Make dask-compatible by either developing the windspharm package, or using a kernel approach

\end{itemize}
\subsubsection*{Examples}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{u} \PYG{o}{=} \PYG{n}{xr}\PYG{o}{.}\PYG{n}{DataArray}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{random}\PYG{o}{.}\PYG{n}{normal}\PYG{p}{(}\PYG{n}{size}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{6}\PYG{p}{,}\PYG{l+m+mi}{4}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} 
\PYG{g+gp}{... }                 \PYG{n}{coords}\PYG{o}{=}\PYG{p}{[}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{lat}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{75}\PYG{p}{,}\PYG{l+m+mi}{76}\PYG{p}{,}\PYG{l+m+mi}{30}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{lon}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{45}\PYG{p}{,}\PYG{l+m+mi}{316}\PYG{p}{,}\PYG{l+m+mi}{90}\PYG{p}{)}\PYG{p}{)}\PYG{p}{]}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{v} \PYG{o}{=} \PYG{n}{xr}\PYG{o}{.}\PYG{n}{DataArray}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{random}\PYG{o}{.}\PYG{n}{normal}\PYG{p}{(}\PYG{n}{size}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{6}\PYG{p}{,}\PYG{l+m+mi}{4}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} 
\PYG{g+gp}{... }                 \PYG{n}{coords}\PYG{o}{=}\PYG{p}{[}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{lat}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{75}\PYG{p}{,}\PYG{l+m+mi}{76}\PYG{p}{,}\PYG{l+m+mi}{30}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{lon}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{45}\PYG{p}{,}\PYG{l+m+mi}{316}\PYG{p}{,}\PYG{l+m+mi}{90}\PYG{p}{)}\PYG{p}{)}\PYG{p}{]}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{doppyo}\PYG{o}{.}\PYG{n}{diagnostic}\PYG{o}{.}\PYG{n}{divergent}\PYG{p}{(}\PYG{n}{u}\PYG{p}{,} \PYG{n}{v}\PYG{p}{)}
\PYG{g+go}{\PYGZlt{}xarray.Dataset\PYGZgt{}}
\PYG{g+go}{Dimensions:  (lat: 6, lon: 4)}
\PYG{g+go}{Coordinates:}
\PYG{g+go}{  * lat      (lat) int64 75 45 15 \PYGZhy{}15 \PYGZhy{}45 \PYGZhy{}75}
\PYG{g+go}{  * lon      (lon) int64 45 135 225 315}
\PYG{g+go}{Data variables:}
\PYG{g+go}{    u\PYGZus{}chi     (lat, lon) float32 0.5355302 \PYGZhy{}0.45865965 ... \PYGZhy{}0.7270669 \PYGZhy{}0.64930713}
\PYG{g+go}{    v\PYGZus{}chi     (lat, lon) float32 \PYGZhy{}0.45865965 \PYGZhy{}0.5355302 ... 0.64930713 \PYGZhy{}0.7270669}
\end{sphinxVerbatim}

\end{fulllineitems}

\index{wave\_activity\_flux() (in module diagnostic)@\spxentry{wave\_activity\_flux()}\spxextra{in module diagnostic}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{diagnostic_doc:diagnostic.wave_activity_flux}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{diagnostic.}}\sphinxbfcode{\sphinxupquote{wave\_activity\_flux}}}{\emph{psi\_anom}, \emph{u}, \emph{v}, \emph{plevel=None}, \emph{lat\_name=None}, \emph{lon\_name=None}}{}
Returns the stationary component of the wave activity flux, following Takaya and Nakamura,                 (2001) using zonal and meridional velocity fields on one or more isobaric surface(s)

\begin{DUlineblock}{0em}
\item[] Author: Dougie Squire
\item[] Date: 11/07/2018
\end{DUlineblock}
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{description}
\item[{\sphinxstylestrong{psi\_anom}}] \leavevmode{[}xarray DataArray{]}
Array containing fields of stream function anomalies with at least coordinates latitude                     and longitude (following standard naming - see Notes)

\item[{\sphinxstylestrong{u}}] \leavevmode{[}xarray DataArray{]}
Array containing fields of zonal velocity with at least coordinates latitude and longitude                     (following standard naming - see Notes)

\item[{\sphinxstylestrong{v}}] \leavevmode{[}xarray DataArray{]}
Array containing fields of meridional velocity with at least coordinates latitude and                     longitude (following standard naming - see Notes)

\item[{\sphinxstylestrong{plevel}}] \leavevmode{[}value, optional{]}
Value of the pressure level corresponding to the provided arrays. If None, pressure                     level(s) are extracted from the psi\_anom/u/v coordinate. Pressure levels must be provided                     in units of hPa

\item[{\sphinxstylestrong{lat\_name}}] \leavevmode{[}str, optional{]}
Name of latitude coordinate. If None, doppyo will attempt to determine lat\_name                     automatically

\item[{\sphinxstylestrong{lon\_name}}] \leavevmode{[}str, optional{]}
Name of longitude coordinate. If None, doppyo will attempt to determine lon\_name                     automatically

\end{description}

\item[{Returns}] \leavevmode\begin{description}
\item[{\sphinxstylestrong{wave\_activity\_flux}}] \leavevmode{[}xarray Dataset{]}
\begin{DUlineblock}{0em}
\item[] Dataset containing the following variables:
\item[] u\_waf; array containing the zonal component of the wave activity flux
\item[] v\_waf; array containing the meridonal component of the wave activity flux
\end{DUlineblock}

\end{description}

\end{description}\end{quote}
\subsubsection*{Notes}

\begin{DUlineblock}{0em}
\item[] All input array coordinates must follow standard naming (see \sphinxcode{\sphinxupquote{doppyo.utils.get\_lat\_name()}},                 \sphinxcode{\sphinxupquote{doppyo.utils.get\_lon\_name()}}, etc)
\item[] Pressure levels must be provided in units of hPa
\item[] This function utilises the windspharm package, which is a wrapper on pyspharm, which is a                 wrapper on SPHEREPACK. These packages require that the latitudinal and longitudinal grid                 is regular or Gaussian.
\item[] These calculations are not yet dask-compatible
\end{DUlineblock}

To Do
\begin{itemize}
\item {} 
Make dask-compatible by either developing the windspharm package, or using a kernel approach

\end{itemize}
\subsubsection*{Examples}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{u} \PYG{o}{=} \PYG{n}{xr}\PYG{o}{.}\PYG{n}{DataArray}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{random}\PYG{o}{.}\PYG{n}{normal}\PYG{p}{(}\PYG{n}{size}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{6}\PYG{p}{,}\PYG{l+m+mi}{4}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{24}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} 
\PYG{g+gp}{... }                 \PYG{n}{coords}\PYG{o}{=}\PYG{p}{[}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{lat}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{75}\PYG{p}{,}\PYG{l+m+mi}{76}\PYG{p}{,}\PYG{l+m+mi}{30}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{lon}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{45}\PYG{p}{,}\PYG{l+m+mi}{316}\PYG{p}{,}\PYG{l+m+mi}{90}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} 
\PYG{g+gp}{... }                         \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{level}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{p}{[}\PYG{l+m+mi}{100}\PYG{p}{,}\PYG{l+m+mi}{500}\PYG{p}{]}\PYG{p}{)}\PYG{p}{,} 
\PYG{g+gp}{... }                         \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{time}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{pd}\PYG{o}{.}\PYG{n}{date\PYGZus{}range}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{2000\PYGZhy{}01\PYGZhy{}01}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{periods}\PYG{o}{=}\PYG{l+m+mi}{24}\PYG{p}{,}\PYG{n}{freq}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{M}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{p}{)}\PYG{p}{]}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{v} \PYG{o}{=} \PYG{n}{xr}\PYG{o}{.}\PYG{n}{DataArray}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{random}\PYG{o}{.}\PYG{n}{normal}\PYG{p}{(}\PYG{n}{size}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{6}\PYG{p}{,}\PYG{l+m+mi}{4}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{24}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} 
\PYG{g+gp}{... }                 \PYG{n}{coords}\PYG{o}{=}\PYG{p}{[}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{lat}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{75}\PYG{p}{,}\PYG{l+m+mi}{76}\PYG{p}{,}\PYG{l+m+mi}{30}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{lon}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{45}\PYG{p}{,}\PYG{l+m+mi}{316}\PYG{p}{,}\PYG{l+m+mi}{90}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} 
\PYG{g+gp}{... }                         \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{level}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{p}{[}\PYG{l+m+mi}{100}\PYG{p}{,}\PYG{l+m+mi}{500}\PYG{p}{]}\PYG{p}{)}\PYG{p}{,} 
\PYG{g+gp}{... }                         \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{time}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{pd}\PYG{o}{.}\PYG{n}{date\PYGZus{}range}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{2000\PYGZhy{}01\PYGZhy{}01}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{periods}\PYG{o}{=}\PYG{l+m+mi}{24}\PYG{p}{,}\PYG{n}{freq}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{M}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{p}{)}\PYG{p}{]}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{u\PYGZus{}clim} \PYG{o}{=} \PYG{n}{u}\PYG{o}{.}\PYG{n}{groupby}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{time.month}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{o}{.}\PYG{n}{mean}\PYG{p}{(}\PYG{n}{dim}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{time}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{v\PYGZus{}clim} \PYG{o}{=} \PYG{n}{v}\PYG{o}{.}\PYG{n}{groupby}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{time.month}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{o}{.}\PYG{n}{mean}\PYG{p}{(}\PYG{n}{dim}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{time}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{u\PYGZus{}anom} \PYG{o}{=} \PYG{n}{doppyo}\PYG{o}{.}\PYG{n}{utils}\PYG{o}{.}\PYG{n}{anomalize}\PYG{p}{(}\PYG{n}{u}\PYG{p}{,} \PYG{n}{u\PYGZus{}clim}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{v\PYGZus{}anom} \PYG{o}{=} \PYG{n}{doppyo}\PYG{o}{.}\PYG{n}{utils}\PYG{o}{.}\PYG{n}{anomalize}\PYG{p}{(}\PYG{n}{v}\PYG{p}{,} \PYG{n}{v\PYGZus{}clim}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{psi\PYGZus{}anom} \PYG{o}{=} \PYG{n}{doppyo}\PYG{o}{.}\PYG{n}{diagnostic}\PYG{o}{.}\PYG{n}{stream\PYGZus{}function}\PYG{p}{(}\PYG{n}{u\PYGZus{}anom}\PYG{p}{,} \PYG{n}{v\PYGZus{}anom}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{doppyo}\PYG{o}{.}\PYG{n}{diagnostic}\PYG{o}{.}\PYG{n}{wave\PYGZus{}activity\PYGZus{}flux}\PYG{p}{(}\PYG{n}{psi\PYGZus{}anom}\PYG{p}{,} \PYG{n}{u}\PYG{p}{,} \PYG{n}{v}\PYG{p}{)}
\PYG{g+go}{\PYGZlt{}xarray.Dataset\PYGZgt{}}
\PYG{g+go}{Dimensions:  (lat: 6, level: 2, lon: 4, time: 24)}
\PYG{g+go}{Coordinates:}
\PYG{g+go}{  * level    (level) int64 100 500}
\PYG{g+go}{  * lat      (lat) int64 \PYGZhy{}75 \PYGZhy{}45 \PYGZhy{}15 15 45 75}
\PYG{g+go}{  * lon      (lon) int64 45 135 225 315}
\PYG{g+go}{  * time     (time) datetime64[ns] 2000\PYGZhy{}01\PYGZhy{}31 2000\PYGZhy{}02\PYGZhy{}29 ... 2001\PYGZhy{}12\PYGZhy{}31}
\PYG{g+go}{Data variables:}
\PYG{g+go}{    u\PYGZus{}waf     (level, lat, lon, time) float64 0.003852 0.0001439 ... \PYGZhy{}0.06913}
\PYG{g+go}{    v\PYGZus{}waf     (level, lat, lon, time) float64 0.01495 3.032e\PYGZhy{}05 ... 0.02944}
\end{sphinxVerbatim}

\end{fulllineitems}

\index{Brunt\_Vaisala() (in module diagnostic)@\spxentry{Brunt\_Vaisala()}\spxextra{in module diagnostic}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{diagnostic_doc:diagnostic.Brunt_Vaisala}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{diagnostic.}}\sphinxbfcode{\sphinxupquote{Brunt\_Vaisala}}}{\emph{temp}, \emph{plevel\_name=None}}{}
Returns the Brunt Väisälä frequency

\begin{DUlineblock}{0em}
\item[] Author: Dougie Squire
\item[] Date: 15/07/2018
\end{DUlineblock}
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{description}
\item[{\sphinxstylestrong{temp}}] \leavevmode{[}xarray DataArray{]}
Array containing fields of temperature with at least coordinates latitude, longitude and                     pressure level (following standard naming - see Notes)

\item[{\sphinxstylestrong{plevel\_name}}] \leavevmode{[}str, optional{]}
Name of pressure level coordinate. If None, doppyo will attempt to determine plevel\_name                     automatically

\end{description}

\item[{Returns}] \leavevmode\begin{description}
\item[{\sphinxstylestrong{nsq}}] \leavevmode{[}xarray DataArray{]}
Array with same dimensions as input arrays containing the Brunt Väisälä frequency

\end{description}

\end{description}\end{quote}
\subsubsection*{Notes}

\begin{DUlineblock}{0em}
\item[] All input array coordinates must follow standard naming (see \sphinxcode{\sphinxupquote{doppyo.utils.get\_lat\_name()}},                 \sphinxcode{\sphinxupquote{doppyo.utils.get\_lon\_name()}}, etc)
\item[] Pressure levels must be provided in units of hPa
\end{DUlineblock}

To do
\begin{itemize}
\item {} 
Add switch for atmosphere/ocean input

\end{itemize}
\subsubsection*{Examples}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{temp} \PYG{o}{=} \PYG{n}{xr}\PYG{o}{.}\PYG{n}{DataArray}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{random}\PYG{o}{.}\PYG{n}{normal}\PYG{p}{(}\PYG{n}{size}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{4}\PYG{p}{,}\PYG{l+m+mi}{4}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} 
\PYG{g+gp}{... }                    \PYG{n}{coords}\PYG{o}{=}\PYG{p}{[}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{lat}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{90}\PYG{p}{,}\PYG{l+m+mi}{90}\PYG{p}{,}\PYG{l+m+mi}{45}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{lon}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{l+m+mi}{360}\PYG{p}{,}\PYG{l+m+mi}{90}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} 
\PYG{g+gp}{... }                            \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{level}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{p}{[}\PYG{l+m+mi}{100}\PYG{p}{,}\PYG{l+m+mi}{200}\PYG{p}{]}\PYG{p}{)}\PYG{p}{]}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{doppyo}\PYG{o}{.}\PYG{n}{diagnostic}\PYG{o}{.}\PYG{n}{Brunt\PYGZus{}Vaisala}\PYG{p}{(}\PYG{n}{temp}\PYG{p}{)}
\PYG{g+go}{\PYGZlt{}xarray.DataArray \PYGZsq{}nsq\PYGZsq{} (level: 2, lon: 4, lat: 4)\PYGZgt{}}
\PYG{g+go}{array([[[\PYGZhy{}2.928266e\PYGZhy{}01, \PYGZhy{}2.709919e+01,  2.826585e\PYGZhy{}02,  6.083374e\PYGZhy{}01],}
\PYG{g+go}{        [ 3.260879e\PYGZhy{}01,  1.933501e\PYGZhy{}01, \PYGZhy{}9.033669e+00, \PYGZhy{}1.468327e+00],}
\PYG{g+go}{        [\PYGZhy{}1.957892e+00,  2.408426e\PYGZhy{}01,  5.597183e\PYGZhy{}01, \PYGZhy{}2.548981e+01],}
\PYG{g+go}{        [\PYGZhy{}3.234550e\PYGZhy{}01, \PYGZhy{}1.907664e+00,  2.506510e\PYGZhy{}01, \PYGZhy{}7.385499e\PYGZhy{}01]],}
\PYG{g+gp}{...}
\PYG{g+go}{       [[\PYGZhy{}1.136451e\PYGZhy{}01, \PYGZhy{}1.796130e+00, \PYGZhy{}1.095550e\PYGZhy{}02,  5.748574e+00],}
\PYG{g+go}{        [ 4.407484e+02,  4.736099e\PYGZhy{}01, \PYGZhy{}5.086917e\PYGZhy{}01, \PYGZhy{}6.610682e\PYGZhy{}01],}
\PYG{g+go}{        [\PYGZhy{}2.458302e+00,  6.864762e+00,  2.633289e+00, \PYGZhy{}4.246873e\PYGZhy{}01],}
\PYG{g+go}{        [\PYGZhy{}1.839424e+01, \PYGZhy{}1.194455e+00,  5.659980e+02, \PYGZhy{}2.567729e+00]]])}
\PYG{g+go}{Coordinates:}
\PYG{g+go}{  * lat      (lat) int64 \PYGZhy{}90 \PYGZhy{}45 0 45}
\PYG{g+go}{  * lon      (lon) int64 0 90 180 270}
\PYG{g+go}{  * level    (level) int64 100 200}
\PYG{g+go}{Attributes:}
\PYG{g+go}{    long\PYGZus{}name:  Brunt\PYGZhy{}Vaisala frequency squared}
\PYG{g+go}{    units:      s\PYGZca{}\PYGZhy{}2}
\end{sphinxVerbatim}

\end{fulllineitems}

\index{Rossby\_wave\_number() (in module diagnostic)@\spxentry{Rossby\_wave\_number()}\spxextra{in module diagnostic}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{diagnostic_doc:diagnostic.Rossby_wave_number}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{diagnostic.}}\sphinxbfcode{\sphinxupquote{Rossby\_wave\_number}}}{\emph{u}, \emph{v}, \emph{u\_clim}, \emph{lat\_name=None}, \emph{lon\_name=None}}{}
Returns the square of the stationary Rossby wave number, Ks**2

\begin{DUlineblock}{0em}
\item[] Author: Dougie Squire
\item[] Date: 11/07/2018
\end{DUlineblock}
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{description}
\item[{\sphinxstylestrong{u}}] \leavevmode{[}xarray DataArray{]}
Array containing fields of zonal velocity with at least coordinates latitude and longitude                     (following standard naming - see Notes)

\item[{\sphinxstylestrong{v}}] \leavevmode{[}xarray DataArray{]}
Array containing fields of meridional velocity with at least coordinates latitude and                     longitude (following standard naming - see Notes)

\item[{\sphinxstylestrong{u\_clim}}] \leavevmode{[}xarray DataArray{]}
Array containing climatological fields of zonal velocity with at least coordinates latitude                     and longitude (following standard naming - see Notes)

\item[{\sphinxstylestrong{lat\_name}}] \leavevmode{[}str, optional{]}
Name of latitude coordinate. If None, doppyo will attempt to determine lat\_name                     automatically

\item[{\sphinxstylestrong{lon\_name}}] \leavevmode{[}str, optional{]}
Name of longitude coordinate. If None, doppyo will attempt to determine lon\_name                     automatically

\end{description}

\item[{Returns}] \leavevmode\begin{description}
\item[{\sphinxstylestrong{Rossby\_wave\_number}}] \leavevmode{[}xarray DataArray{]}
Array containing the square of the Rossby wave source

\end{description}

\end{description}\end{quote}
\subsubsection*{Notes}

\begin{DUlineblock}{0em}
\item[] The input u\_clim must have the same dimensions as u and v. One can project a mean climatology,                 A\_clim, over the time dimension in A using \sphinxcode{\sphinxupquote{doppyo.utils.anomalize(0*A, -A\_clim)}}
\item[] All input array coordinates must follow standard naming (see \sphinxcode{\sphinxupquote{doppyo.utils.get\_lat\_name()}},                 \sphinxcode{\sphinxupquote{doppyo.utils.get\_lon\_name()}}, etc)
\item[] This function utilises the windspharm package, which is a wrapper on pyspharm, which is a                 wrapper on SPHEREPACK. These packages require that the latitudinal and longitudinal grid                 is regular or Gaussian.
\item[] These calculations are not yet dask-compatible.
\end{DUlineblock}

To Do
\begin{itemize}
\item {} 
Make dask-compatible by either developing the windspharm package, or using a kernel approach

\end{itemize}
\subsubsection*{Examples}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{u} \PYG{o}{=} \PYG{n}{xr}\PYG{o}{.}\PYG{n}{DataArray}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{random}\PYG{o}{.}\PYG{n}{normal}\PYG{p}{(}\PYG{n}{size}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{6}\PYG{p}{,}\PYG{l+m+mi}{4}\PYG{p}{,}\PYG{l+m+mi}{24}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} 
\PYG{g+gp}{... }                 \PYG{n}{coords}\PYG{o}{=}\PYG{p}{[}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{lat}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{75}\PYG{p}{,}\PYG{l+m+mi}{76}\PYG{p}{,}\PYG{l+m+mi}{30}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{lon}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{45}\PYG{p}{,}\PYG{l+m+mi}{316}\PYG{p}{,}\PYG{l+m+mi}{90}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} 
\PYG{g+gp}{... }                         \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{time}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{pd}\PYG{o}{.}\PYG{n}{date\PYGZus{}range}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{2000\PYGZhy{}01\PYGZhy{}01}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{periods}\PYG{o}{=}\PYG{l+m+mi}{24}\PYG{p}{,}\PYG{n}{freq}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{M}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{p}{)}\PYG{p}{]}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{v} \PYG{o}{=} \PYG{n}{xr}\PYG{o}{.}\PYG{n}{DataArray}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{random}\PYG{o}{.}\PYG{n}{normal}\PYG{p}{(}\PYG{n}{size}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{6}\PYG{p}{,}\PYG{l+m+mi}{4}\PYG{p}{,}\PYG{l+m+mi}{24}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} 
\PYG{g+gp}{... }                 \PYG{n}{coords}\PYG{o}{=}\PYG{p}{[}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{lat}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{75}\PYG{p}{,}\PYG{l+m+mi}{76}\PYG{p}{,}\PYG{l+m+mi}{30}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{lon}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{45}\PYG{p}{,}\PYG{l+m+mi}{316}\PYG{p}{,}\PYG{l+m+mi}{90}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} 
\PYG{g+gp}{... }                         \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{time}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{pd}\PYG{o}{.}\PYG{n}{date\PYGZus{}range}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{2000\PYGZhy{}01\PYGZhy{}01}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{periods}\PYG{o}{=}\PYG{l+m+mi}{24}\PYG{p}{,}\PYG{n}{freq}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{M}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{p}{)}\PYG{p}{]}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{u\PYGZus{}clim} \PYG{o}{=} \PYG{n}{u}\PYG{o}{.}\PYG{n}{groupby}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{time.month}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{o}{.}\PYG{n}{mean}\PYG{p}{(}\PYG{n}{dim}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{time}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{u\PYGZus{}clim} \PYG{o}{=} \PYG{n}{doppyo}\PYG{o}{.}\PYG{n}{utils}\PYG{o}{.}\PYG{n}{anomalize}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{o}{*}\PYG{n}{u}\PYG{p}{,} \PYG{o}{\PYGZhy{}}\PYG{n}{u\PYGZus{}clim}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{doppyo}\PYG{o}{.}\PYG{n}{diagnostic}\PYG{o}{.}\PYG{n}{Rossby\PYGZus{}wave\PYGZus{}number}\PYG{p}{(}\PYG{n}{u}\PYG{p}{,} \PYG{n}{v}\PYG{p}{,} \PYG{n}{u\PYGZus{}clim}\PYG{p}{)}
\PYG{g+go}{\PYGZlt{}xarray.DataArray \PYGZsq{}ks2\PYGZsq{} (lat: 6, lon: 4, time: 24)\PYGZgt{}}
\PYG{g+go}{array([[[ 8.077277e\PYGZhy{}01,  1.885835e\PYGZhy{}01, ...,  6.383953e\PYGZhy{}01, \PYGZhy{}4.686696e\PYGZhy{}01],}
\PYG{g+go}{        [\PYGZhy{}3.756420e\PYGZhy{}01,  1.210226e+00, ..., \PYGZhy{}2.055076e+00, \PYGZhy{}2.291500e+00],}
\PYG{g+go}{        [ 8.786361e\PYGZhy{}01,  4.181778e\PYGZhy{}01, ..., \PYGZhy{}2.071749e+00,  4.018699e\PYGZhy{}01],}
\PYG{g+go}{        [ 8.218020e\PYGZhy{}01,  5.197270e+00, ...,  5.181735e+00,  7.112056e\PYGZhy{}01]],}
\PYG{g+gp}{...}
\PYG{g+go}{       [[\PYGZhy{}5.323813e+02, \PYGZhy{}2.894449e+02, ..., \PYGZhy{}5.063012e+03, \PYGZhy{}3.921559e+02],}
\PYG{g+go}{        [ 3.167388e+02, \PYGZhy{}5.406136e+02, ..., \PYGZhy{}1.987485e+03, \PYGZhy{}2.692395e+02],}
\PYG{g+go}{        [ 2.916992e+03,  2.318578e+02, ...,  8.611478e+02,  8.559919e+02],}
\PYG{g+go}{        [\PYGZhy{}4.380459e+02, \PYGZhy{}5.035198e+02, ..., \PYGZhy{}1.844072e+03, \PYGZhy{}2.856807e+02]],}
\PYG{g+go}{...,}
\PYG{g+go}{       [[ 3.832781e+02, \PYGZhy{}1.272144e+03, ...,  3.900539e+02, \PYGZhy{}5.402686e+02],}
\PYG{g+go}{        [\PYGZhy{}2.494814e+02, \PYGZhy{}2.041985e+02, ...,  3.426493e+02, \PYGZhy{}5.557717e+02],}
\PYG{g+go}{        [\PYGZhy{}6.290198e+03,  1.606871e+03, ...,  2.894713e+03,  3.284330e+02],}
\PYG{g+go}{        [\PYGZhy{}3.325505e+02, \PYGZhy{}2.406172e+02, ..., \PYGZhy{}3.270787e+03, \PYGZhy{}1.040641e+03]],}
\PYG{g+gp}{...}
\PYG{g+go}{       [[ 1.401437e+00,  6.053096e\PYGZhy{}01, ...,  1.725558e\PYGZhy{}01, \PYGZhy{}7.287578e+01],}
\PYG{g+go}{        [\PYGZhy{}8.905873e\PYGZhy{}01,  1.469694e\PYGZhy{}01, ...,  1.308367e+00, \PYGZhy{}7.136195e\PYGZhy{}01],}
\PYG{g+go}{        [ 4.318194e+01, \PYGZhy{}1.850361e\PYGZhy{}01, ..., \PYGZhy{}2.447798e\PYGZhy{}01, \PYGZhy{}4.454747e\PYGZhy{}01],}
\PYG{g+go}{        [ 1.247740e+00,  9.826164e\PYGZhy{}02, ...,  2.808380e+00,  1.254609e+00]]])}
\PYG{g+go}{Coordinates:}
\PYG{g+go}{  * lat      (lat) int64 75 45 15 \PYGZhy{}15 \PYGZhy{}45 \PYGZhy{}75}
\PYG{g+go}{  * lon      (lon) int64 45 135 225 315}
\PYG{g+go}{  * time     (time) datetime64[ns] 2000\PYGZhy{}01\PYGZhy{}31 2000\PYGZhy{}02\PYGZhy{}29 ... 2001\PYGZhy{}12\PYGZhy{}31}
\PYG{g+go}{Attributes:}
\PYG{g+go}{    units:      real number}
\PYG{g+go}{    long\PYGZus{}name:  Square of Rossby stationary wavenumber}
\end{sphinxVerbatim}

\end{fulllineitems}

\index{Eady\_growth\_rate() (in module diagnostic)@\spxentry{Eady\_growth\_rate()}\spxextra{in module diagnostic}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{diagnostic_doc:diagnostic.Eady_growth_rate}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{diagnostic.}}\sphinxbfcode{\sphinxupquote{Eady\_growth\_rate}}}{\emph{u}, \emph{v}, \emph{gh}, \emph{nsq}, \emph{lat\_name=None}, \emph{lon\_name=None}, \emph{level\_name=None}}{}
Returns the square of the Eady growth rate

\begin{DUlineblock}{0em}
\item[] Author: Dougie Squire
\item[] Date: 15/07/2018
\end{DUlineblock}
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{description}
\item[{\sphinxstylestrong{u}}] \leavevmode{[}xarray DataArray{]}
Array containing fields of zonal velocity with at least coordinates latitude, longitude and                     level (following standard naming - see Notes)

\item[{\sphinxstylestrong{v}}] \leavevmode{[}xarray DataArray{]}
Array containing fields of meridional velocity with at least coordinates latitude, longitude                     and level (following standard naming - see Notes)

\item[{\sphinxstylestrong{gh}}] \leavevmode{[}xarray DataArray{]}
Array containing fields of geopotential height with at least coordinates latitude, longitude                     and level (following standard naming - see Notes)

\item[{\sphinxstylestrong{nsq}}] \leavevmode{[}xarray DataArray{]}
Array containing fields of Brunt Väisälä frequency with at least coordinates latitude,                     longitude and level (following standard naming - see Notes)

\item[{\sphinxstylestrong{lat\_name}}] \leavevmode{[}str, optional{]}
Name of latitude coordinate. If None, doppyo will attempt to determine lat\_name                     automatically

\item[{\sphinxstylestrong{lon\_name}}] \leavevmode{[}str, optional{]}
Name of longitude coordinate. If None, doppyo will attempt to determine lon\_name                     automatically

\item[{\sphinxstylestrong{level\_name}}] \leavevmode{[}str, optional{]}
Name of level coordinate. If None, doppyo will attempt to determine level\_name
automatically

\end{description}

\item[{Returns}] \leavevmode\begin{description}
\item[{\sphinxstylestrong{Eady\textasciicircum{}2}}] \leavevmode{[}xarray DataArray{]}
Array containing the square of the Eady growth rate

\end{description}

\end{description}\end{quote}
\subsubsection*{Notes}

All input array coordinates must follow standard naming (see \sphinxcode{\sphinxupquote{doppyo.utils.get\_lat\_name()}},                 \sphinxcode{\sphinxupquote{doppyo.utils.get\_lon\_name()}}, etc)
\subsubsection*{Examples}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{u} \PYG{o}{=} \PYG{n}{xr}\PYG{o}{.}\PYG{n}{DataArray}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{random}\PYG{o}{.}\PYG{n}{normal}\PYG{p}{(}\PYG{n}{size}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{6}\PYG{p}{,}\PYG{l+m+mi}{4}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} 
\PYG{g+gp}{... }                 \PYG{n}{coords}\PYG{o}{=}\PYG{p}{[}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{lat}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{75}\PYG{p}{,}\PYG{l+m+mi}{76}\PYG{p}{,}\PYG{l+m+mi}{30}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{lon}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{45}\PYG{p}{,}\PYG{l+m+mi}{316}\PYG{p}{,}\PYG{l+m+mi}{90}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} 
\PYG{g+gp}{... }                         \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{level}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{p}{[}\PYG{l+m+mi}{200}\PYG{p}{,} \PYG{l+m+mi}{500}\PYG{p}{]}\PYG{p}{)}\PYG{p}{]}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{v} \PYG{o}{=} \PYG{n}{xr}\PYG{o}{.}\PYG{n}{DataArray}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{random}\PYG{o}{.}\PYG{n}{normal}\PYG{p}{(}\PYG{n}{size}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{6}\PYG{p}{,}\PYG{l+m+mi}{4}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} 
\PYG{g+gp}{... }                 \PYG{n}{coords}\PYG{o}{=}\PYG{p}{[}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{lat}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{75}\PYG{p}{,}\PYG{l+m+mi}{76}\PYG{p}{,}\PYG{l+m+mi}{30}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{lon}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{45}\PYG{p}{,}\PYG{l+m+mi}{316}\PYG{p}{,}\PYG{l+m+mi}{90}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} 
\PYG{g+gp}{... }                         \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{level}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{p}{[}\PYG{l+m+mi}{200}\PYG{p}{,} \PYG{l+m+mi}{500}\PYG{p}{]}\PYG{p}{)}\PYG{p}{]}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{temp} \PYG{o}{=} \PYG{n}{xr}\PYG{o}{.}\PYG{n}{DataArray}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{random}\PYG{o}{.}\PYG{n}{normal}\PYG{p}{(}\PYG{n}{size}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{6}\PYG{p}{,}\PYG{l+m+mi}{4}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} 
\PYG{g+gp}{... }                    \PYG{n}{coords}\PYG{o}{=}\PYG{p}{[}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{lat}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{75}\PYG{p}{,}\PYG{l+m+mi}{76}\PYG{p}{,}\PYG{l+m+mi}{30}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{lon}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{45}\PYG{p}{,}\PYG{l+m+mi}{316}\PYG{p}{,}\PYG{l+m+mi}{90}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} 
\PYG{g+gp}{... }                            \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{level}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{p}{[}\PYG{l+m+mi}{200}\PYG{p}{,} \PYG{l+m+mi}{500}\PYG{p}{]}\PYG{p}{)}\PYG{p}{]}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{gh} \PYG{o}{=} \PYG{n}{xr}\PYG{o}{.}\PYG{n}{DataArray}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{random}\PYG{o}{.}\PYG{n}{normal}\PYG{p}{(}\PYG{n}{size}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{6}\PYG{p}{,}\PYG{l+m+mi}{4}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} 
\PYG{g+gp}{... }                  \PYG{n}{coords}\PYG{o}{=}\PYG{p}{[}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{lat}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{75}\PYG{p}{,}\PYG{l+m+mi}{76}\PYG{p}{,}\PYG{l+m+mi}{30}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{lon}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{45}\PYG{p}{,}\PYG{l+m+mi}{316}\PYG{p}{,}\PYG{l+m+mi}{90}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} 
\PYG{g+gp}{... }                          \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{level}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{p}{[}\PYG{l+m+mi}{200}\PYG{p}{,} \PYG{l+m+mi}{500}\PYG{p}{]}\PYG{p}{)}\PYG{p}{]}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{nsq} \PYG{o}{=} \PYG{n}{doppyo}\PYG{o}{.}\PYG{n}{diagnostic}\PYG{o}{.}\PYG{n}{Brunt\PYGZus{}Vaisala}\PYG{p}{(}\PYG{n}{temp}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{doppyo}\PYG{o}{.}\PYG{n}{diagnostic}\PYG{o}{.}\PYG{n}{Eady\PYGZus{}growth\PYGZus{}rate}\PYG{p}{(}\PYG{n}{u}\PYG{p}{,} \PYG{n}{v}\PYG{p}{,} \PYG{n}{gh}\PYG{p}{,} \PYG{n}{nsq}\PYG{p}{)}
\PYG{g+go}{\PYGZlt{}xarray.DataArray \PYGZsq{}Eady\PYGZca{}2\PYGZsq{} (level: 2, lon: 4, lat: 6)\PYGZgt{}}
\PYG{g+go}{array([[[\PYGZhy{}5.371897e\PYGZhy{}08,  1.338133e\PYGZhy{}11, \PYGZhy{}7.254014e\PYGZhy{}13, \PYGZhy{}8.196598e\PYGZhy{}12,}
\PYG{g+go}{          2.062633e\PYGZhy{}09, \PYGZhy{}7.200158e\PYGZhy{}12],}
\PYG{g+go}{        [ 9.906932e\PYGZhy{}10, \PYGZhy{}7.349832e\PYGZhy{}09, \PYGZhy{}2.558847e\PYGZhy{}12, \PYGZhy{}1.695842e\PYGZhy{}09,}
\PYG{g+go}{          4.986779e\PYGZhy{}09, \PYGZhy{}3.090147e\PYGZhy{}09],}
\PYG{g+go}{        [ 3.948602e\PYGZhy{}07,  1.397756e\PYGZhy{}09,  1.508010e\PYGZhy{}10,  1.481968e\PYGZhy{}10,}
\PYG{g+go}{          5.627093e\PYGZhy{}11,  7.463454e\PYGZhy{}10],}
\PYG{g+go}{        [ 4.326971e\PYGZhy{}09, \PYGZhy{}2.528522e\PYGZhy{}09, \PYGZhy{}1.243954e\PYGZhy{}13, \PYGZhy{}3.138463e\PYGZhy{}11,}
\PYG{g+go}{         \PYGZhy{}6.801250e\PYGZhy{}09, \PYGZhy{}6.286382e\PYGZhy{}10]],}
\PYG{g+gp}{...}
\PYG{g+go}{       [[\PYGZhy{}8.580527e\PYGZhy{}10,  7.040065e\PYGZhy{}12, \PYGZhy{}3.760004e\PYGZhy{}13, \PYGZhy{}1.213131e\PYGZhy{}12,}
\PYG{g+go}{          2.437557e\PYGZhy{}11, \PYGZhy{}6.522981e\PYGZhy{}11],}
\PYG{g+go}{        [ 6.119671e\PYGZhy{}09, \PYGZhy{}1.644123e\PYGZhy{}09, \PYGZhy{}5.124997e\PYGZhy{}11,  1.725101e\PYGZhy{}08,}
\PYG{g+go}{          2.574158e\PYGZhy{}08, \PYGZhy{}3.101566e\PYGZhy{}10],}
\PYG{g+go}{        [ 1.601742e\PYGZhy{}06,  1.994867e\PYGZhy{}11,  3.341006e\PYGZhy{}11,  1.641253e\PYGZhy{}11,}
\PYG{g+go}{          5.601919e\PYGZhy{}08,  5.527214e\PYGZhy{}11],}
\PYG{g+go}{        [ 4.700271e\PYGZhy{}09, \PYGZhy{}1.422149e\PYGZhy{}11, \PYGZhy{}1.302035e\PYGZhy{}12, \PYGZhy{}2.153002e\PYGZhy{}11,}
\PYG{g+go}{         \PYGZhy{}4.607096e\PYGZhy{}10, \PYGZhy{}3.813686e\PYGZhy{}09]]])}
\PYG{g+go}{Coordinates:}
\PYG{g+go}{  * lat      (lat) int64 \PYGZhy{}75 \PYGZhy{}45 \PYGZhy{}15 15 45 75}
\PYG{g+go}{  * lon      (lon) int64 45 135 225 315}
\PYG{g+go}{  * level    (level) int64 200 500}
\PYG{g+go}{Attributes:}
\PYG{g+go}{    units:      s\PYGZca{}\PYGZhy{}2}
\PYG{g+go}{    long\PYGZus{}name:  Square of Eady growth rate}
\end{sphinxVerbatim}

\end{fulllineitems}

\index{thermal\_wind() (in module diagnostic)@\spxentry{thermal\_wind()}\spxextra{in module diagnostic}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{diagnostic_doc:diagnostic.thermal_wind}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{diagnostic.}}\sphinxbfcode{\sphinxupquote{thermal\_wind}}}{\emph{gh}, \emph{plevel\_lower}, \emph{plevel\_upper}, \emph{lat\_name=None}, \emph{lon\_name=None}, \emph{plevel\_name=None}}{}
Returns the thermal wind, (u\_tw, v\_tw) = 1/f x k x grad(thickness), where f = 2*Omega*sin(lat)

\begin{DUlineblock}{0em}
\item[] Author: Dougie Squire
\item[] Date: 15/07/2018
\end{DUlineblock}
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{description}
\item[{\sphinxstylestrong{gh}}] \leavevmode{[}xarray DataArray{]}
Array containing fields of geopotential height with at least coordinates latitude, longitude                     and level (following standard naming - see Notes)

\item[{\sphinxstylestrong{plevel\_lower}}] \leavevmode{[}value{]}
Value of lower pressure level used to compute termal wind. Must exist in level coordinate of                     gh

\item[{\sphinxstylestrong{plevel\_upper}}] \leavevmode{[}value{]}
Value of upper pressure level used to compute termal wind. Must exist in level coordinate of                     gh

\item[{\sphinxstylestrong{lat\_name}}] \leavevmode{[}str, optional{]}
Name of latitude coordinate. If None, doppyo will attempt to determine lat\_name                     automatically

\item[{\sphinxstylestrong{lon\_name}}] \leavevmode{[}str, optional{]}
Name of longitude coordinate. If None, doppyo will attempt to determine lon\_name                     automatically

\item[{\sphinxstylestrong{plevel\_name}}] \leavevmode{[}str, optional{]}
Name of pressure level coordinate. If None, doppyo will attempt to determine plevel\_name                     automatically

\end{description}

\item[{Returns}] \leavevmode\begin{description}
\item[{\sphinxstylestrong{thermal\_wind}}] \leavevmode{[}xarray Dataset{]}
\begin{DUlineblock}{0em}
\item[] Dataset containing the following variables:
\item[] u\_tw; array containing the zonal component of the thermal wind
\item[] v\_tw; array containing the meridonal component of the thermal wind
\end{DUlineblock}

\end{description}

\end{description}\end{quote}
\subsubsection*{Notes}

\begin{DUlineblock}{0em}
\item[] All input array coordinates must follow standard naming (see \sphinxcode{\sphinxupquote{doppyo.utils.get\_lat\_name()}},                 \sphinxcode{\sphinxupquote{doppyo.utils.get\_lon\_name()}}, etc)
\item[] Pressure levels must be provided in units of hPa
\end{DUlineblock}
\subsubsection*{Examples}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{gh} \PYG{o}{=} \PYG{n}{xr}\PYG{o}{.}\PYG{n}{DataArray}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{random}\PYG{o}{.}\PYG{n}{normal}\PYG{p}{(}\PYG{n}{size}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{,}\PYG{l+m+mi}{4}\PYG{p}{,}\PYG{l+m+mi}{4}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} 
\PYG{g+gp}{... }                  \PYG{n}{coords}\PYG{o}{=}\PYG{p}{[}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{level}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{p}{[}\PYG{l+m+mi}{400}\PYG{p}{,} \PYG{l+m+mi}{500}\PYG{p}{,} \PYG{l+m+mi}{600}\PYG{p}{]}\PYG{p}{)}\PYG{p}{,} \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{lat}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{90}\PYG{p}{,}\PYG{l+m+mi}{90}\PYG{p}{,}\PYG{l+m+mi}{45}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} 
\PYG{g+gp}{... }                  \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{lon}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{l+m+mi}{360}\PYG{p}{,}\PYG{l+m+mi}{90}\PYG{p}{)}\PYG{p}{)}\PYG{p}{]}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{doppyo}\PYG{o}{.}\PYG{n}{diagnostic}\PYG{o}{.}\PYG{n}{thermal\PYGZus{}wind}\PYG{p}{(}\PYG{n}{gh}\PYG{p}{,} \PYG{n}{plevel\PYGZus{}lower}\PYG{o}{=}\PYG{l+m+mi}{400}\PYG{p}{,} \PYG{n}{plevel\PYGZus{}upper}\PYG{o}{=}\PYG{l+m+mi}{600}\PYG{p}{)}
\PYG{g+go}{\PYGZlt{}xarray.Dataset\PYGZgt{}}
\PYG{g+go}{Dimensions:  (lat: 4, lon: 4)}
\PYG{g+go}{Coordinates:}
\PYG{g+go}{    level    float64 500.0}
\PYG{g+go}{  * lon      (lon) int64 0 90 180 270}
\PYG{g+go}{  * lat      (lat) int64 \PYGZhy{}90 \PYGZhy{}45 0 45}
\PYG{g+go}{Data variables:}
\PYG{g+go}{    u\PYGZus{}tw     (lon, lat) float64 0.003727 0.0006837 inf ... inf \PYGZhy{}0.0001238}
\PYG{g+go}{    v\PYGZus{}tw     (lat, lon) float64 4.515e+12 \PYGZhy{}1.443e+12 ... \PYGZhy{}0.000569 \PYGZhy{}0.0002777}
\end{sphinxVerbatim}

\end{fulllineitems}

\index{eofs() (in module diagnostic)@\spxentry{eofs()}\spxextra{in module diagnostic}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{diagnostic_doc:diagnostic.eofs}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{diagnostic.}}\sphinxbfcode{\sphinxupquote{eofs}}}{\emph{da}, \emph{sample\_dim='time'}, \emph{weight=None}, \emph{n\_modes=20}}{}
Returns the empirical orthogonal functions (EOFs), and associated principle component                 timeseries (PCs), and explained variances of provided array. Follows notation used in                 “Bjornsson H. and Venegas S. A. 1997 A Manual for EOF and SVD analyses of Climatic Data”,                 whereby, (phi, sqrt\_lambdas, EOFs) = svd(data) and PCs = phi * sqrt\_lambdas

\begin{DUlineblock}{0em}
\item[] Author: Dougie Squire
\item[] Date: 19/18/2018
\end{DUlineblock}
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{description}
\item[{\sphinxstylestrong{da}}] \leavevmode{[}xarray DataArray or sequence of xarray DataArrays{]}
Array to use to compute EOFs. When input array is a list of xarray objects, returns the                     joint EOFs associated with each object. In this case, all xarray objects in da must have                     sample\_dim dimensions of equal length.

\item[{\sphinxstylestrong{sample\_dim}}] \leavevmode{[}str, optional{]}
EOFs sample dimension

\item[{\sphinxstylestrong{weight}}] \leavevmode{[}xarray DataArray or sequence of xarray DataArrays, optional{]}
Weighting to apply prior to svd. If weight=None, cos(lat)\textasciicircum{}2 weighting are used. If weight                     is specified, it must be the same length as da with each element broadcastable onto each                     element of da

\item[{\sphinxstylestrong{n\_modes}}] \leavevmode{[}values, optional{]}
Number of EOF modes to return

\end{description}

\item[{Returns}] \leavevmode\begin{description}
\item[{\sphinxstylestrong{eofs}}] \leavevmode{[}xarray Dataset{]}
\begin{DUlineblock}{0em}
\item[] Dataset containing the following variables:
\item[] EOFs; array containing the empirical orthogonal functions
\item[] PCs; array containing the associated principle component timeseries
\item[] lambdas; array containing the eigenvalues of the covariance of the input data
\item[] explained\_var; array containing the fraction of the total variance explained by each EOF                     mode
\end{DUlineblock}

\end{description}

\end{description}\end{quote}
\subsubsection*{Notes}

This function is a wrapper on scipy.sparse.linalg.svds which is a naive implementation                 using ARPACK. Thus, the approach implemented here is non-lazy and could incur large                 increases in memory usage.
\subsubsection*{Examples}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{A} \PYG{o}{=} \PYG{n}{xr}\PYG{o}{.}\PYG{n}{DataArray}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{random}\PYG{o}{.}\PYG{n}{normal}\PYG{p}{(}\PYG{n}{size}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{6}\PYG{p}{,}\PYG{l+m+mi}{4}\PYG{p}{,}\PYG{l+m+mi}{40}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} 
\PYG{g+gp}{... }                 \PYG{n}{coords}\PYG{o}{=}\PYG{p}{[}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{lat}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{75}\PYG{p}{,}\PYG{l+m+mi}{76}\PYG{p}{,}\PYG{l+m+mi}{30}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{lon}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{45}\PYG{p}{,}\PYG{l+m+mi}{316}\PYG{p}{,}\PYG{l+m+mi}{90}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} 
\PYG{g+gp}{... }                         \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{time}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{pd}\PYG{o}{.}\PYG{n}{date\PYGZus{}range}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{2000\PYGZhy{}01\PYGZhy{}01}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{periods}\PYG{o}{=}\PYG{l+m+mi}{40}\PYG{p}{,} \PYG{n}{freq}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{M}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{p}{)}\PYG{p}{]}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{doppyo}\PYG{o}{.}\PYG{n}{diagnostic}\PYG{o}{.}\PYG{n}{eofs}\PYG{p}{(}\PYG{n}{A}\PYG{p}{)}
\PYG{g+go}{\PYGZlt{}xarray.Dataset\PYGZgt{}}
\PYG{g+go}{Dimensions:        (lat: 6, lon: 4, mode: 20, time: 40)}
\PYG{g+go}{Coordinates:}
\PYG{g+go}{  * time           (time) datetime64[ns] 2000\PYGZhy{}01\PYGZhy{}31 2000\PYGZhy{}02\PYGZhy{}29 ... 2003\PYGZhy{}04\PYGZhy{}30}
\PYG{g+go}{  * mode           (mode) int64 1 2 3 4 5 6 7 8 9 ... 12 13 14 15 16 17 18 19 20}
\PYG{g+go}{  * lat            (lat) int64 \PYGZhy{}75 \PYGZhy{}45 \PYGZhy{}15 15 45 75}
\PYG{g+go}{  * lon            (lon) int64 45 135 225 315}
\PYG{g+go}{Data variables:}
\PYG{g+go}{    EOFs           (mode, lat, lon) float64 \PYGZhy{}0.05723 \PYGZhy{}0.01997 ... 0.08166}
\PYG{g+go}{    PCs            (time, mode) float64 1.183 \PYGZhy{}1.107 \PYGZhy{}0.5385 ... \PYGZhy{}0.08552 0.1951}
\PYG{g+go}{    lambdas        (mode) float64 87.76 80.37 68.5 58.14 ... 8.269 6.279 4.74}
\PYG{g+go}{    explained\PYGZus{}var  (mode) float64 0.1348 0.1234 0.1052 ... 0.009644 0.00728}
\end{sphinxVerbatim}

\end{fulllineitems}

\index{mean\_merid\_mass\_streamfunction() (in module diagnostic)@\spxentry{mean\_merid\_mass\_streamfunction()}\spxextra{in module diagnostic}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{diagnostic_doc:diagnostic.mean_merid_mass_streamfunction}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{diagnostic.}}\sphinxbfcode{\sphinxupquote{mean\_merid\_mass\_streamfunction}}}{\emph{v}, \emph{lat\_name=None}, \emph{lon\_name=None}, \emph{plevel\_name=None}}{}
Returns the mean meridional mass stream function averaged over all provided longitudes

\begin{DUlineblock}{0em}
\item[] Author: Dougie Squire
\item[] Date: 15/07/2018
\end{DUlineblock}
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{description}
\item[{\sphinxstylestrong{v}}] \leavevmode{[}xarray DataArray{]}
Array containing fields of meridional velocity with at least coordinates latitude, longitude                     and level (following standard naming - see Notes)

\item[{\sphinxstylestrong{lat\_name}}] \leavevmode{[}str, optional{]}
Name of latitude coordinate. If None, doppyo will attempt to determine lat\_name                     automatically

\item[{\sphinxstylestrong{lon\_name}}] \leavevmode{[}str, optional{]}
Name of longitude coordinate. If None, doppyo will attempt to determine lon\_name                     automatically

\item[{\sphinxstylestrong{plevel\_name}}] \leavevmode{[}str, optional{]}
Name of pressure level coordinate. If None, doppyo will attempt to determine plevel\_name                    automatically

\end{description}

\item[{Returns}] \leavevmode\begin{description}
\item[{\sphinxstylestrong{mmms}}] \leavevmode{[}xarray DataArray{]}
New DataArray object containing the mean meridional mass stream function

\end{description}

\end{description}\end{quote}
\subsubsection*{Notes}

\begin{DUlineblock}{0em}
\item[] All input array coordinates must follow standard naming (see \sphinxcode{\sphinxupquote{doppyo.utils.get\_lat\_name()}},                 \sphinxcode{\sphinxupquote{doppyo.utils.get\_lon\_name()}}, etc)
\item[] Pressure levels must be provided in units of hPa
\end{DUlineblock}
\subsubsection*{Examples}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{v} \PYG{o}{=} \PYG{n}{xr}\PYG{o}{.}\PYG{n}{DataArray}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{random}\PYG{o}{.}\PYG{n}{normal}\PYG{p}{(}\PYG{n}{size}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{4}\PYG{p}{,}\PYG{l+m+mi}{4}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} 
\PYG{g+gp}{... }                  \PYG{n}{coords}\PYG{o}{=}\PYG{p}{[}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{level}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{p}{[}\PYG{l+m+mi}{400}\PYG{p}{,} \PYG{l+m+mi}{600}\PYG{p}{]}\PYG{p}{)}\PYG{p}{,} \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{lat}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{90}\PYG{p}{,}\PYG{l+m+mi}{90}\PYG{p}{,}\PYG{l+m+mi}{45}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} 
\PYG{g+gp}{... }                  \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{lon}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{l+m+mi}{360}\PYG{p}{,}\PYG{l+m+mi}{90}\PYG{p}{)}\PYG{p}{)}\PYG{p}{]}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{doppyo}\PYG{o}{.}\PYG{n}{diagnostic}\PYG{o}{.}\PYG{n}{mean\PYGZus{}merid\PYGZus{}mass\PYGZus{}streamfunction}\PYG{p}{(}\PYG{n}{v}\PYG{p}{)}
\PYG{g+go}{\PYGZlt{}xarray.DataArray \PYGZsq{}mmms\PYGZsq{} (lat: 4, level: 2)\PYGZgt{}}
\PYG{g+go}{array([[ 0.000000e+00, \PYGZhy{}1.336316e\PYGZhy{}07],}
\PYG{g+go}{       [ 0.000000e+00, \PYGZhy{}1.447547e+10],}
\PYG{g+go}{       [ 0.000000e+00, \PYGZhy{}3.208457e+09],}
\PYG{g+go}{       [ 0.000000e+00, \PYGZhy{}2.562681e+10]])}
\PYG{g+go}{Coordinates:}
\PYG{g+go}{  * lat      (lat) int64 \PYGZhy{}90 \PYGZhy{}45 0 45}
\PYG{g+go}{  * level    (level) int64 400 600}
\end{sphinxVerbatim}

\end{fulllineitems}

\index{atmos\_energy\_cycle() (in module diagnostic)@\spxentry{atmos\_energy\_cycle()}\spxextra{in module diagnostic}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{diagnostic_doc:diagnostic.atmos_energy_cycle}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{diagnostic.}}\sphinxbfcode{\sphinxupquote{atmos\_energy\_cycle}}}{\emph{temp}, \emph{u}, \emph{v}, \emph{omega}, \emph{gh}, \emph{terms=None}, \emph{vgradz=False}, \emph{spectral=False}, \emph{n\_wavenumbers=20}, \emph{integrate=True}, \emph{lat\_name=None}, \emph{lon\_name=None}, \emph{plevel\_name=None}}{}
Returns all terms in the Lorenz energy cycle. Follows formulae and notation used in \sphinxtitleref{Marques                 et al. 2011 Global diagnostic energetics of five state-of-the-art climate models. Climate                 Dynamics}. Note that this decomposition is in the space domain. A space-time decomposition                 can also be carried out (though not in Fourier space, but this is not implemented here (see                 \sphinxtitleref{Oort. 1964 On Estimates of the atmospheric energy cycle. Monthly Weather Review}).

\begin{DUlineblock}{0em}
\item[] Author: Dougie Squire
\item[] Date: 15/07/2018
\end{DUlineblock}
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{description}
\item[{\sphinxstylestrong{temp}}] \leavevmode{[}xarray DataArray{]}
Array containing fields of temperature with at least coordinates latitude, longitude                     and level (following standard naming - see Notes)

\item[{\sphinxstylestrong{u}}] \leavevmode{[}xarray DataArray{]}
Array containing fields of zonal velocity with at least coordinates latitude, longitude                     and level (following standard naming - see Notes)

\item[{\sphinxstylestrong{v}}] \leavevmode{[}xarray DataArray{]}
Array containing fields of meridional velocity with at least coordinates latitude, longitude                     and level (following standard naming - see Notes)

\item[{\sphinxstylestrong{omega}}] \leavevmode{[}xarray DataArray{]}
Array containing fields of vertical velocity (pressure coordinates) with at least coordinates                     latitude, longitude and level (following standard naming - see Notes)

\item[{\sphinxstylestrong{gh}}] \leavevmode{[}xarray DataArray{]}
Array containing fields of geopotential height with at least coordinates latitude, longitude                     and level (following standard naming - see Notes)

\item[{\sphinxstylestrong{terms}}] \leavevmode{[}str or sequence of str{]}
\begin{DUlineblock}{0em}
\item[] List of terms to compute. If None, returns all terms. Available options are:
\item[] \sphinxstylestrong{Pz}; total available potential energy in the zonally averaged temperature distribution
\item[] \sphinxstylestrong{Kz}; total kinetic energy in zonally averaged motion
\item[] \sphinxstylestrong{Pe}; total eddy available potential energy {[}= sum\_n Pn (n \textgreater{} 0 only) for spectral=True{]} (Note that                     for spectral=True, an additional term, Sn, quantifying the rate of transfer of available potential                     energy to eddies of wavenumber n from eddies of all other wavenumbers is also returned)
\item[] \sphinxstylestrong{Ke}; total eddy kinetic energy {[}= sum\_n Kn (n \textgreater{} 0 only) for spectral=True{]} (Note that for                     spectral=True, an additional term, Ln, quantifying the rate of transfer of kinetic energy to eddies                     of wavenumber n from eddies of all other wavenumbers is also returned)
\item[] \sphinxstylestrong{Cz}; rate of conversion of zonal available potential energy to zonal kinetic energy
\item[] \sphinxstylestrong{Ca}; rate of transfer of total available potential energy in the zonally averaged temperature                     distribution (Pz) to total eddy available potential energy (Pe) {[}= sum\_n Rn (n \textgreater{} 0 only) for                     spectral=True{]}
\item[] \sphinxstylestrong{Ce}; rate of transfer of total eddy available potential energy (Pe) to total eddy kinetic energy                     (Ke) {[}= sum\_n Cn (n \textgreater{} 0 only) for spectral=True{]}
\item[] \sphinxstylestrong{Ck}; rate of transfer of total eddy kinetic energy (Ke) to total kinetic energy in zonally                     averaged motion (Kz) {[}= sum\_n Mn (n \textgreater{} 0 only) for spectral=True{]}
\item[] \sphinxstylestrong{Gz}; rate of generation of zonal available potential energy due to the zonally averaged heating (Pz).                     Note that this term is computed as a residual (Cz + Ca) and cannot be returned in spectral space.                     If Gz is requested with spectral=True, Gz is returned in real-space only
\item[] \sphinxstylestrong{Ge}; rate of generation of eddy available potential energy (Pe). Note that this term is computed as                     a residual (Ce - Ca) and cannot be returned in spectral space. If Ge is requested with spectral=True,                     Ge is returned in real-space only
\item[] \sphinxstylestrong{Dz}; rate of viscous dissipation of zonal kinetic energy (Kz). Note that this term is computed as a                     residual (Cz - Ck) and cannot be returned in spectral space. If Dz is requested with spectral=True, Dz                     is returned in real-space only
\item[] \sphinxstylestrong{De}; rate of dissipation of eddy kinetic energy (Ke). Note that this term is computed as a residual                     (Ce - Ck) and cannot be returned in spectral space. If De is requested with spectral=True, De is                     returned in real-space only
\end{DUlineblock}

\item[{\sphinxstylestrong{vgradz}}] \leavevmode{[}bool, optional{]}
If True, uses \sphinxtitleref{v-grad-z} approach for computing terms relating to conversion of potential energy to                     kinetic energy. Otherwise, defaults to using the \sphinxtitleref{omega-alpha} approach (see reference above for details)

\item[{\sphinxstylestrong{spectral}}] \leavevmode{[}bool, optional{]}
If True, computes all terms as a function of wavenumber on longitudinal bands. To use this                     option, longitudes must be regularly spaced. Note that Ge and De are computed as residuals and                     cannot be computed in spectral space

\item[{\sphinxstylestrong{n\_wavenumbers}}] \leavevmode{[}int, optional{]}
Number of wavenumbers to retain either side of wavenumber=0. Obviously only does anything if                     spectral=True

\item[{\sphinxstylestrong{integrate}}] \leavevmode{[}bool, optional{]}
If True, computes and returns the integral of each term over the mass of the atmosphere. Otherwise,                     only the integrands are returned

\item[{\sphinxstylestrong{lat\_name}}] \leavevmode{[}str, optional{]}
Name of latitude coordinate. If None, doppyo will attempt to determine lat\_name                     automatically

\item[{\sphinxstylestrong{lon\_name}}] \leavevmode{[}str, optional{]}
Name of longitude coordinate. If None, doppyo will attempt to determine lon\_name                     automatically

\item[{\sphinxstylestrong{plevel\_name}}] \leavevmode{[}str, optional{]}
Name of pressure level coordinate. If None, doppyo will attempt to determine plevel\_name                    automatically

\end{description}

\item[{Returns}] \leavevmode\begin{description}
\item[{\sphinxstylestrong{atmos\_energy\_cycle}}] \leavevmode{[}xarray Dataset{]}
Dataset containing the requested variables plus gamma, the stability parameter. If integrate=True,                     both the integrand (\textless{}term\textgreater{}\_int) and the integral over the mass of the atmosphere (\textless{}term\textgreater{}) are                     returned for each requested term. Otherwise, only the integrands are returned.

\end{description}

\end{description}\end{quote}
\subsubsection*{Notes}

\begin{DUlineblock}{0em}
\item[] The following notation is used below (stackable, e.g. *\_ZT indicates the time average of the zonal average):
\item[] *\_A -\textgreater{} area average over an isobaric surface
\item[] *\_a -\textgreater{} departure from area average
\item[] *\_Z -\textgreater{} zonal average
\item[] *\_z -\textgreater{} departure from zonal average
\item[] *\_T -\textgreater{} time average
\item[] *\_t -\textgreater{} departure from time average
\item[] Additionally, capital variables indicate Fourier transforms:
\item[] F(u) = U
\item[] F(v) = V
\item[] F(omega) = O
\item[] F(gh) = A
\item[] F(temp) = B
\end{DUlineblock}

\begin{DUlineblock}{0em}
\item[] All input array coordinates must follow standard naming (see \sphinxcode{\sphinxupquote{doppyo.utils.get\_lat\_name()}},                 \sphinxcode{\sphinxupquote{doppyo.utils.get\_lon\_name()}}, etc).
\item[] Pressure levels must be provided in units of hPa
\item[] The terms Sn and Ln, which are computed when Pe and Ke are requested with spectral=True,                 rely on “triple terms” that are very intensive and can take a significant amount of time                 and memory to compute (see \_triple\_terms() below). Often (i.e. for arrays of sufficient                 size to be of interest) requesting these terms yeilds a MemoryError\textendash{}if working in memory                \textendash{}or a KilledWorkerError\textendash{}if working out of memory
\end{DUlineblock}

To do
\begin{itemize}
\item {} 
Arrays that are sufficiently large to be interesting currently max out the available memory when                 Sn or Ln are requested. I need to implement a less hungry method for computing the “triple terms”                 (see \_triple\_terms() below)

\end{itemize}
\subsubsection*{Examples}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{temp} \PYG{o}{=} \PYG{n}{xr}\PYG{o}{.}\PYG{n}{DataArray}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{random}\PYG{o}{.}\PYG{n}{normal}\PYG{p}{(}\PYG{n}{size}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{90}\PYG{p}{,}\PYG{l+m+mi}{90}\PYG{p}{,}\PYG{l+m+mi}{9}\PYG{p}{,}\PYG{l+m+mi}{5}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} 
\PYG{g+gp}{... }                    \PYG{n}{coords}\PYG{o}{=}\PYG{p}{[}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{lat}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{90}\PYG{p}{,}\PYG{l+m+mi}{90}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{lon}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{l+m+mi}{360}\PYG{p}{,}\PYG{l+m+mi}{4}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} 
\PYG{g+gp}{... }                            \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{level}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{100}\PYG{p}{,}\PYG{l+m+mi}{1000}\PYG{p}{,}\PYG{l+m+mi}{100}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} 
\PYG{g+gp}{... }                            \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{time}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{pd}\PYG{o}{.}\PYG{n}{date\PYGZus{}range}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{2000\PYGZhy{}01\PYGZhy{}01}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{periods}\PYG{o}{=}\PYG{l+m+mi}{5}\PYG{p}{,} \PYG{n}{freq}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{M}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{p}{)}\PYG{p}{]}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{u} \PYG{o}{=} \PYG{n}{xr}\PYG{o}{.}\PYG{n}{DataArray}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{random}\PYG{o}{.}\PYG{n}{normal}\PYG{p}{(}\PYG{n}{size}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{90}\PYG{p}{,}\PYG{l+m+mi}{90}\PYG{p}{,}\PYG{l+m+mi}{9}\PYG{p}{,}\PYG{l+m+mi}{5}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} 
\PYG{g+gp}{... }                 \PYG{n}{coords}\PYG{o}{=}\PYG{p}{[}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{lat}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{90}\PYG{p}{,}\PYG{l+m+mi}{90}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{lon}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{l+m+mi}{360}\PYG{p}{,}\PYG{l+m+mi}{4}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} 
\PYG{g+gp}{... }                         \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{level}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{100}\PYG{p}{,}\PYG{l+m+mi}{1000}\PYG{p}{,}\PYG{l+m+mi}{100}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} 
\PYG{g+gp}{... }                         \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{time}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{pd}\PYG{o}{.}\PYG{n}{date\PYGZus{}range}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{2000\PYGZhy{}01\PYGZhy{}01}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{periods}\PYG{o}{=}\PYG{l+m+mi}{5}\PYG{p}{,} \PYG{n}{freq}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{M}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{p}{)}\PYG{p}{]}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{v} \PYG{o}{=} \PYG{n}{xr}\PYG{o}{.}\PYG{n}{DataArray}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{random}\PYG{o}{.}\PYG{n}{normal}\PYG{p}{(}\PYG{n}{size}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{90}\PYG{p}{,}\PYG{l+m+mi}{90}\PYG{p}{,}\PYG{l+m+mi}{9}\PYG{p}{,}\PYG{l+m+mi}{5}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} 
\PYG{g+gp}{... }                 \PYG{n}{coords}\PYG{o}{=}\PYG{p}{[}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{lat}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{90}\PYG{p}{,}\PYG{l+m+mi}{90}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{lon}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{l+m+mi}{360}\PYG{p}{,}\PYG{l+m+mi}{4}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} 
\PYG{g+gp}{... }                         \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{level}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{100}\PYG{p}{,}\PYG{l+m+mi}{1000}\PYG{p}{,}\PYG{l+m+mi}{100}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} 
\PYG{g+gp}{... }                         \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{time}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{pd}\PYG{o}{.}\PYG{n}{date\PYGZus{}range}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{2000\PYGZhy{}01\PYGZhy{}01}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{periods}\PYG{o}{=}\PYG{l+m+mi}{5}\PYG{p}{,} \PYG{n}{freq}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{M}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{p}{)}\PYG{p}{]}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{omega} \PYG{o}{=} \PYG{n}{xr}\PYG{o}{.}\PYG{n}{DataArray}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{random}\PYG{o}{.}\PYG{n}{normal}\PYG{p}{(}\PYG{n}{size}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{90}\PYG{p}{,}\PYG{l+m+mi}{90}\PYG{p}{,}\PYG{l+m+mi}{9}\PYG{p}{,}\PYG{l+m+mi}{5}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} 
\PYG{g+gp}{... }                     \PYG{n}{coords}\PYG{o}{=}\PYG{p}{[}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{lat}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{90}\PYG{p}{,}\PYG{l+m+mi}{90}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{lon}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{l+m+mi}{360}\PYG{p}{,}\PYG{l+m+mi}{4}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} 
\PYG{g+gp}{... }                             \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{level}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{100}\PYG{p}{,}\PYG{l+m+mi}{1000}\PYG{p}{,}\PYG{l+m+mi}{100}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} 
\PYG{g+gp}{... }                             \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{time}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{pd}\PYG{o}{.}\PYG{n}{date\PYGZus{}range}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{2000\PYGZhy{}01\PYGZhy{}01}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{periods}\PYG{o}{=}\PYG{l+m+mi}{5}\PYG{p}{,} \PYG{n}{freq}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{M}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{p}{)}\PYG{p}{]}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{gh} \PYG{o}{=} \PYG{n}{xr}\PYG{o}{.}\PYG{n}{DataArray}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{random}\PYG{o}{.}\PYG{n}{normal}\PYG{p}{(}\PYG{n}{size}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{90}\PYG{p}{,}\PYG{l+m+mi}{90}\PYG{p}{,}\PYG{l+m+mi}{9}\PYG{p}{,}\PYG{l+m+mi}{5}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} 
\PYG{g+gp}{... }                  \PYG{n}{coords}\PYG{o}{=}\PYG{p}{[}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{lat}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{90}\PYG{p}{,}\PYG{l+m+mi}{90}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{lon}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{l+m+mi}{360}\PYG{p}{,}\PYG{l+m+mi}{4}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} 
\PYG{g+gp}{... }                          \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{level}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{100}\PYG{p}{,}\PYG{l+m+mi}{1000}\PYG{p}{,}\PYG{l+m+mi}{100}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} 
\PYG{g+gp}{... }                          \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{time}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{pd}\PYG{o}{.}\PYG{n}{date\PYGZus{}range}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{2000\PYGZhy{}01\PYGZhy{}01}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{periods}\PYG{o}{=}\PYG{l+m+mi}{5}\PYG{p}{,} \PYG{n}{freq}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{M}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{p}{)}\PYG{p}{]}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{doppyo}\PYG{o}{.}\PYG{n}{diagnostic}\PYG{o}{.}\PYG{n}{atmos\PYGZus{}energy\PYGZus{}cycle}\PYG{p}{(}\PYG{n}{temp}\PYG{p}{,} \PYG{n}{u}\PYG{p}{,} \PYG{n}{v}\PYG{p}{,} \PYG{n}{omega}\PYG{p}{,} \PYG{n}{gh}\PYG{p}{,} \PYG{n}{spectral}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{)}
\PYG{g+go}{\PYGZlt{}xarray.Dataset\PYGZgt{}}
\PYG{g+go}{Dimensions:  (lat: 90, level: 9, n: 41, time: 5)}
\PYG{g+go}{Coordinates:}
\PYG{g+go}{  * level    (level) int64 100 200 300 400 500 600 700 800 900}
\PYG{g+go}{  * time     (time) datetime64[ns] 2000\PYGZhy{}01\PYGZhy{}31 2000\PYGZhy{}02\PYGZhy{}29 ... 2000\PYGZhy{}05\PYGZhy{}31}
\PYG{g+go}{  * lat      (lat) int64 \PYGZhy{}90 \PYGZhy{}88 \PYGZhy{}86 \PYGZhy{}84 \PYGZhy{}82 \PYGZhy{}80 \PYGZhy{}78 ... 76 78 80 82 84 86 88}
\PYG{g+go}{  * n        (n) float64 \PYGZhy{}20.0 \PYGZhy{}19.0 \PYGZhy{}18.0 \PYGZhy{}17.0 \PYGZhy{}16.0 ... 17.0 18.0 19.0 20.0}
\PYG{g+go}{Data variables:}
\PYG{g+go}{    gamma    (level, time) float64 8.993 120.3 68.1 ... \PYGZhy{}6.874 1.083 \PYGZhy{}1.383}
\PYG{g+go}{    Pz\PYGZus{}int   (level, time, lat) float64 83.76 64.07 67.67 ... \PYGZhy{}8.283 \PYGZhy{}0.7205}
\PYG{g+go}{    Pz       (time) float64 \PYGZhy{}9.73e+04 8.225e+05 \PYGZhy{}1.892e+04 \PYGZhy{}4.197e+06 \PYGZhy{}9.113e+05}
\PYG{g+go}{    Kz\PYGZus{}int   (lat, level, time) float64 0.03326 0.01417 ... 0.01454 0.005276}
\PYG{g+go}{    Kz       (time) float64 88.08 93.48 97.19 91.19 85.38}
\PYG{g+go}{    Cz\PYGZus{}int   (level, lat, time) float64 0.0001505 \PYGZhy{}6.762e\PYGZhy{}05 ... \PYGZhy{}3.222e\PYGZhy{}06}
\PYG{g+go}{    Cz       (time) float64 0.01983 0.02128 \PYGZhy{}0.04917 \PYGZhy{}0.04136 \PYGZhy{}0.04431}
\PYG{g+go}{    Pn\PYGZus{}int   (level, time, lat, n) float64 109.5 163.6 132.4 ... \PYGZhy{}0.5592 \PYGZhy{}31.31}
\PYG{g+go}{    Pn       (time, n) float64 \PYGZhy{}1.496e+05 \PYGZhy{}1.48e+05 ... \PYGZhy{}1.712e+06 \PYGZhy{}1.534e+06}
\PYG{g+go}{    Sn\PYGZus{}int   (level, time, n, lat) complex128 (\PYGZhy{}1.635e+12+1.365e+12j) ... (1.546e\PYGZhy{}04\PYGZhy{}3.464e\PYGZhy{}03j)}
\PYG{g+go}{    Sn       (time, n) float64 54.46 42.84 39.39 10.27 ... 43.73 55.43 37.28}
\PYG{g+go}{    Kn\PYGZus{}int   (lat, n, level, time) float64 0.02795 0.02618 ... 0.0314 0.005119}
\PYG{g+go}{    Kn       (n, time) float64 184.5 179.1 183.1 186.4 ... 183.1 186.4 176.6}
\PYG{g+go}{    Ln\PYGZus{}int   (n, lat, level, time) complex128 (\PYGZhy{}1.401e+09+4.623e+08j) ... (2.400e\PYGZhy{}06+9.272e\PYGZhy{}07j)}
\PYG{g+go}{    Ln       (n, time) float64 7.325e\PYGZhy{}05 0.0001285 ... 8.57e\PYGZhy{}05 0.0001433}
\PYG{g+go}{    Rn\PYGZus{}int   (level, time, lat, n) complex128 (5.631e\PYGZhy{}03\PYGZhy{}1.433e\PYGZhy{}17j) ... (\PYGZhy{}3.295e\PYGZhy{}04+8.862e\PYGZhy{}19j)}
\PYG{g+go}{    Rn       (time, n) float64 0.3357 0.5211 0.00877 ... 3.811 0.04257 3.209}
\PYG{g+go}{    Cn\PYGZus{}int   (level, lat, n, time) complex128 (\PYGZhy{}1.694e\PYGZhy{}04+4.232e\PYGZhy{}19j) ... (\PYGZhy{}1.836e\PYGZhy{}04+4.979e\PYGZhy{}19j)}
\PYG{g+go}{    Cn       (n, time) float64 0.09795 0.04268 0.01845 ... 0.04054 0.03553}
\PYG{g+go}{    Mn\PYGZus{}int   (lat, n, level, time) complex128 (\PYGZhy{}1.376e+06+2.933e\PYGZhy{}09j) ... (5.344e\PYGZhy{}07\PYGZhy{}1.670e\PYGZhy{}21j)}
\PYG{g+go}{    Mn       (n, time) float64 1.526e+06 8.963e+05 ... 4.038e+06 8.648e+05}
\PYG{g+go}{    Gz\PYGZus{}int   (level, lat, time) float64 \PYGZhy{}0.01321 \PYGZhy{}0.2201 ... \PYGZhy{}6.633e\PYGZhy{}05}
\PYG{g+go}{    Gz       (time) float64 1.33 \PYGZhy{}10.62 27.5 \PYGZhy{}31.06 \PYGZhy{}10.44}
\PYG{g+go}{    Ge\PYGZus{}int   (level, lat, time) float64 0.01375 0.2213 ... 0.0007708 2.494e\PYGZhy{}05}
\PYG{g+go}{    Ge       (time) float64 \PYGZhy{}1.011 10.69 \PYGZhy{}27.39 31.14 10.57}
\PYG{g+go}{    Dz\PYGZus{}int   (level, lat, time) float64 7.444e+07 \PYGZhy{}6.406e+07 ... \PYGZhy{}3.544e\PYGZhy{}06}
\PYG{g+go}{    Dz       (time) float64 1.009e+07 6.951e+06 1.85e+07 1.491e+07 1.306e+07}
\PYG{g+go}{    De\PYGZus{}int   (level, lat, time) float64 7.444e+07 \PYGZhy{}6.406e+07 ... \PYGZhy{}3.849e\PYGZhy{}05}
\PYG{g+go}{    De       (time) float64 1.009e+07 6.951e+06 1.85e+07 1.491e+07 1.306e+07}
\end{sphinxVerbatim}

\end{fulllineitems}

\index{isotherm\_depth() (in module diagnostic)@\spxentry{isotherm\_depth()}\spxextra{in module diagnostic}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{diagnostic_doc:diagnostic.isotherm_depth}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{diagnostic.}}\sphinxbfcode{\sphinxupquote{isotherm\_depth}}}{\emph{temp}, \emph{target\_temp=20}, \emph{depth\_name=None}}{}
Returns the depth of an isotherm given a target temperature. If no temperatures in the column
exceed the target temperature, a nan is returned at that point

\begin{DUlineblock}{0em}
\item[] Author: Thomas Moore
\item[] Date: 02/10/2018
\end{DUlineblock}
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{description}
\item[{\sphinxstylestrong{temp}}] \leavevmode{[}xarray DataArray{]}
Array containing values of temperature with at least a depth dimension

\item[{\sphinxstylestrong{target\_temp}}] \leavevmode{[}value, optional{]}
Value of temperature used to compute isotherm depth. Default value is 20 degC

\item[{\sphinxstylestrong{depth\_name}}] \leavevmode{[}str, optional{]}
Name of depth coordinate. If None, doppyo will attempt to determine depth\_name                     automatically

\end{description}

\item[{Returns}] \leavevmode\begin{description}
\item[{\sphinxstylestrong{isotherm\_depth}}] \leavevmode{[}xarray DataArray{]}
Array containing the depth of the requested isotherm

\end{description}

\end{description}\end{quote}
\subsubsection*{Notes}

\begin{DUlineblock}{0em}
\item[] All input array coordinates must follow standard naming (see \sphinxcode{\sphinxupquote{doppyo.utils.get\_lat\_name()}},                 \sphinxcode{\sphinxupquote{doppyo.utils.get\_lon\_name()}}, etc)
\item[] If multiple occurences of target occur along the depth coordinate, only the maximum value of                 coord is returned
\item[] The current version includes no interpolation between grid spacing. This should be added as                 an option in the future
\end{DUlineblock}
\subsubsection*{Examples}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{temp} \PYG{o}{=} \PYG{n}{xr}\PYG{o}{.}\PYG{n}{DataArray}\PYG{p}{(}\PYG{l+m+mi}{20} \PYG{o}{+} \PYG{n}{np}\PYG{o}{.}\PYG{n}{random}\PYG{o}{.}\PYG{n}{normal}\PYG{p}{(}\PYG{n}{scale}\PYG{o}{=}\PYG{l+m+mi}{5}\PYG{p}{,} \PYG{n}{size}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{4}\PYG{p}{,}\PYG{l+m+mi}{4}\PYG{p}{,}\PYG{l+m+mi}{10}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} 
\PYG{g+gp}{... }                    \PYG{n}{coords}\PYG{o}{=}\PYG{p}{[}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{lat}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{90}\PYG{p}{,}\PYG{l+m+mi}{90}\PYG{p}{,}\PYG{l+m+mi}{45}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{lon}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{l+m+mi}{360}\PYG{p}{,}\PYG{l+m+mi}{90}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} 
\PYG{g+gp}{... }                            \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{depth}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{2000}\PYG{p}{,}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{200}\PYG{p}{)}\PYG{p}{)}\PYG{p}{]}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{doppyo}\PYG{o}{.}\PYG{n}{diagnostic}\PYG{o}{.}\PYG{n}{isotherm\PYGZus{}depth}\PYG{p}{(}\PYG{n}{temp}\PYG{p}{)}
\PYG{g+go}{\PYGZlt{}xarray.DataArray \PYGZsq{}isosurface\PYGZsq{} (lat: 4, lon: 4)\PYGZgt{}}
\PYG{g+go}{array([[ 400., 1600., 2000.,  800.],}
\PYG{g+go}{       [1800., 2000., 1800., 2000.],}
\PYG{g+go}{       [2000., 2000., 2000., 1600.],}
\PYG{g+go}{       [1400., 2000., 2000., 2000.]])}
\PYG{g+go}{Coordinates:}
\PYG{g+go}{  * lat      (lat) int64 \PYGZhy{}90 \PYGZhy{}45 0 45}
\PYG{g+go}{  * lon      (lon) int64 0 90 180 270}
\end{sphinxVerbatim}

\end{fulllineitems}

\index{pwelch() (in module diagnostic)@\spxentry{pwelch()}\spxextra{in module diagnostic}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{diagnostic_doc:diagnostic.pwelch}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{diagnostic.}}\sphinxbfcode{\sphinxupquote{pwelch}}}{\emph{da1}, \emph{da2}, \emph{dim}, \emph{nwindow}, \emph{overlap=50}, \emph{dx=None}, \emph{hanning=False}}{}
Compute the cross/power spectral density along a dimension using welch’s method. Note that                 the spectral density is always computed relative to a “frequency” f = 1/dx (see Notes for                 details)

\begin{DUlineblock}{0em}
\item[] Author: Dougie Squire
\item[] Date: 20/07/2018
\end{DUlineblock}
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{description}
\item[{\sphinxstylestrong{da1}}] \leavevmode{[}xarray DataArray{]}
First array of data to use in spectral density calculation. For power spectral density,                     da1 = da2

\item[{\sphinxstylestrong{da2}}] \leavevmode{[}xarray DataArray{]}
Second array of data to use in spectral density calculation. For power spectral density,                     da1 = da2

\item[{\sphinxstylestrong{dim}}] \leavevmode{[}str{]}
Dimension to compute spectral density along

\item[{\sphinxstylestrong{nwindow}}] \leavevmode{[}value{]}
Length of the signal segments for pwelch calculation

\item[{\sphinxstylestrong{overlap}}] \leavevmode{[}value, optional{]}
Percentage overlap of the signal segments for pwelch calculation

\item[{\sphinxstylestrong{dx}}] \leavevmode{[}value, optional{]}
Spacing along the dimension dim. If None, dx is determined from the coordinate dim. For                     consistency between spatial and temporal dim, spectra is computed relative to a “frequency”,                     f = 1/dx, where dx is the spacing along dim, e.g.:
\begin{itemize}
\item {} 
for temporal dim, dx is computed in seconds. Thus, f = 1/seconds = Hz

\item {} 
for spatial dim in meters, f = 1/meters = k/(2*pi)

\item {} 
for spatial dim in degrees, f = 1/degrees = k/360

\end{itemize}

If converting the “frequency” to wavenumber, for example, one must also adjust the spectra                     magnitude so that the integral remains equal to the variance, e.g. for spatial spectra,                    k = f*(2*pi)  -\textgreater{}  phi\_new = phi\_old/(2*pi)

\item[{\sphinxstylestrong{hanning}}] \leavevmode{[}bool, optional{]}
If True, a Hanning window weighting is applied prior to the fft

\end{description}

\item[{Returns}] \leavevmode\begin{description}
\item[{\sphinxstylestrong{spectra}}] \leavevmode{[}xarray DataArray{]}
Array containing the power spectral density of the input array(s)

\end{description}

\end{description}\end{quote}
\subsubsection*{Examples}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{u} \PYG{o}{=} \PYG{n}{xr}\PYG{o}{.}\PYG{n}{DataArray}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{random}\PYG{o}{.}\PYG{n}{normal}\PYG{p}{(}\PYG{n}{size}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{500}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} 
\PYG{g+gp}{... }                 \PYG{n}{coords}\PYG{o}{=}\PYG{p}{[}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{time}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{pd}\PYG{o}{.}\PYG{n}{date\PYGZus{}range}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{2000\PYGZhy{}01\PYGZhy{}01}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{periods}\PYG{o}{=}\PYG{l+m+mi}{500}\PYG{p}{,} \PYG{n}{freq}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{D}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{p}{)}\PYG{p}{]}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{spectra} \PYG{o}{=} \PYG{n}{doppyo}\PYG{o}{.}\PYG{n}{diagnostic}\PYG{o}{.}\PYG{n}{pwelch}\PYG{p}{(}\PYG{n}{u}\PYG{p}{,} \PYG{n}{u}\PYG{p}{,} \PYG{n}{dim}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{time}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{nwindow}\PYG{o}{=}\PYG{l+m+mi}{20}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{seconds\PYGZus{}to\PYGZus{}days} \PYG{o}{=} \PYG{l+m+mi}{60}\PYG{o}{*}\PYG{l+m+mi}{60}\PYG{o}{*}\PYG{l+m+mi}{24}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{spectra}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{f\PYGZus{}time}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{=} \PYG{n}{seconds\PYGZus{}to\PYGZus{}days}\PYG{o}{*}\PYG{n}{spectra}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{f\PYGZus{}time}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{c+c1}{\PYGZsh{} Change freq from Hz to 1/days}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{spectra} \PYG{o}{=} \PYG{n}{spectra}\PYG{o}{/}\PYG{n}{seconds\PYGZus{}to\PYGZus{}days}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n+nb}{print}\PYG{p}{(}\PYG{n}{spectra}\PYG{p}{)}
\PYG{g+go}{\PYGZlt{}xarray.DataArray \PYGZsq{}spectra\PYGZsq{} (f\PYGZus{}time: 11)\PYGZgt{}}
\PYG{g+go}{array([1.381912, 1.89882 , 1.641378, 1.939686, 2.218824, 1.941639, 2.142277,}
\PYG{g+go}{       1.689319, 1.983302, 2.225709, 2.732023])}
\PYG{g+go}{Coordinates:}
\PYG{g+go}{  * f\PYGZus{}time   (f\PYGZus{}time) float64 0.0 0.05 0.1 0.15 0.2 0.25 0.3 0.35 0.4 0.45 0.5}
\end{sphinxVerbatim}

\end{fulllineitems}

\index{inband\_variance() (in module diagnostic)@\spxentry{inband\_variance()}\spxextra{in module diagnostic}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{diagnostic_doc:diagnostic.inband_variance}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{diagnostic.}}\sphinxbfcode{\sphinxupquote{inband\_variance}}}{\emph{da}, \emph{dim}, \emph{bounds}, \emph{nwindow}, \emph{overlap=50}}{}
Compute the in-band variance along a specified dimension.

\begin{DUlineblock}{0em}
\item[] Author: Dougie Squire
\item[] Date: 20/07/2018
\end{DUlineblock}
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{description}
\item[{\sphinxstylestrong{da}}] \leavevmode{[}xarray DataArray{]}
Array with which to compute in-band variance

\item[{\sphinxstylestrong{dim}}] \leavevmode{[}str{]}
Dimension along which to compute in-band variance

\item[{\sphinxstylestrong{bounds}}] \leavevmode{[}sequence{]}
Frequency bounds for in-band variance calculation. Note that for consistency between                     spatial and temporal dim, all spectra are computed relative to a “frequency”, f = 1/dx,                     where dx is the spacing along dim, e.g.:
\begin{itemize}
\item {} 
for temporal dim, dx is computed in seconds. Thus, f = 1/seconds = Hz

\item {} 
for spatial dim in meters, f = 1/meters = k/(2*pi)

\item {} 
for spatial dim in degrees, f = 1/degrees = k/360

\end{itemize}

Thus, bounds must be provided in a way consistent with this, e.g.:
\begin{itemize}
\item {} 
for temporal dim, bounds = 1 / (60*60*24*{[}d1, d2, d3{]}), where d\# are numbers of days

\item {} 
for spatial dim, bounds = 1 / {[}l1, l2, l3{]}, where l\# are numbers of meters, degrees, etc

\end{itemize}

\item[{\sphinxstylestrong{nwindow}}] \leavevmode{[}value{]}
Length of the signal segments for pwelch calculation

\item[{\sphinxstylestrong{overlap}}] \leavevmode{[}value, optional{]}
Percentage overlap of the signal segments for pwelch calculation

\end{description}

\item[{Returns}] \leavevmode\begin{description}
\item[{\sphinxstylestrong{inband\_var}}] \leavevmode{[}xarray DataArray{]}
Array containing the in-band variances of the input array

\end{description}

\end{description}\end{quote}
\subsubsection*{Examples}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{A} \PYG{o}{=} \PYG{n}{xr}\PYG{o}{.}\PYG{n}{DataArray}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{random}\PYG{o}{.}\PYG{n}{normal}\PYG{p}{(}\PYG{n}{size}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{500}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} 
\PYG{g+gp}{... }                 \PYG{n}{coords}\PYG{o}{=}\PYG{p}{[}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{time}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{pd}\PYG{o}{.}\PYG{n}{date\PYGZus{}range}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{2000\PYGZhy{}01\PYGZhy{}01}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{periods}\PYG{o}{=}\PYG{l+m+mi}{500}\PYG{p}{,} \PYG{n}{freq}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{D}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{p}{)}\PYG{p}{]}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{doppyo}\PYG{o}{.}\PYG{n}{diagnostic}\PYG{o}{.}\PYG{n}{inband\PYGZus{}variance}\PYG{p}{(}\PYG{n}{A}\PYG{p}{,} \PYG{n}{dim}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{time}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} 
\PYG{g+gp}{... }                                  \PYG{n}{bounds}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{o}{/}\PYG{p}{(}\PYG{l+m+mi}{60}\PYG{o}{*}\PYG{l+m+mi}{60}\PYG{o}{*}\PYG{l+m+mi}{24}\PYG{o}{*}\PYG{n}{np}\PYG{o}{.}\PYG{n}{array}\PYG{p}{(}\PYG{p}{[}\PYG{l+m+mi}{2}\PYG{p}{,} \PYG{l+m+mi}{5}\PYG{p}{,} \PYG{l+m+mi}{10}\PYG{p}{]}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} \PYG{n}{nwindow}\PYG{o}{=}\PYG{l+m+mi}{20}\PYG{p}{)}
\PYG{g+go}{\PYGZlt{}xarray.DataArray \PYGZsq{}in\PYGZhy{}band\PYGZsq{} (f\PYGZus{}time\PYGZus{}bins: 2)\PYGZgt{}}
\PYG{g+go}{array([0.106615, 0.492033])}
\PYG{g+go}{Coordinates:}
\PYG{g+go}{  * f\PYGZus{}time\PYGZus{}bins  (f\PYGZus{}time\PYGZus{}bins) object [1.16e\PYGZhy{}06, 2.31e\PYGZhy{}06) [2.31e\PYGZhy{}06, 5.79e\PYGZhy{}06)}
\end{sphinxVerbatim}

\end{fulllineitems}

\index{nino3() (in module diagnostic)@\spxentry{nino3()}\spxextra{in module diagnostic}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{diagnostic_doc:diagnostic.nino3}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{diagnostic.}}\sphinxbfcode{\sphinxupquote{nino3}}}{\emph{sst\_anom}}{}
Returns Nino-3 index

\begin{DUlineblock}{0em}
\item[] Author: Dougie Squire
\item[] Date: 10/04/2018
\end{DUlineblock}
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{description}
\item[{\sphinxstylestrong{sst\_anom}}] \leavevmode{[}xarray DataArray{]}
Array containing sea surface temperature anomalies

\end{description}

\item[{Returns}] \leavevmode\begin{description}
\item[{\sphinxstylestrong{nino3}}] \leavevmode{[}xarray DataArray{]}
Average of the provided sst anomalies over the nino-3 box

\end{description}

\end{description}\end{quote}
\subsubsection*{Examples}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{sst} \PYG{o}{=} \PYG{n}{xr}\PYG{o}{.}\PYG{n}{DataArray}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{random}\PYG{o}{.}\PYG{n}{normal}\PYG{p}{(}\PYG{n}{size}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{90}\PYG{p}{,}\PYG{l+m+mi}{90}\PYG{p}{,}\PYG{l+m+mi}{24}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} 
\PYG{g+gp}{... }                   \PYG{n}{coords}\PYG{o}{=}\PYG{p}{[}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{lat}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{90}\PYG{p}{,}\PYG{l+m+mi}{90}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{lon}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{l+m+mi}{360}\PYG{p}{,}\PYG{l+m+mi}{4}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} 
\PYG{g+gp}{... }                           \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{time}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{pd}\PYG{o}{.}\PYG{n}{date\PYGZus{}range}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{2000\PYGZhy{}01\PYGZhy{}01}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{periods}\PYG{o}{=}\PYG{l+m+mi}{24}\PYG{p}{,} \PYG{n}{freq}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{M}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{p}{)}\PYG{p}{]}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{sst\PYGZus{}clim} \PYG{o}{=} \PYG{n}{sst}\PYG{o}{.}\PYG{n}{groupby}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{time.month}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{o}{.}\PYG{n}{mean}\PYG{p}{(}\PYG{n}{dim}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{time}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{sst\PYGZus{}anom} \PYG{o}{=} \PYG{n}{doppyo}\PYG{o}{.}\PYG{n}{utils}\PYG{o}{.}\PYG{n}{anomalize}\PYG{p}{(}\PYG{n}{sst}\PYG{p}{,} \PYG{n}{sst\PYGZus{}clim}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{doppyo}\PYG{o}{.}\PYG{n}{diagnostic}\PYG{o}{.}\PYG{n}{nino3}\PYG{p}{(}\PYG{n}{sst\PYGZus{}anom}\PYG{p}{)}
\PYG{g+go}{\PYGZlt{}xarray.DataArray \PYGZsq{}nino3\PYGZsq{} (time: 24)\PYGZgt{}}
\PYG{g+go}{array([\PYGZhy{}0.137317, \PYGZhy{}0.094808, \PYGZhy{}0.01091 , \PYGZhy{}0.04653 ,  0.030562, \PYGZhy{}0.065515,}
\PYG{g+go}{       \PYGZhy{}0.109851,  0.118016,  0.092496, \PYGZhy{}0.030821, \PYGZhy{}0.011724, \PYGZhy{}0.002773,}
\PYG{g+go}{        0.137317,  0.094808,  0.01091 ,  0.04653 , \PYGZhy{}0.030562,  0.065515,}
\PYG{g+go}{        0.109851, \PYGZhy{}0.118016, \PYGZhy{}0.092496,  0.030821,  0.011724,  0.002773])}
\PYG{g+go}{Coordinates:}
\PYG{g+go}{  * time     (time) datetime64[ns] 2000\PYGZhy{}01\PYGZhy{}31 2000\PYGZhy{}02\PYGZhy{}29 ... 2001\PYGZhy{}12\PYGZhy{}31}
\end{sphinxVerbatim}

\end{fulllineitems}

\index{nino34() (in module diagnostic)@\spxentry{nino34()}\spxextra{in module diagnostic}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{diagnostic_doc:diagnostic.nino34}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{diagnostic.}}\sphinxbfcode{\sphinxupquote{nino34}}}{\emph{sst\_anom}}{}
Returns Nino-3.4 index

\begin{DUlineblock}{0em}
\item[] Author: Dougie Squire
\item[] Date: 10/04/2018
\end{DUlineblock}
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{description}
\item[{\sphinxstylestrong{sst\_anom}}] \leavevmode{[}xarray DataArray{]}
Array containing sea surface temperature anomalies

\end{description}

\item[{Returns}] \leavevmode\begin{description}
\item[{\sphinxstylestrong{nino34}}] \leavevmode{[}xarray DataArray{]}
Average of the provided sst anomalies over the nino-3.4 box

\end{description}

\end{description}\end{quote}
\subsubsection*{Examples}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{sst} \PYG{o}{=} \PYG{n}{xr}\PYG{o}{.}\PYG{n}{DataArray}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{random}\PYG{o}{.}\PYG{n}{normal}\PYG{p}{(}\PYG{n}{size}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{90}\PYG{p}{,}\PYG{l+m+mi}{90}\PYG{p}{,}\PYG{l+m+mi}{24}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} 
\PYG{g+gp}{... }                   \PYG{n}{coords}\PYG{o}{=}\PYG{p}{[}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{lat}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{90}\PYG{p}{,}\PYG{l+m+mi}{90}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{lon}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{l+m+mi}{360}\PYG{p}{,}\PYG{l+m+mi}{4}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} 
\PYG{g+gp}{... }                           \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{time}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{pd}\PYG{o}{.}\PYG{n}{date\PYGZus{}range}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{2000\PYGZhy{}01\PYGZhy{}01}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{periods}\PYG{o}{=}\PYG{l+m+mi}{24}\PYG{p}{,} \PYG{n}{freq}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{M}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{p}{)}\PYG{p}{]}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{sst\PYGZus{}clim} \PYG{o}{=} \PYG{n}{sst}\PYG{o}{.}\PYG{n}{groupby}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{time.month}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{o}{.}\PYG{n}{mean}\PYG{p}{(}\PYG{n}{dim}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{time}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{sst\PYGZus{}anom} \PYG{o}{=} \PYG{n}{doppyo}\PYG{o}{.}\PYG{n}{utils}\PYG{o}{.}\PYG{n}{anomalize}\PYG{p}{(}\PYG{n}{sst}\PYG{p}{,} \PYG{n}{sst\PYGZus{}clim}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{doppyo}\PYG{o}{.}\PYG{n}{diagnostic}\PYG{o}{.}\PYG{n}{nino34}\PYG{p}{(}\PYG{n}{sst\PYGZus{}anom}\PYG{p}{)}
\PYG{g+go}{\PYGZlt{}xarray.DataArray \PYGZsq{}nino34\PYGZsq{} (time: 24)\PYGZgt{}}
\PYG{g+go}{array([\PYGZhy{}0.052202,  0.00467 ,  0.121013,  0.007983, \PYGZhy{}0.070645,  0.051945,}
\PYG{g+go}{       \PYGZhy{}0.045485,  0.065569, \PYGZhy{}0.018723, \PYGZhy{}0.053734,  0.10527 , \PYGZhy{}0.113451,}
\PYG{g+go}{        0.052202, \PYGZhy{}0.00467 , \PYGZhy{}0.121013, \PYGZhy{}0.007983,  0.070645, \PYGZhy{}0.051945,}
\PYG{g+go}{        0.045485, \PYGZhy{}0.065569,  0.018723,  0.053734, \PYGZhy{}0.10527 ,  0.113451])}
\PYG{g+go}{Coordinates:}
\PYG{g+go}{  * time     (time) datetime64[ns] 2000\PYGZhy{}01\PYGZhy{}31 2000\PYGZhy{}02\PYGZhy{}29 ... 2001\PYGZhy{}12\PYGZhy{}31}
\end{sphinxVerbatim}

\end{fulllineitems}

\index{nino4() (in module diagnostic)@\spxentry{nino4()}\spxextra{in module diagnostic}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{diagnostic_doc:diagnostic.nino4}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{diagnostic.}}\sphinxbfcode{\sphinxupquote{nino4}}}{\emph{sst\_anom}}{}
Returns Nino-4 index

\begin{DUlineblock}{0em}
\item[] Author: Dougie Squire
\item[] Date: 10/04/2018
\end{DUlineblock}
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{description}
\item[{\sphinxstylestrong{sst\_anom}}] \leavevmode{[}xarray DataArray{]}
Array containing sea surface temperature anomalies

\end{description}

\item[{Returns}] \leavevmode\begin{description}
\item[{\sphinxstylestrong{nino4}}] \leavevmode{[}xarray DataArray{]}
Average of the provided sst anomalies over the nino-4 box

\end{description}

\end{description}\end{quote}
\subsubsection*{Examples}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{sst} \PYG{o}{=} \PYG{n}{xr}\PYG{o}{.}\PYG{n}{DataArray}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{random}\PYG{o}{.}\PYG{n}{normal}\PYG{p}{(}\PYG{n}{size}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{90}\PYG{p}{,}\PYG{l+m+mi}{90}\PYG{p}{,}\PYG{l+m+mi}{24}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} 
\PYG{g+gp}{... }                   \PYG{n}{coords}\PYG{o}{=}\PYG{p}{[}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{lat}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{90}\PYG{p}{,}\PYG{l+m+mi}{90}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{lon}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{l+m+mi}{360}\PYG{p}{,}\PYG{l+m+mi}{4}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} 
\PYG{g+gp}{... }                           \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{time}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{pd}\PYG{o}{.}\PYG{n}{date\PYGZus{}range}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{2000\PYGZhy{}01\PYGZhy{}01}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{periods}\PYG{o}{=}\PYG{l+m+mi}{24}\PYG{p}{,} \PYG{n}{freq}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{M}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{p}{)}\PYG{p}{]}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{sst\PYGZus{}clim} \PYG{o}{=} \PYG{n}{sst}\PYG{o}{.}\PYG{n}{groupby}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{time.month}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{o}{.}\PYG{n}{mean}\PYG{p}{(}\PYG{n}{dim}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{time}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{sst\PYGZus{}anom} \PYG{o}{=} \PYG{n}{doppyo}\PYG{o}{.}\PYG{n}{utils}\PYG{o}{.}\PYG{n}{anomalize}\PYG{p}{(}\PYG{n}{sst}\PYG{p}{,} \PYG{n}{sst\PYGZus{}clim}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{doppyo}\PYG{o}{.}\PYG{n}{diagnostic}\PYG{o}{.}\PYG{n}{nino4}\PYG{p}{(}\PYG{n}{sst\PYGZus{}anom}\PYG{p}{)}
\PYG{g+go}{\PYGZlt{}xarray.DataArray \PYGZsq{}nino4\PYGZsq{} (time: 24)\PYGZgt{}}
\PYG{g+go}{array([ 0.017431, \PYGZhy{}0.086129,  0.106992, \PYGZhy{}0.097994,  0.109215, \PYGZhy{}0.120221,}
\PYG{g+go}{        0.042459, \PYGZhy{}0.189595,  0.005097,  0.034218,  0.019478,  0.054122,}
\PYG{g+go}{       \PYGZhy{}0.017431,  0.086129, \PYGZhy{}0.106992,  0.097994, \PYGZhy{}0.109215,  0.120221,}
\PYG{g+go}{       \PYGZhy{}0.042459,  0.189595, \PYGZhy{}0.005097, \PYGZhy{}0.034218, \PYGZhy{}0.019478, \PYGZhy{}0.054122])}
\PYG{g+go}{Coordinates:}
\PYG{g+go}{  * time     (time) datetime64[ns] 2000\PYGZhy{}01\PYGZhy{}31 2000\PYGZhy{}02\PYGZhy{}29 ... 2001\PYGZhy{}12\PYGZhy{}31}
\end{sphinxVerbatim}

\end{fulllineitems}

\index{emi() (in module diagnostic)@\spxentry{emi()}\spxextra{in module diagnostic}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{diagnostic_doc:diagnostic.emi}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{diagnostic.}}\sphinxbfcode{\sphinxupquote{emi}}}{\emph{sst\_anom}}{}
Returns El Nino Modoki index

\begin{DUlineblock}{0em}
\item[] Author: Dougie Squire
\item[] Date: 10/04/2018
\end{DUlineblock}
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{description}
\item[{\sphinxstylestrong{sst\_anom}}] \leavevmode{[}xarray DataArray{]}
Array containing sea surface temperature anomalies

\end{description}

\item[{Returns}] \leavevmode\begin{description}
\item[{\sphinxstylestrong{emi}}] \leavevmode{[}xarray DataArray{]}
Array containing the El Nino Modoki index

\end{description}

\end{description}\end{quote}
\subsubsection*{Examples}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{sst} \PYG{o}{=} \PYG{n}{xr}\PYG{o}{.}\PYG{n}{DataArray}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{random}\PYG{o}{.}\PYG{n}{normal}\PYG{p}{(}\PYG{n}{size}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{90}\PYG{p}{,}\PYG{l+m+mi}{90}\PYG{p}{,}\PYG{l+m+mi}{24}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} 
\PYG{g+gp}{... }                   \PYG{n}{coords}\PYG{o}{=}\PYG{p}{[}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{lat}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{90}\PYG{p}{,}\PYG{l+m+mi}{90}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{lon}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{l+m+mi}{360}\PYG{p}{,}\PYG{l+m+mi}{4}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} 
\PYG{g+gp}{... }                           \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{time}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{pd}\PYG{o}{.}\PYG{n}{date\PYGZus{}range}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{2000\PYGZhy{}01\PYGZhy{}01}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{periods}\PYG{o}{=}\PYG{l+m+mi}{24}\PYG{p}{,} \PYG{n}{freq}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{M}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{p}{)}\PYG{p}{]}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{sst\PYGZus{}clim} \PYG{o}{=} \PYG{n}{sst}\PYG{o}{.}\PYG{n}{groupby}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{time.month}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{o}{.}\PYG{n}{mean}\PYG{p}{(}\PYG{n}{dim}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{time}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{sst\PYGZus{}anom} \PYG{o}{=} \PYG{n}{doppyo}\PYG{o}{.}\PYG{n}{utils}\PYG{o}{.}\PYG{n}{anomalize}\PYG{p}{(}\PYG{n}{sst}\PYG{p}{,} \PYG{n}{sst\PYGZus{}clim}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{doppyo}\PYG{o}{.}\PYG{n}{diagnostic}\PYG{o}{.}\PYG{n}{emi}\PYG{p}{(}\PYG{n}{sst\PYGZus{}anom}\PYG{p}{)}
\PYG{g+go}{\PYGZlt{}xarray.DataArray \PYGZsq{}emi\PYGZsq{} (time: 24)\PYGZgt{}}
\PYG{g+go}{array([\PYGZhy{}0.046743,  0.181795,  0.020386, \PYGZhy{}0.215317, \PYGZhy{}0.209294,  0.109291,}
\PYG{g+go}{        0.202055, \PYGZhy{}0.021001, \PYGZhy{}0.013106,  0.094376, \PYGZhy{}0.000516, \PYGZhy{}0.021762,}
\PYG{g+go}{        0.046743, \PYGZhy{}0.181795, \PYGZhy{}0.020386,  0.215317,  0.209294, \PYGZhy{}0.109291,}
\PYG{g+go}{       \PYGZhy{}0.202055,  0.021001,  0.013106, \PYGZhy{}0.094376,  0.000516,  0.021762])}
\PYG{g+go}{Coordinates:}
\PYG{g+go}{  * time     (time) datetime64[ns] 2000\PYGZhy{}01\PYGZhy{}31 2000\PYGZhy{}02\PYGZhy{}29 ... 2001\PYGZhy{}12\PYGZhy{}31}
\end{sphinxVerbatim}

\end{fulllineitems}

\index{dmi() (in module diagnostic)@\spxentry{dmi()}\spxextra{in module diagnostic}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{diagnostic_doc:diagnostic.dmi}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{diagnostic.}}\sphinxbfcode{\sphinxupquote{dmi}}}{\emph{sst\_anom}}{}
Returns dipole mode index

\begin{DUlineblock}{0em}
\item[] Author: Dougie Squire
\item[] Date: 10/04/2018
\end{DUlineblock}
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{description}
\item[{\sphinxstylestrong{sst\_anom}}] \leavevmode{[}xarray DataArray{]}
Array containing sea surface temperature anomalies

\end{description}

\item[{Returns}] \leavevmode\begin{description}
\item[{\sphinxstylestrong{dmi}}] \leavevmode{[}xarray DataArray{]}
Array containing the dipole mode index

\end{description}

\end{description}\end{quote}
\subsubsection*{Examples}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{sst} \PYG{o}{=} \PYG{n}{xr}\PYG{o}{.}\PYG{n}{DataArray}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{random}\PYG{o}{.}\PYG{n}{normal}\PYG{p}{(}\PYG{n}{size}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{90}\PYG{p}{,}\PYG{l+m+mi}{90}\PYG{p}{,}\PYG{l+m+mi}{24}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} 
\PYG{g+gp}{... }                   \PYG{n}{coords}\PYG{o}{=}\PYG{p}{[}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{lat}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{90}\PYG{p}{,}\PYG{l+m+mi}{90}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{lon}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{l+m+mi}{360}\PYG{p}{,}\PYG{l+m+mi}{4}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} 
\PYG{g+gp}{... }                           \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{time}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{pd}\PYG{o}{.}\PYG{n}{date\PYGZus{}range}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{2000\PYGZhy{}01\PYGZhy{}01}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{periods}\PYG{o}{=}\PYG{l+m+mi}{24}\PYG{p}{,} \PYG{n}{freq}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{M}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{p}{)}\PYG{p}{]}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{sst\PYGZus{}clim} \PYG{o}{=} \PYG{n}{sst}\PYG{o}{.}\PYG{n}{groupby}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{time.month}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{o}{.}\PYG{n}{mean}\PYG{p}{(}\PYG{n}{dim}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{time}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{sst\PYGZus{}anom} \PYG{o}{=} \PYG{n}{doppyo}\PYG{o}{.}\PYG{n}{utils}\PYG{o}{.}\PYG{n}{anomalize}\PYG{p}{(}\PYG{n}{sst}\PYG{p}{,} \PYG{n}{sst\PYGZus{}clim}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{doppyo}\PYG{o}{.}\PYG{n}{diagnostic}\PYG{o}{.}\PYG{n}{dmi}\PYG{p}{(}\PYG{n}{sst\PYGZus{}anom}\PYG{p}{)}
\PYG{g+go}{\PYGZlt{}xarray.DataArray \PYGZsq{}dmi\PYGZsq{} (time: 24)\PYGZgt{}}
\PYG{g+go}{array([\PYGZhy{}0.225498,  0.220686,  0.032038,  0.019634,  0.00511 , \PYGZhy{}0.202789,}
\PYG{g+go}{       \PYGZhy{}0.014349, \PYGZhy{}0.293248,  0.020925,  0.114059,  0.066389,  0.238707,}
\PYG{g+go}{        0.225498, \PYGZhy{}0.220686, \PYGZhy{}0.032038, \PYGZhy{}0.019634, \PYGZhy{}0.00511 ,  0.202789,}
\PYG{g+go}{        0.014349,  0.293248, \PYGZhy{}0.020925, \PYGZhy{}0.114059, \PYGZhy{}0.066389, \PYGZhy{}0.238707])}
\PYG{g+go}{Coordinates:}
\PYG{g+go}{  * time     (time) datetime64[ns] 2000\PYGZhy{}01\PYGZhy{}31 2000\PYGZhy{}02\PYGZhy{}29 ... 2001\PYGZhy{}12\PYGZhy{}31}
\end{sphinxVerbatim}

\end{fulllineitems}

\index{soi() (in module diagnostic)@\spxentry{soi()}\spxextra{in module diagnostic}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{diagnostic_doc:diagnostic.soi}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{diagnostic.}}\sphinxbfcode{\sphinxupquote{soi}}}{\emph{slp\_anom}, \emph{lat\_name=None}, \emph{lon\_name=None}, \emph{time\_name=None}}{}
Returns southern oscillation index as defined by NOAA (see, for example,                 \sphinxurl{https://www.esrl.noaa.gov/psd/gcos\_wgsp/Timeseries/SOI/})

\begin{DUlineblock}{0em}
\item[] Author: Dougie Squire
\item[] Date: 10/04/2018
\end{DUlineblock}
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{description}
\item[{\sphinxstylestrong{slp\_anom}}] \leavevmode{[}xarray DataArray{]}
Array containing sea level pressure anomalies

\item[{\sphinxstylestrong{time\_name}}] \leavevmode{[}str, optional{]}
Name of the time dimension. If None, doppyo will attempt to determine time\_name                     automatically

\end{description}

\item[{Returns}] \leavevmode\begin{description}
\item[{\sphinxstylestrong{soi}}] \leavevmode{[}xarray DataArray{]}
Array containing the southern oscillation index

\end{description}

\end{description}\end{quote}
\subsubsection*{Examples}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{slp} \PYG{o}{=} \PYG{n}{xr}\PYG{o}{.}\PYG{n}{DataArray}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{random}\PYG{o}{.}\PYG{n}{normal}\PYG{p}{(}\PYG{n}{size}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{90}\PYG{p}{,}\PYG{l+m+mi}{90}\PYG{p}{,}\PYG{l+m+mi}{24}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} 
\PYG{g+gp}{... }                   \PYG{n}{coords}\PYG{o}{=}\PYG{p}{[}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{lat}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{90}\PYG{p}{,}\PYG{l+m+mi}{90}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{lon}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{l+m+mi}{360}\PYG{p}{,}\PYG{l+m+mi}{4}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} 
\PYG{g+gp}{... }                   \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{time}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{pd}\PYG{o}{.}\PYG{n}{date\PYGZus{}range}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{2000\PYGZhy{}01\PYGZhy{}01}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{periods}\PYG{o}{=}\PYG{l+m+mi}{24}\PYG{p}{,} \PYG{n}{freq}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{M}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{p}{)}\PYG{p}{]}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{slp\PYGZus{}clim} \PYG{o}{=} \PYG{n}{slp}\PYG{o}{.}\PYG{n}{groupby}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{time.month}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{o}{.}\PYG{n}{mean}\PYG{p}{(}\PYG{n}{dim}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{time}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{slp\PYGZus{}anom} \PYG{o}{=} \PYG{n}{doppyo}\PYG{o}{.}\PYG{n}{utils}\PYG{o}{.}\PYG{n}{anomalize}\PYG{p}{(}\PYG{n}{slp}\PYG{p}{,} \PYG{n}{slp\PYGZus{}clim}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{doppyo}\PYG{o}{.}\PYG{n}{diagnostic}\PYG{o}{.}\PYG{n}{soi}\PYG{p}{(}\PYG{n}{slp\PYGZus{}anom}\PYG{p}{)}
\PYG{g+go}{\PYGZlt{}xarray.DataArray \PYGZsq{}soi\PYGZsq{} (time: 24)\PYGZgt{}}
\PYG{g+go}{array([ 0.355277,  0.38263 ,  0.563005, \PYGZhy{}1.256122, \PYGZhy{}1.252341,  0.202942,}
\PYG{g+go}{        0.691819,  0.412523, \PYGZhy{}1.368695,  0.421943,  2.349053,  0.069382,}
\PYG{g+go}{       \PYGZhy{}0.355277, \PYGZhy{}0.38263 , \PYGZhy{}0.563005,  1.256122,  1.252341, \PYGZhy{}0.202942,}
\PYG{g+go}{       \PYGZhy{}0.691819, \PYGZhy{}0.412523,  1.368695, \PYGZhy{}0.421943, \PYGZhy{}2.349053, \PYGZhy{}0.069382])}
\PYG{g+go}{Coordinates:}
\PYG{g+go}{  * time     (time) datetime64[ns] 2000\PYGZhy{}01\PYGZhy{}31 2000\PYGZhy{}02\PYGZhy{}29 ... 2001\PYGZhy{}12\PYGZhy{}31}
\end{sphinxVerbatim}

\end{fulllineitems}



\section{\sphinxstyleliteralintitle{\sphinxupquote{skill}}}
\label{\detokenize{skill_doc:module-skill}}\label{\detokenize{skill_doc:skill}}\label{\detokenize{skill_doc::doc}}\index{skill (module)@\spxentry{skill}\spxextra{module}}
doppyo functions for assessing one dataset relative to another (usually model output to observation)

In the following we refer to the datasets being assessed as comparison data (da\_cmp) and reference
data (da\_ref). We seek to assess the skill of the former relative to the latter. Usually, da\_cmp
and da\_ref comprise model output (e.g. forecasts) and observations, respectively.


\subsection{API}
\label{\detokenize{skill_doc:api}}\index{rank\_histogram() (in module skill)@\spxentry{rank\_histogram()}\spxextra{in module skill}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{skill_doc:skill.rank_histogram}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{skill.}}\sphinxbfcode{\sphinxupquote{rank\_histogram}}}{\emph{da\_cmp}, \emph{da\_ref}, \emph{over\_dims}, \emph{norm=True}, \emph{ensemble\_dim='ensemble'}}{}
Returns the rank histogram along the specified dimensions

\begin{DUlineblock}{0em}
\item[] Authors: Dougie Squire
\item[] Date: 01/11/2018
\end{DUlineblock}
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{description}
\item[{\sphinxstylestrong{da\_cmp}}] \leavevmode{[}xarray DataArray{]}
Array containing data to be compared to reference dataset (usually forecasts). This data                     is used to rank the reference data. Must include an ensemble dimension

\item[{\sphinxstylestrong{da\_ref}}] \leavevmode{[}xarray DataArray{]}
Array containing reference data (usually observations). This data is ranked within the                     comparison data. Dimensions should match those of da\_cmp

\item[{\sphinxstylestrong{over\_dims}}] \leavevmode{[}str or sequence of str{]}
The dimension(s) over which to compute the histogram of ranks

\item[{\sphinxstylestrong{norm}}] \leavevmode{[}bool, optional{]}
If True, rank histograms are normalised by their enclosed area

\item[{\sphinxstylestrong{ensemble\_dim}}] \leavevmode{[}str, optional{]}
The name of the ensemble dimension in da\_cmp

\end{description}

\item[{Returns}] \leavevmode\begin{description}
\item[{\sphinxstylestrong{rank\_histogram}}] \leavevmode{[}xarray DataArray{]}
New DataArray object containing the rank histograms

\end{description}

\end{description}\end{quote}
\subsubsection*{Notes}

See \sphinxurl{http://www.cawcr.gov.au/projects/verification/}
\subsubsection*{Examples}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{da\PYGZus{}cmp} \PYG{o}{=} \PYG{n}{xr}\PYG{o}{.}\PYG{n}{DataArray}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{random}\PYG{o}{.}\PYG{n}{normal}\PYG{p}{(}\PYG{n}{size}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{,}\PYG{l+m+mi}{3}\PYG{p}{,}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} 
\PYG{g+gp}{... }                      \PYG{n}{coords}\PYG{o}{=}\PYG{p}{[}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{x}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{y}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} 
\PYG{g+gp}{... }                              \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{ensemble}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{]}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{da\PYGZus{}ref} \PYG{o}{=} \PYG{n}{xr}\PYG{o}{.}\PYG{n}{DataArray}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{random}\PYG{o}{.}\PYG{n}{normal}\PYG{p}{(}\PYG{n}{size}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{,}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} \PYG{n}{coords}\PYG{o}{=}\PYG{p}{[}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{x}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} 
\PYG{g+gp}{... }                                                            \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{y}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{]}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{doppyo}\PYG{o}{.}\PYG{n}{skill}\PYG{o}{.}\PYG{n}{rank\PYGZus{}histogram}\PYG{p}{(}\PYG{n}{da\PYGZus{}cmp}\PYG{p}{,} \PYG{n}{da\PYGZus{}ref}\PYG{p}{,} \PYG{n}{over\PYGZus{}dims}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{x}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{g+go}{\PYGZlt{}xarray.DataArray \PYGZsq{}rank\PYGZus{}histogram\PYGZsq{} (bins: 4, y: 3)\PYGZgt{}}
\PYG{g+go}{array([[1.      , 0.333333, 0.333333],}
\PYG{g+go}{       [0.      , 0.333333, 0.333333],}
\PYG{g+go}{       [0.      , 0.      , 0.333333],}
\PYG{g+go}{       [0.      , 0.333333, 0.      ]])}
\PYG{g+go}{Coordinates:}
\PYG{g+go}{  * bins     (bins) float64 1.0 2.0 3.0 4.0}
\PYG{g+go}{  * y        (y) int64 0 1 2}
\end{sphinxVerbatim}

\end{fulllineitems}

\index{rps() (in module skill)@\spxentry{rps()}\spxextra{in module skill}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{skill_doc:skill.rps}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{skill.}}\sphinxbfcode{\sphinxupquote{rps}}}{\emph{da\_cmp}, \emph{da\_ref}, \emph{bins}, \emph{over\_dims=None}, \emph{ensemble\_dim='ensemble'}}{}
Returns the ranked probability score

\begin{DUlineblock}{0em}
\item[] Author: Dougie Squire
\item[] Date: 10/05/2018
\end{DUlineblock}
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{description}
\item[{\sphinxstylestrong{da\_cmp}}] \leavevmode{[}xarray DataArray{]}
Array containing data to be compared to reference dataset (usually forecasts)

\item[{\sphinxstylestrong{da\_ref}}] \leavevmode{[}xarray DataArray{]}
Array containing reference data (usually observations)

\item[{\sphinxstylestrong{bins}}] \leavevmode{[}array\_like{]}
Bins to compute the ranked probability score over

\item[{\sphinxstylestrong{over\_dims}}] \leavevmode{[}str or sequence of str, optional{]}
Dimensions over which to average the ranked probability score

\item[{\sphinxstylestrong{ensemble\_dim}}] \leavevmode{[}str, optional{]}
Name of ensemble dimension

\end{description}

\item[{Returns}] \leavevmode\begin{description}
\item[{\sphinxstylestrong{rps}}] \leavevmode{[}xarray DataArray{]}
Array containing ranked probability score

\end{description}

\end{description}\end{quote}
\subsubsection*{Notes}

See \sphinxurl{http://www.cawcr.gov.au/projects/verification/}
\subsubsection*{Examples}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{da\PYGZus{}cmp} \PYG{o}{=} \PYG{n}{xr}\PYG{o}{.}\PYG{n}{DataArray}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{random}\PYG{o}{.}\PYG{n}{normal}\PYG{p}{(}\PYG{n}{size}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{,}\PYG{l+m+mi}{3}\PYG{p}{,}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} 
\PYG{g+gp}{... }                      \PYG{n}{coords}\PYG{o}{=}\PYG{p}{[}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{x}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{y}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} 
\PYG{g+gp}{... }                              \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{ensemble}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{]}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{da\PYGZus{}ref} \PYG{o}{=} \PYG{n}{xr}\PYG{o}{.}\PYG{n}{DataArray}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{random}\PYG{o}{.}\PYG{n}{normal}\PYG{p}{(}\PYG{n}{size}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{,}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} \PYG{n}{coords}\PYG{o}{=}\PYG{p}{[}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{x}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} 
\PYG{g+gp}{... }                                                            \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{y}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{]}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{bins} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{linspace}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{10}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{doppyo}\PYG{o}{.}\PYG{n}{skill}\PYG{o}{.}\PYG{n}{rps}\PYG{p}{(}\PYG{n}{da\PYGZus{}cmp}\PYG{p}{,} \PYG{n}{da\PYGZus{}ref}\PYG{p}{,} \PYG{n}{bins}\PYG{o}{=}\PYG{n}{bins}\PYG{p}{,} \PYG{n}{over\PYGZus{}dims}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{x}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{g+go}{\PYGZlt{}xarray.DataArray \PYGZsq{}rps\PYGZsq{} (y: 3)\PYGZgt{}}
\PYG{g+go}{array([0.36214 , 0.806584, 0.263374])}
\PYG{g+go}{Coordinates:}
\PYG{g+go}{  * y        (y) int64 0 1 2}
\end{sphinxVerbatim}

\end{fulllineitems}

\index{reliability() (in module skill)@\spxentry{reliability()}\spxextra{in module skill}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{skill_doc:skill.reliability}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{skill.}}\sphinxbfcode{\sphinxupquote{reliability}}}{\emph{cmp\_likelihood}, \emph{ref\_logical}, \emph{over\_dims}, \emph{probability\_bins=array({[}0.}, \emph{0.25}, \emph{0.5}, \emph{0.75}, \emph{1.  {]})}, \emph{nans\_as\_zeros=True}}{}
Computes the relative frequency of an event for a range of probability threshold bins                 given the comparison likelihood and reference logical event data

\begin{DUlineblock}{0em}
\item[] Author: Dougie Squire
\item[] Date: 10/05/2018
\end{DUlineblock}
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{description}
\item[{\sphinxstylestrong{cmp\_likelihood}}] \leavevmode{[}xarray DataArray{]}
Array containing likelihoods of the event from the comparison data (e.g. cmp\_likelihood =                     (da\_cmp \textgreater{} 1).mean(dim=’ensemble’))

\item[{\sphinxstylestrong{ref\_logical}}] \leavevmode{[}xarray DataArray{]}
Array containing logical (True/False) outcomes of the event from the reference data (e.g.                    ref\_logical = (da\_ref \textgreater{} 1))

\item[{\sphinxstylestrong{over\_dims}}] \leavevmode{[}str or sequence of str{]}
Dimensions over which to compute the reliability

\item[{\sphinxstylestrong{probability\_bins}}] \leavevmode{[}array\_like, optional{]}
Probability threshold bins. Defaults to 5 equally spaced bins between 0 and 1

\item[{\sphinxstylestrong{nans\_as\_zeros}}] \leavevmode{[}bool, optional{]}
Replace output nans (resulting fron bins with no data) with zeros

\end{description}

\item[{Returns}] \leavevmode\begin{description}
\item[{\sphinxstylestrong{reliability}}] \leavevmode{[}xarray DataSet{]}
\begin{DUlineblock}{0em}
\item[] Dataset containing the following variables:
\item[] relative\_freq; the relative frequency of occurence for each probability threshold bin
\item[] cmp\_number; the number of instances that the comparison data fall within each probability                     threshold bin
\item[] ref\_occur; the number of instances that the reference data is True when the comparison data                     falls within each probability threshold bin
\end{DUlineblock}

\end{description}

\end{description}\end{quote}
\subsubsection*{Notes}

See \sphinxurl{http://www.cawcr.gov.au/projects/verification/}

To do
\begin{itemize}
\item {} 
Currently using a for-loop to process each probability bin separately. Is it possible                 to remove this loop?

\end{itemize}
\subsubsection*{Examples}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{da\PYGZus{}cmp} \PYG{o}{=} \PYG{n}{xr}\PYG{o}{.}\PYG{n}{DataArray}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{random}\PYG{o}{.}\PYG{n}{normal}\PYG{p}{(}\PYG{n}{size}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{,}\PYG{l+m+mi}{3}\PYG{p}{,}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} 
\PYG{g+gp}{... }                      \PYG{n}{coords}\PYG{o}{=}\PYG{p}{[}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{x}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{y}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} 
\PYG{g+gp}{... }                              \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{ensemble}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{]}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{da\PYGZus{}ref} \PYG{o}{=} \PYG{n}{xr}\PYG{o}{.}\PYG{n}{DataArray}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{random}\PYG{o}{.}\PYG{n}{normal}\PYG{p}{(}\PYG{n}{size}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{,}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} 
\PYG{g+gp}{... }                      \PYG{n}{coords}\PYG{o}{=}\PYG{p}{[}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{x}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{y}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{]}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{cmp\PYGZus{}likelihood} \PYG{o}{=} \PYG{p}{(}\PYG{n}{da\PYGZus{}cmp} \PYG{o}{\PYGZgt{}} \PYG{l+m+mf}{0.1}\PYG{p}{)}\PYG{o}{.}\PYG{n}{mean}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{ensemble}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{ref\PYGZus{}logical} \PYG{o}{=} \PYG{n}{da\PYGZus{}ref} \PYG{o}{\PYGZgt{}} \PYG{l+m+mf}{0.1}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{doppyo}\PYG{o}{.}\PYG{n}{skill}\PYG{o}{.}\PYG{n}{reliability}\PYG{p}{(}\PYG{n}{cmp\PYGZus{}likelihood}\PYG{p}{,} \PYG{n}{ref\PYGZus{}logical}\PYG{p}{,} \PYG{n}{over\PYGZus{}dims}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{x}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{g+go}{\PYGZlt{}xarray.Dataset\PYGZgt{}}
\PYG{g+go}{Dimensions:          (probability\PYGZus{}bin: 5, y: 3)}
\PYG{g+go}{Coordinates:}
\PYG{g+go}{  * y                (y) int64 0 1 2}
\PYG{g+go}{  * probability\PYGZus{}bin  (probability\PYGZus{}bin) float64 0.0 0.25 0.5 0.75 1.0}
\PYG{g+go}{Data variables:}
\PYG{g+go}{    relative\PYGZus{}freq    (probability\PYGZus{}bin, y) float64 0.0 0.5 0.0 ... 1.0 0.0 0.0}
\PYG{g+go}{    cmp\PYGZus{}number       (probability\PYGZus{}bin, y) int64 0 2 1 2 0 1 0 0 0 0 1 1 1 0 0}
\PYG{g+go}{    ref\PYGZus{}occur        (probability\PYGZus{}bin, y) int64 0 1 0 1 0 0 0 0 0 0 0 1 1 0 0}
\end{sphinxVerbatim}

\end{fulllineitems}

\index{roc() (in module skill)@\spxentry{roc()}\spxextra{in module skill}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{skill_doc:skill.roc}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{skill.}}\sphinxbfcode{\sphinxupquote{roc}}}{\emph{cmp\_likelihood}, \emph{ref\_logical}, \emph{over\_dims}, \emph{probability\_bins=array({[}0.}, \emph{0.25}, \emph{0.5}, \emph{0.75}, \emph{1.  {]})}}{}
Computes the relative operating characteristic of an event for a range of probability                 threshold bins given the comparison likelihood and reference logical event data

\begin{DUlineblock}{0em}
\item[] Author: Dougie Squire
\item[] Date: 10/05/2018
\end{DUlineblock}
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{description}
\item[{\sphinxstylestrong{cmp\_likelihood}}] \leavevmode{[}xarray DataArray{]}
Array containing likelihoods of the event from the comparison data (e.g. cmp\_likelihood =                     (da\_cmp \textgreater{} 1).mean(dim=’ensemble’))

\item[{\sphinxstylestrong{ref\_logical}}] \leavevmode{[}xarray DataArray{]}
Array containing logical (True/False) outcomes of the event from the reference data (e.g.                    ref\_logical = (da\_ref \textgreater{} 1))

\item[{\sphinxstylestrong{over\_dims}}] \leavevmode{[}str or sequence of str{]}
Dimensions over which to compute the relative operating characteristic

\item[{\sphinxstylestrong{probability\_bins}}] \leavevmode{[}array\_like, optional{]}
Probability threshold bins. Defaults to 5 equally spaced bins between 0 and 1

\end{description}

\item[{Returns}] \leavevmode\begin{description}
\item[{\sphinxstylestrong{roc}}] \leavevmode{[}xarray DataSet{]}
\begin{DUlineblock}{0em}
\item[] Dataset containing the following variables:
\item[] hit\_rate; the hit rate in each probability bin
\item[] false\_alarm\_rate; the false alarm rate in each probability bin
\item[] area; the area under the roc curve (false alarm rate vs hit rate)
\end{DUlineblock}

\end{description}

\end{description}\end{quote}
\subsubsection*{Notes}

See \sphinxurl{http://www.cawcr.gov.au/projects/verification/}

To do
\begin{itemize}
\item {} 
Currently using a for-loop to process each probability bin separately. Is it possible                 to remove this loop?

\end{itemize}
\subsubsection*{Examples}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{da\PYGZus{}cmp} \PYG{o}{=} \PYG{n}{xr}\PYG{o}{.}\PYG{n}{DataArray}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{random}\PYG{o}{.}\PYG{n}{normal}\PYG{p}{(}\PYG{n}{size}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{,}\PYG{l+m+mi}{3}\PYG{p}{,}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} 
\PYG{g+gp}{... }                      \PYG{n}{coords}\PYG{o}{=}\PYG{p}{[}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{x}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{y}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} 
\PYG{g+gp}{... }                              \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{ensemble}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{]}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{da\PYGZus{}ref} \PYG{o}{=} \PYG{n}{xr}\PYG{o}{.}\PYG{n}{DataArray}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{random}\PYG{o}{.}\PYG{n}{normal}\PYG{p}{(}\PYG{n}{size}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{,}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} 
\PYG{g+gp}{... }                      \PYG{n}{coords}\PYG{o}{=}\PYG{p}{[}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{x}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{y}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{]}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{cmp\PYGZus{}likelihood} \PYG{o}{=} \PYG{p}{(}\PYG{n}{da\PYGZus{}cmp} \PYG{o}{\PYGZgt{}} \PYG{l+m+mf}{0.1}\PYG{p}{)}\PYG{o}{.}\PYG{n}{mean}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{ensemble}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{ref\PYGZus{}logical} \PYG{o}{=} \PYG{n}{da\PYGZus{}ref} \PYG{o}{\PYGZgt{}} \PYG{l+m+mf}{0.1}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{doppyo}\PYG{o}{.}\PYG{n}{skill}\PYG{o}{.}\PYG{n}{roc}\PYG{p}{(}\PYG{n}{cmp\PYGZus{}likelihood}\PYG{p}{,} \PYG{n}{ref\PYGZus{}logical}\PYG{p}{,} \PYG{n}{over\PYGZus{}dims}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{x}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{g+go}{\PYGZlt{}xarray.Dataset\PYGZgt{}}
\PYG{g+go}{Dimensions:           (probability\PYGZus{}bin: 5, y: 3)}
\PYG{g+go}{Coordinates:}
\PYG{g+go}{  * y                 (y) int64 0 1 2}
\PYG{g+go}{  * probability\PYGZus{}bin   (probability\PYGZus{}bin) float64 0.0 0.25 0.5 0.75 1.0}
\PYG{g+go}{Data variables:}
\PYG{g+go}{    hit\PYGZus{}rate          (probability\PYGZus{}bin, y) float64 1.0 1.0 1.0 ... nan 0.0 0.0}
\PYG{g+go}{    false\PYGZus{}alarm\PYGZus{}rate  (probability\PYGZus{}bin, y) float64 1.0 1.0 1.0 ... 0.0 0.0 0.0}
\PYG{g+go}{    area              (y) float64 0.0 0.0 0.0}
\end{sphinxVerbatim}

\end{fulllineitems}

\index{discrimination() (in module skill)@\spxentry{discrimination()}\spxextra{in module skill}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{skill_doc:skill.discrimination}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{skill.}}\sphinxbfcode{\sphinxupquote{discrimination}}}{\emph{cmp\_likelihood}, \emph{ref\_logical}, \emph{over\_dims}, \emph{probability\_bins=array({[}0.}, \emph{0.25}, \emph{0.5}, \emph{0.75}, \emph{1.  {]})}}{}
Returns the discrimination diagram of an event; the histogram of comparison likelihood when                 references indicate the event has occurred and has not occurred

\begin{DUlineblock}{0em}
\item[] Author: Dougie Squire
\item[] Date: 10/05/2018
\end{DUlineblock}
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{description}
\item[{\sphinxstylestrong{cmp\_likelihood}}] \leavevmode{[}xarray DataArray{]}
Array containing likelihoods of the event from the comparison data (e.g. cmp\_likelihood =                     (da\_cmp \textgreater{} 1).mean(dim=’ensemble’))

\item[{\sphinxstylestrong{ref\_logical}}] \leavevmode{[}xarray DataArray{]}
Array containing logical (True/False) outcomes of the event from the reference data (e.g.                    ref\_logical = (da\_ref \textgreater{} 1))

\item[{\sphinxstylestrong{over\_dims}}] \leavevmode{[}str or sequence of str{]}
Dimensions over which to compute the discrimantion histograms

\item[{\sphinxstylestrong{probability\_bins}}] \leavevmode{[}array\_like, optional{]}
Probability threshold bins. Defaults to 5 equally spaced bins between 0 and 1

\end{description}

\item[{Returns}] \leavevmode\begin{description}
\item[{\sphinxstylestrong{discrimination}}] \leavevmode{[}xarray DataSet{]}
\begin{DUlineblock}{0em}
\item[] Dataset containing the following variables:
\item[] hist\_event; histogram of comparison likelihoods when reference data indicates that the                     event has occurred
\item[] hist\_no\_event; histogram of comparison likelihoods when reference data indicates that the                     event has not occurred
\end{DUlineblock}

\end{description}

\end{description}\end{quote}
\subsubsection*{Notes}

See \sphinxurl{http://www.cawcr.gov.au/projects/verification/}

To do
\begin{itemize}
\item {} 
Currently using a for-loop to process each probability bin separately. Is it possible                 to remove this loop?

\end{itemize}
\subsubsection*{Examples}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{da\PYGZus{}cmp} \PYG{o}{=} \PYG{n}{xr}\PYG{o}{.}\PYG{n}{DataArray}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{random}\PYG{o}{.}\PYG{n}{normal}\PYG{p}{(}\PYG{n}{size}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{,}\PYG{l+m+mi}{3}\PYG{p}{,}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} 
\PYG{g+gp}{... }                      \PYG{n}{coords}\PYG{o}{=}\PYG{p}{[}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{x}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{y}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} 
\PYG{g+gp}{... }                              \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{ensemble}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{]}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{da\PYGZus{}ref} \PYG{o}{=} \PYG{n}{xr}\PYG{o}{.}\PYG{n}{DataArray}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{random}\PYG{o}{.}\PYG{n}{normal}\PYG{p}{(}\PYG{n}{size}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{,}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} 
\PYG{g+gp}{... }                      \PYG{n}{coords}\PYG{o}{=}\PYG{p}{[}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{x}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{y}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{]}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{cmp\PYGZus{}likelihood} \PYG{o}{=} \PYG{p}{(}\PYG{n}{da\PYGZus{}cmp} \PYG{o}{\PYGZgt{}} \PYG{l+m+mf}{0.1}\PYG{p}{)}\PYG{o}{.}\PYG{n}{mean}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{ensemble}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{ref\PYGZus{}logical} \PYG{o}{=} \PYG{n}{da\PYGZus{}ref} \PYG{o}{\PYGZgt{}} \PYG{l+m+mf}{0.1}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{doppyo}\PYG{o}{.}\PYG{n}{skill}\PYG{o}{.}\PYG{n}{discrimination}\PYG{p}{(}\PYG{n}{cmp\PYGZus{}likelihood}\PYG{p}{,} \PYG{n}{ref\PYGZus{}logical}\PYG{p}{,} \PYG{n}{over\PYGZus{}dims}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{x}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{g+go}{\PYGZlt{}xarray.Dataset\PYGZgt{}}
\PYG{g+go}{Dimensions:        (bins: 5, y: 3)}
\PYG{g+go}{Coordinates:}
\PYG{g+go}{  * bins           (bins) float64 0.0 0.25 0.5 0.75 1.0}
\PYG{g+go}{  * y              (y) int64 0 1 2}
\PYG{g+go}{Data variables:}
\PYG{g+go}{    hist\PYGZus{}event     (bins, y) float64 0.0 0.0 nan 0.5 1.0 ... 0.0 nan 0.0 0.0 nan}
\PYG{g+go}{    hist\PYGZus{}no\PYGZus{}event  (bins, y) float64 0.0 0.0 0.0 1.0 ... 0.3333 0.0 0.0 0.3333}
\end{sphinxVerbatim}

\end{fulllineitems}

\index{Brier\_score() (in module skill)@\spxentry{Brier\_score()}\spxextra{in module skill}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{skill_doc:skill.Brier_score}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{skill.}}\sphinxbfcode{\sphinxupquote{Brier\_score}}}{\emph{cmp\_likelihood}, \emph{ref\_logical}, \emph{over\_dims}, \emph{probability\_bins=None}}{}
Computes the Brier score(s) of an event given the comparison likelihood and reference logical                 event data. When comparison probability bins are also provided, this function also computes                 the reliability, resolution and uncertainty components of the Brier score, where Brier =                 reliability - resolution + uncertainty

\begin{DUlineblock}{0em}
\item[] Author: Dougie Squire
\item[] Date: 10/05/2018
\end{DUlineblock}
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{description}
\item[{\sphinxstylestrong{cmp\_likelihood}}] \leavevmode{[}xarray DataArray{]}
Array containing likelihoods of the event from the comparison data (e.g. cmp\_likelihood =                     (da\_cmp \textgreater{} 1).mean(dim=’ensemble’))

\item[{\sphinxstylestrong{ref\_logical}}] \leavevmode{[}xarray DataArray{]}
Array containing logical (True/False) outcomes of the event from the reference data (e.g.                    ref\_logical = (da\_ref \textgreater{} 1))

\item[{\sphinxstylestrong{over\_dims}}] \leavevmode{[}str or sequence of str{]}
Dimensions over which to compute the Brier score

\item[{\sphinxstylestrong{probability\_bins}}] \leavevmode{[}array\_like, optional{]}
Probability threshold bins. If specified, this function also computes the reliability,                     resolution and uncertainty components of the Brier score. Defaults to None

\end{description}

\item[{Returns}] \leavevmode\begin{description}
\item[{\sphinxstylestrong{Brier}}] \leavevmode{[}xarray DataArray or xarray DataSet{]}
If probability\_bins = None, returns a DataArray containing Brier scores. Otherwise returns                     a DataSet containing the reliability, resolution and uncertainty components of the Brier                     score, where Brier = reliability - resolution + uncertainty

\end{description}

\end{description}\end{quote}
\subsubsection*{Notes}

See \sphinxurl{http://www.cawcr.gov.au/projects/verification/}

To do
\begin{itemize}
\item {} 
Currently using a for-loop to process each probability bin separately. Is it possible                 to remove this loop?

\end{itemize}
\subsubsection*{Examples}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{da\PYGZus{}cmp} \PYG{o}{=} \PYG{n}{xr}\PYG{o}{.}\PYG{n}{DataArray}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{random}\PYG{o}{.}\PYG{n}{normal}\PYG{p}{(}\PYG{n}{size}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{,}\PYG{l+m+mi}{3}\PYG{p}{,}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} 
\PYG{g+gp}{... }                      \PYG{n}{coords}\PYG{o}{=}\PYG{p}{[}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{x}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{y}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} 
\PYG{g+gp}{... }                              \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{ensemble}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{]}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{da\PYGZus{}ref} \PYG{o}{=} \PYG{n}{xr}\PYG{o}{.}\PYG{n}{DataArray}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{random}\PYG{o}{.}\PYG{n}{normal}\PYG{p}{(}\PYG{n}{size}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{,}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} 
\PYG{g+gp}{... }                      \PYG{n}{coords}\PYG{o}{=}\PYG{p}{[}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{x}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{y}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{]}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{cmp\PYGZus{}likelihood} \PYG{o}{=} \PYG{p}{(}\PYG{n}{da\PYGZus{}cmp} \PYG{o}{\PYGZgt{}} \PYG{l+m+mf}{0.1}\PYG{p}{)}\PYG{o}{.}\PYG{n}{mean}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{ensemble}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{ref\PYGZus{}logical} \PYG{o}{=} \PYG{n}{da\PYGZus{}ref} \PYG{o}{\PYGZgt{}} \PYG{l+m+mf}{0.1}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{doppyo}\PYG{o}{.}\PYG{n}{skill}\PYG{o}{.}\PYG{n}{Brier\PYGZus{}score}\PYG{p}{(}\PYG{n}{cmp\PYGZus{}likelihood}\PYG{p}{,} \PYG{n}{ref\PYGZus{}logical}\PYG{p}{,} \PYG{n}{over\PYGZus{}dims}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{x}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{g+go}{\PYGZlt{}xarray.DataArray (y: 3)\PYGZgt{}}
\PYG{g+go}{array([0.148148, 0.444444, 0.222222])}
\PYG{g+go}{Coordinates:}
\PYG{g+go}{  * y        (y) int64 0 1 2}
\end{sphinxVerbatim}

\end{fulllineitems}

\index{contingency() (in module skill)@\spxentry{contingency()}\spxextra{in module skill}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{skill_doc:skill.contingency}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{skill.}}\sphinxbfcode{\sphinxupquote{contingency}}}{\emph{da\_cmp}, \emph{da\_ref}, \emph{category\_edges\_cmp}, \emph{category\_edges\_ref}, \emph{over\_dims}}{}
Return the contingency table between da\_cmp and da\_ref for given categories

\begin{DUlineblock}{0em}
\item[] Author: Dougie Squire
\item[] Date: 12/05/2018
\end{DUlineblock}
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{description}
\item[{\sphinxstylestrong{da\_cmp}}] \leavevmode{[}xarray DataArray{]}
Array containing data to be compared to reference dataset (usually forecasts)

\item[{\sphinxstylestrong{da\_ref}}] \leavevmode{[}xarray DataArray{]}
Array containing reference data (usually observations)

\item[{\sphinxstylestrong{category\_edges\_cmp}}] \leavevmode{[}array\_like{]}
Bin edges for categorising da\_cmp

\item[{\sphinxstylestrong{category\_edges\_ref}}] \leavevmode{[}array\_like{]}
Bin edges for categorising da\_ref

\item[{\sphinxstylestrong{over\_dims}}] \leavevmode{[}str or sequence of str, optional{]}
Dimensions over which to compute the contingency table

\end{description}

\item[{Returns}] \leavevmode\begin{description}
\item[{\sphinxstylestrong{contingency}}] \leavevmode{[}xarray DataArray{]}
Contingency table of input data

\end{description}

\end{description}\end{quote}
\subsubsection*{Notes}

See \sphinxurl{http://www.cawcr.gov.au/projects/verification/}
\subsubsection*{Examples}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{da\PYGZus{}cmp} \PYG{o}{=} \PYG{n}{xr}\PYG{o}{.}\PYG{n}{DataArray}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{random}\PYG{o}{.}\PYG{n}{normal}\PYG{p}{(}\PYG{n}{size}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{,}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} 
\PYG{g+gp}{... }                      \PYG{n}{coords}\PYG{o}{=}\PYG{p}{[}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{x}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{y}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{]}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{da\PYGZus{}ref} \PYG{o}{=} \PYG{n}{xr}\PYG{o}{.}\PYG{n}{DataArray}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{random}\PYG{o}{.}\PYG{n}{normal}\PYG{p}{(}\PYG{n}{size}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{,}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} 
\PYG{g+gp}{... }                      \PYG{n}{coords}\PYG{o}{=}\PYG{p}{[}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{x}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{y}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{]}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{category\PYGZus{}edges\PYGZus{}cmp} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{linspace}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{5}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{category\PYGZus{}edges\PYGZus{}ref} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{linspace}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{5}\PYG{p}{)}
\PYG{g+go}{doppyo.skill.contingency(da\PYGZus{}cmp, da\PYGZus{}ref, category\PYGZus{}edges\PYGZus{}cmp, }
\PYG{g+gp}{... }                     \PYG{n}{category\PYGZus{}edges\PYGZus{}ref}\PYG{p}{,} \PYG{n}{over\PYGZus{}dims}\PYG{o}{=}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{x}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{y}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}
\PYG{g+go}{\PYGZlt{}xarray.DataArray \PYGZsq{}contingency\PYGZsq{} (comparison\PYGZus{}category: 4, reference\PYGZus{}category: 4)\PYGZgt{}}
\PYG{g+go}{array([[0, 1, 0, 1],}
\PYG{g+go}{       [1, 0, 1, 0],}
\PYG{g+go}{       [0, 2, 1, 0],}
\PYG{g+go}{       [0, 0, 0, 0]])}
\PYG{g+go}{Coordinates:}
\PYG{g+go}{  * comparison\PYGZus{}category  (comparison\PYGZus{}category) int64 1 2 3 4}
\PYG{g+go}{  * reference\PYGZus{}category   (reference\PYGZus{}category) int64 1 2 3 4}
\end{sphinxVerbatim}

\end{fulllineitems}

\index{accuracy\_score() (in module skill)@\spxentry{accuracy\_score()}\spxextra{in module skill}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{skill_doc:skill.accuracy_score}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{skill.}}\sphinxbfcode{\sphinxupquote{accuracy\_score}}}{\emph{contingency}}{}
Returns the accuracy score given a contingency table

\begin{DUlineblock}{0em}
\item[] Author: Dougie Squire
\item[] Date: 12/05/2018
\end{DUlineblock}
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{description}
\item[{\sphinxstylestrong{contingency}}] \leavevmode{[}xarray DataArray{]}
A contingency table of the form output from doppyo.skill.contingency

\end{description}

\item[{Returns}] \leavevmode\begin{description}
\item[{\sphinxstylestrong{accuracy\_score}}] \leavevmode{[}xarray DataArray{]}
An array containing the accuracy scores

\end{description}

\end{description}\end{quote}
\subsubsection*{Notes}

See \sphinxurl{http://www.cawcr.gov.au/projects/verification/}
\subsubsection*{Examples}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{da\PYGZus{}cmp} \PYG{o}{=} \PYG{n}{xr}\PYG{o}{.}\PYG{n}{DataArray}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{random}\PYG{o}{.}\PYG{n}{normal}\PYG{p}{(}\PYG{n}{size}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{,}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} 
\PYG{g+gp}{... }                      \PYG{n}{coords}\PYG{o}{=}\PYG{p}{[}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{x}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{y}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{]}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{da\PYGZus{}ref} \PYG{o}{=} \PYG{n}{xr}\PYG{o}{.}\PYG{n}{DataArray}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{random}\PYG{o}{.}\PYG{n}{normal}\PYG{p}{(}\PYG{n}{size}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{,}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} 
\PYG{g+gp}{... }                      \PYG{n}{coords}\PYG{o}{=}\PYG{p}{[}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{x}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{y}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{]}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{category\PYGZus{}edges\PYGZus{}cmp} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{linspace}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{5}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{category\PYGZus{}edges\PYGZus{}ref} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{linspace}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{5}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{contingency} \PYG{o}{=} \PYG{n}{doppyo}\PYG{o}{.}\PYG{n}{skill}\PYG{o}{.}\PYG{n}{contingency}\PYG{p}{(}\PYG{n}{da\PYGZus{}cmp}\PYG{p}{,} \PYG{n}{da\PYGZus{}ref}\PYG{p}{,} \PYG{n}{category\PYGZus{}edges\PYGZus{}cmp}\PYG{p}{,} 
\PYG{g+gp}{... }                                       \PYG{n}{category\PYGZus{}edges\PYGZus{}ref}\PYG{p}{,} \PYG{n}{over\PYGZus{}dims}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{y}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{doppyo}\PYG{o}{.}\PYG{n}{skill}\PYG{o}{.}\PYG{n}{accuracy\PYGZus{}score}\PYG{p}{(}\PYG{n}{contingency}\PYG{p}{)}
\PYG{g+go}{\PYGZlt{}xarray.DataArray \PYGZsq{}accuracy\PYGZus{}score\PYGZsq{} (x: 3)\PYGZgt{}}
\PYG{g+go}{array([0.      , 0.333333, 0.333333])}
\PYG{g+go}{Coordinates:}
\PYG{g+go}{  * x        (x) int64 0 1 2}
\end{sphinxVerbatim}

\end{fulllineitems}

\index{Heidke\_score() (in module skill)@\spxentry{Heidke\_score()}\spxextra{in module skill}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{skill_doc:skill.Heidke_score}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{skill.}}\sphinxbfcode{\sphinxupquote{Heidke\_score}}}{\emph{contingency}}{}
Returns the Heidke skill score given a contingency table

\begin{DUlineblock}{0em}
\item[] Author: Dougie Squire
\item[] Date: 12/05/2018
\end{DUlineblock}
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{description}
\item[{\sphinxstylestrong{contingency}}] \leavevmode{[}xarray DataArray{]}
A contingency table of the form output from doppyo.skill.contingency

\end{description}

\item[{Returns}] \leavevmode\begin{description}
\item[{\sphinxstylestrong{Heidke\_score}}] \leavevmode{[}xarray DataArray{]}
An array containing the Heidke scores

\end{description}

\end{description}\end{quote}
\subsubsection*{Notes}

See \sphinxurl{http://www.cawcr.gov.au/projects/verification/}
\subsubsection*{Examples}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{da\PYGZus{}cmp} \PYG{o}{=} \PYG{n}{xr}\PYG{o}{.}\PYG{n}{DataArray}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{random}\PYG{o}{.}\PYG{n}{normal}\PYG{p}{(}\PYG{n}{size}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{,}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} 
\PYG{g+gp}{... }                      \PYG{n}{coords}\PYG{o}{=}\PYG{p}{[}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{x}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{y}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{]}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{da\PYGZus{}ref} \PYG{o}{=} \PYG{n}{xr}\PYG{o}{.}\PYG{n}{DataArray}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{random}\PYG{o}{.}\PYG{n}{normal}\PYG{p}{(}\PYG{n}{size}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{,}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} 
\PYG{g+gp}{... }                      \PYG{n}{coords}\PYG{o}{=}\PYG{p}{[}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{x}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{y}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{]}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{category\PYGZus{}edges\PYGZus{}cmp} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{linspace}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{5}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{category\PYGZus{}edges\PYGZus{}ref} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{linspace}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{5}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{contingency} \PYG{o}{=} \PYG{n}{doppyo}\PYG{o}{.}\PYG{n}{skill}\PYG{o}{.}\PYG{n}{contingency}\PYG{p}{(}\PYG{n}{da\PYGZus{}cmp}\PYG{p}{,} \PYG{n}{da\PYGZus{}ref}\PYG{p}{,} \PYG{n}{category\PYGZus{}edges\PYGZus{}cmp}\PYG{p}{,} 
\PYG{g+gp}{... }                                       \PYG{n}{category\PYGZus{}edges\PYGZus{}ref}\PYG{p}{,} \PYG{n}{over\PYGZus{}dims}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{y}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{doppyo}\PYG{o}{.}\PYG{n}{skill}\PYG{o}{.}\PYG{n}{Heidke\PYGZus{}score}\PYG{p}{(}\PYG{n}{contingency}\PYG{p}{)}
\PYG{g+go}{\PYGZlt{}xarray.DataArray \PYGZsq{}Heidke\PYGZus{}score\PYGZsq{} (x: 3)\PYGZgt{}}
\PYG{g+go}{array([\PYGZhy{}0.285714,  0.      ,  0.142857])}
\PYG{g+go}{Coordinates:}
\PYG{g+go}{  * x        (x) int64 0 1 22}
\end{sphinxVerbatim}

\end{fulllineitems}

\index{Peirce\_score() (in module skill)@\spxentry{Peirce\_score()}\spxextra{in module skill}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{skill_doc:skill.Peirce_score}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{skill.}}\sphinxbfcode{\sphinxupquote{Peirce\_score}}}{\emph{contingency}}{}
Returns the Peirce score (also called Hanssen and Kuipers discriminant) given a contingency                 table

\begin{DUlineblock}{0em}
\item[] Author: Dougie Squire
\item[] Date: 12/05/2018
\end{DUlineblock}
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{description}
\item[{\sphinxstylestrong{contingency}}] \leavevmode{[}xarray DataArray{]}
A contingency table of the form output from doppyo.skill.contingency

\end{description}

\item[{Returns}] \leavevmode\begin{description}
\item[{\sphinxstylestrong{Peirce\_score}}] \leavevmode{[}xarray DataArray{]}
An array containing the Peirce scores

\end{description}

\end{description}\end{quote}
\subsubsection*{Notes}

See \sphinxurl{http://www.cawcr.gov.au/projects/verification/}
\subsubsection*{Examples}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{da\PYGZus{}cmp} \PYG{o}{=} \PYG{n}{xr}\PYG{o}{.}\PYG{n}{DataArray}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{random}\PYG{o}{.}\PYG{n}{normal}\PYG{p}{(}\PYG{n}{size}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{,}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} 
\PYG{g+gp}{... }                      \PYG{n}{coords}\PYG{o}{=}\PYG{p}{[}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{x}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{y}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{]}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{da\PYGZus{}ref} \PYG{o}{=} \PYG{n}{xr}\PYG{o}{.}\PYG{n}{DataArray}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{random}\PYG{o}{.}\PYG{n}{normal}\PYG{p}{(}\PYG{n}{size}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{,}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} 
\PYG{g+gp}{... }                      \PYG{n}{coords}\PYG{o}{=}\PYG{p}{[}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{x}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{y}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{]}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{category\PYGZus{}edges\PYGZus{}cmp} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{linspace}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{5}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{category\PYGZus{}edges\PYGZus{}ref} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{linspace}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{5}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{contingency} \PYG{o}{=} \PYG{n}{doppyo}\PYG{o}{.}\PYG{n}{skill}\PYG{o}{.}\PYG{n}{contingency}\PYG{p}{(}\PYG{n}{da\PYGZus{}cmp}\PYG{p}{,} \PYG{n}{da\PYGZus{}ref}\PYG{p}{,} \PYG{n}{category\PYGZus{}edges\PYGZus{}cmp}\PYG{p}{,} 
\PYG{g+gp}{... }                                       \PYG{n}{category\PYGZus{}edges\PYGZus{}ref}\PYG{p}{,} \PYG{n}{over\PYGZus{}dims}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{y}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{doppyo}\PYG{o}{.}\PYG{n}{skill}\PYG{o}{.}\PYG{n}{Peirce\PYGZus{}score}\PYG{p}{(}\PYG{n}{contingency}\PYG{p}{)}
\PYG{g+go}{\PYGZlt{}xarray.DataArray \PYGZsq{}Peirce\PYGZus{}score\PYGZsq{} (x: 3)\PYGZgt{}}
\PYG{g+go}{array([\PYGZhy{}0.25,  0.  , \PYGZhy{}0.5 ])}
\PYG{g+go}{Coordinates:}
\PYG{g+go}{  * x        (x) int64 0 1 2}
\end{sphinxVerbatim}

\end{fulllineitems}

\index{Gerrity\_score() (in module skill)@\spxentry{Gerrity\_score()}\spxextra{in module skill}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{skill_doc:skill.Gerrity_score}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{skill.}}\sphinxbfcode{\sphinxupquote{Gerrity\_score}}}{\emph{contingency}}{}
Returns Gerrity equitable score given a contingency table

\begin{DUlineblock}{0em}
\item[] Author: Dougie Squire
\item[] Date: 12/05/2018
\end{DUlineblock}
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{description}
\item[{\sphinxstylestrong{contingency}}] \leavevmode{[}xarray DataArray{]}
A contingency table of the form output from doppyo.skill.contingency

\end{description}

\item[{Returns}] \leavevmode\begin{description}
\item[{\sphinxstylestrong{Gerrity\_score}}] \leavevmode{[}xarray DataArray{]}
An array containing the Gerrity scores

\end{description}

\end{description}\end{quote}
\subsubsection*{Notes}

See \sphinxurl{http://www.cawcr.gov.au/projects/verification/}

To do
\begin{itemize}
\item {} 
Currently computes the Gerrity scoring matrix using nested for-loops. Is it possible                 to remove these?

\end{itemize}
\subsubsection*{Examples}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{da\PYGZus{}cmp} \PYG{o}{=} \PYG{n}{xr}\PYG{o}{.}\PYG{n}{DataArray}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{random}\PYG{o}{.}\PYG{n}{normal}\PYG{p}{(}\PYG{n}{size}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{,}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} 
\PYG{g+gp}{... }                      \PYG{n}{coords}\PYG{o}{=}\PYG{p}{[}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{x}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{y}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{]}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{da\PYGZus{}ref} \PYG{o}{=} \PYG{n}{xr}\PYG{o}{.}\PYG{n}{DataArray}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{random}\PYG{o}{.}\PYG{n}{normal}\PYG{p}{(}\PYG{n}{size}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{,}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} 
\PYG{g+gp}{... }                      \PYG{n}{coords}\PYG{o}{=}\PYG{p}{[}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{x}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{y}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{]}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{category\PYGZus{}edges\PYGZus{}cmp} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{linspace}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{5}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{category\PYGZus{}edges\PYGZus{}ref} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{linspace}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{5}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{contingency} \PYG{o}{=} \PYG{n}{doppyo}\PYG{o}{.}\PYG{n}{skill}\PYG{o}{.}\PYG{n}{contingency}\PYG{p}{(}\PYG{n}{da\PYGZus{}cmp}\PYG{p}{,} \PYG{n}{da\PYGZus{}ref}\PYG{p}{,} \PYG{n}{category\PYGZus{}edges\PYGZus{}cmp}\PYG{p}{,} 
\PYG{g+gp}{... }                                       \PYG{n}{category\PYGZus{}edges\PYGZus{}ref}\PYG{p}{,} \PYG{n}{over\PYGZus{}dims}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{y}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{doppyo}\PYG{o}{.}\PYG{n}{skill}\PYG{o}{.}\PYG{n}{Gerrity\PYGZus{}score}\PYG{p}{(}\PYG{n}{contingency}\PYG{p}{)}
\PYG{g+go}{\PYGZlt{}xarray.DataArray \PYGZsq{}Gerrity\PYGZus{}score\PYGZsq{} (x: 3)\PYGZgt{}}
\PYG{g+go}{array([\PYGZhy{}2.777778e\PYGZhy{}01,  0.000000e+00, \PYGZhy{}5.551115e\PYGZhy{}17])}
\PYG{g+go}{Coordinates:}
\PYG{g+go}{  * x        (x) int64 0 1 2}
\end{sphinxVerbatim}

\end{fulllineitems}

\index{bias\_score() (in module skill)@\spxentry{bias\_score()}\spxextra{in module skill}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{skill_doc:skill.bias_score}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{skill.}}\sphinxbfcode{\sphinxupquote{bias\_score}}}{\emph{contingency}, \emph{yes\_category=2}}{}
Returns the bias score given dichotomous contingency data

\begin{DUlineblock}{0em}
\item[] Author: Dougie Squire
\item[] Date: 12/05/2018
\end{DUlineblock}
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{description}
\item[{\sphinxstylestrong{contingency}}] \leavevmode{[}xarray DataArray{]}
A 2 category contingency table of the form output from doppyo.skill.contingency

\item[{\sphinxstylestrong{yes\_category}}] \leavevmode{[}value, optional{]}
The coordinate value of the category corresponding to ‘yes’

\end{description}

\item[{Returns}] \leavevmode\begin{description}
\item[{\sphinxstylestrong{bias\_score}}] \leavevmode{[}xarray DataArray{]}
An array containing the bias scores

\end{description}

\end{description}\end{quote}
\subsubsection*{Notes}

See \sphinxurl{http://www.cawcr.gov.au/projects/verification/}
\subsubsection*{Examples}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{da\PYGZus{}cmp} \PYG{o}{=} \PYG{n}{xr}\PYG{o}{.}\PYG{n}{DataArray}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{random}\PYG{o}{.}\PYG{n}{normal}\PYG{p}{(}\PYG{n}{size}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{,}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} 
\PYG{g+gp}{... }                      \PYG{n}{coords}\PYG{o}{=}\PYG{p}{[}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{x}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{y}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{]}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{da\PYGZus{}ref} \PYG{o}{=} \PYG{n}{xr}\PYG{o}{.}\PYG{n}{DataArray}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{random}\PYG{o}{.}\PYG{n}{normal}\PYG{p}{(}\PYG{n}{size}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{,}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} 
\PYG{g+gp}{... }                      \PYG{n}{coords}\PYG{o}{=}\PYG{p}{[}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{x}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{y}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{]}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{category\PYGZus{}edges\PYGZus{}cmp} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{linspace}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{3}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{category\PYGZus{}edges\PYGZus{}ref} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{linspace}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{3}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{contingency} \PYG{o}{=} \PYG{n}{doppyo}\PYG{o}{.}\PYG{n}{skill}\PYG{o}{.}\PYG{n}{contingency}\PYG{p}{(}\PYG{n}{da\PYGZus{}cmp}\PYG{p}{,} \PYG{n}{da\PYGZus{}ref}\PYG{p}{,} \PYG{n}{category\PYGZus{}edges\PYGZus{}cmp}\PYG{p}{,} 
\PYG{g+gp}{... }                                       \PYG{n}{category\PYGZus{}edges\PYGZus{}ref}\PYG{p}{,} \PYG{n}{over\PYGZus{}dims}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{y}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{doppyo}\PYG{o}{.}\PYG{n}{skill}\PYG{o}{.}\PYG{n}{bias\PYGZus{}score}\PYG{p}{(}\PYG{n}{contingency}\PYG{p}{)}
\PYG{g+go}{\PYGZlt{}xarray.DataArray \PYGZsq{}bias\PYGZus{}score\PYGZsq{} (x: 3)\PYGZgt{}}
\PYG{g+go}{array([0.5     , 0.333333, 1.      ])}
\PYG{g+go}{Coordinates:}
\PYG{g+go}{  * x        (x) int64 0 1 2}
\end{sphinxVerbatim}

\end{fulllineitems}

\index{hit\_rate() (in module skill)@\spxentry{hit\_rate()}\spxextra{in module skill}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{skill_doc:skill.hit_rate}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{skill.}}\sphinxbfcode{\sphinxupquote{hit\_rate}}}{\emph{contingency}, \emph{yes\_category=2}}{}
Returns the hit rate (probability of detection) given dichotomous contingency data

\begin{DUlineblock}{0em}
\item[] Author: Dougie Squire
\item[] Date: 12/05/2018
\end{DUlineblock}
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{description}
\item[{\sphinxstylestrong{contingency}}] \leavevmode{[}xarray DataArray{]}
A 2 category contingency table of the form output from doppyo.skill.contingency

\item[{\sphinxstylestrong{yes\_category}}] \leavevmode{[}value, optional{]}
The coordinate value of the category corresponding to ‘yes’

\end{description}

\item[{Returns}] \leavevmode\begin{description}
\item[{\sphinxstylestrong{hit\_rate}}] \leavevmode{[}xarray DataArray{]}
An array containing the hit rates

\end{description}

\end{description}\end{quote}
\subsubsection*{Notes}

See \sphinxurl{http://www.cawcr.gov.au/projects/verification/}
\subsubsection*{Examples}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{da\PYGZus{}cmp} \PYG{o}{=} \PYG{n}{xr}\PYG{o}{.}\PYG{n}{DataArray}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{random}\PYG{o}{.}\PYG{n}{normal}\PYG{p}{(}\PYG{n}{size}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{,}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} 
\PYG{g+gp}{... }                      \PYG{n}{coords}\PYG{o}{=}\PYG{p}{[}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{x}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{y}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{]}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{da\PYGZus{}ref} \PYG{o}{=} \PYG{n}{xr}\PYG{o}{.}\PYG{n}{DataArray}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{random}\PYG{o}{.}\PYG{n}{normal}\PYG{p}{(}\PYG{n}{size}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{,}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} 
\PYG{g+gp}{... }                      \PYG{n}{coords}\PYG{o}{=}\PYG{p}{[}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{x}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{y}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{]}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{category\PYGZus{}edges\PYGZus{}cmp} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{linspace}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{3}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{category\PYGZus{}edges\PYGZus{}ref} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{linspace}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{3}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{contingency} \PYG{o}{=} \PYG{n}{doppyo}\PYG{o}{.}\PYG{n}{skill}\PYG{o}{.}\PYG{n}{contingency}\PYG{p}{(}\PYG{n}{da\PYGZus{}cmp}\PYG{p}{,} \PYG{n}{da\PYGZus{}ref}\PYG{p}{,} \PYG{n}{category\PYGZus{}edges\PYGZus{}cmp}\PYG{p}{,} 
\PYG{g+gp}{... }                                       \PYG{n}{category\PYGZus{}edges\PYGZus{}ref}\PYG{p}{,} \PYG{n}{over\PYGZus{}dims}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{y}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{doppyo}\PYG{o}{.}\PYG{n}{skill}\PYG{o}{.}\PYG{n}{hit\PYGZus{}rate}\PYG{p}{(}\PYG{n}{contingency}\PYG{p}{)}
\PYG{g+go}{\PYGZlt{}xarray.DataArray \PYGZsq{}hit\PYGZus{}rate\PYGZsq{} (x: 3)\PYGZgt{}}
\PYG{g+go}{array([ 0., nan,  1.])}
\PYG{g+go}{Coordinates:}
\PYG{g+go}{  * x        (x) int64 0 1 2}
\end{sphinxVerbatim}

\end{fulllineitems}

\index{false\_alarm\_ratio() (in module skill)@\spxentry{false\_alarm\_ratio()}\spxextra{in module skill}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{skill_doc:skill.false_alarm_ratio}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{skill.}}\sphinxbfcode{\sphinxupquote{false\_alarm\_ratio}}}{\emph{contingency}, \emph{yes\_category=2}}{}
Returns the false alarm ratio given dichotomous contingency data

\begin{DUlineblock}{0em}
\item[] Author: Dougie Squire
\item[] Date: 12/05/2018
\end{DUlineblock}
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{description}
\item[{\sphinxstylestrong{contingency}}] \leavevmode{[}xarray DataArray{]}
A 2 category contingency table of the form output from doppyo.skill.contingency

\item[{\sphinxstylestrong{yes\_category}}] \leavevmode{[}value, optional{]}
The coordinate value of the category corresponding to ‘yes’

\end{description}

\item[{Returns}] \leavevmode\begin{description}
\item[{\sphinxstylestrong{false\_alarm\_ratio}}] \leavevmode{[}xarray DataArray{]}
An array containing the false alarm ratios

\end{description}

\end{description}\end{quote}
\subsubsection*{Notes}

See \sphinxurl{http://www.cawcr.gov.au/projects/verification/}
\subsubsection*{Examples}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{da\PYGZus{}cmp} \PYG{o}{=} \PYG{n}{xr}\PYG{o}{.}\PYG{n}{DataArray}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{random}\PYG{o}{.}\PYG{n}{normal}\PYG{p}{(}\PYG{n}{size}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{,}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} 
\PYG{g+gp}{... }                      \PYG{n}{coords}\PYG{o}{=}\PYG{p}{[}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{x}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{y}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{]}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{da\PYGZus{}ref} \PYG{o}{=} \PYG{n}{xr}\PYG{o}{.}\PYG{n}{DataArray}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{random}\PYG{o}{.}\PYG{n}{normal}\PYG{p}{(}\PYG{n}{size}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{,}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} 
\PYG{g+gp}{... }                      \PYG{n}{coords}\PYG{o}{=}\PYG{p}{[}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{x}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{y}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{]}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{category\PYGZus{}edges\PYGZus{}cmp} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{linspace}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{3}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{category\PYGZus{}edges\PYGZus{}ref} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{linspace}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{3}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{contingency} \PYG{o}{=} \PYG{n}{doppyo}\PYG{o}{.}\PYG{n}{skill}\PYG{o}{.}\PYG{n}{contingency}\PYG{p}{(}\PYG{n}{da\PYGZus{}cmp}\PYG{p}{,} \PYG{n}{da\PYGZus{}ref}\PYG{p}{,} \PYG{n}{category\PYGZus{}edges\PYGZus{}cmp}\PYG{p}{,} 
\PYG{g+gp}{... }                                       \PYG{n}{category\PYGZus{}edges\PYGZus{}ref}\PYG{p}{,} \PYG{n}{over\PYGZus{}dims}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{y}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{doppyo}\PYG{o}{.}\PYG{n}{skill}\PYG{o}{.}\PYG{n}{false\PYGZus{}alarm\PYGZus{}ratio}\PYG{p}{(}\PYG{n}{contingency}\PYG{p}{)}
\PYG{g+go}{\PYGZlt{}xarray.DataArray \PYGZsq{}false\PYGZus{}alarm\PYGZus{}ratio\PYGZsq{} (x: 3)\PYGZgt{}}
\PYG{g+go}{array([nan, nan,  0.])}
\PYG{g+go}{Coordinates:}
\PYG{g+go}{  * x        (x) int64 0 1 2}
\end{sphinxVerbatim}

\end{fulllineitems}

\index{false\_alarm\_rate() (in module skill)@\spxentry{false\_alarm\_rate()}\spxextra{in module skill}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{skill_doc:skill.false_alarm_rate}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{skill.}}\sphinxbfcode{\sphinxupquote{false\_alarm\_rate}}}{\emph{contingency}, \emph{yes\_category=2}}{}
Returns the false alarm rate given dichotomous contingency data

\begin{DUlineblock}{0em}
\item[] Author: Dougie Squire
\item[] Date: 12/05/2018
\end{DUlineblock}
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{description}
\item[{\sphinxstylestrong{contingency}}] \leavevmode{[}xarray DataArray{]}
A 2 category contingency table of the form output from doppyo.skill.contingency

\item[{\sphinxstylestrong{yes\_category}}] \leavevmode{[}value, optional{]}
The coordinate value of the category corresponding to ‘yes’

\end{description}

\item[{Returns}] \leavevmode\begin{description}
\item[{\sphinxstylestrong{false\_alarm\_rate}}] \leavevmode{[}xarray DataArray{]}
An array containing the false alarm rates

\end{description}

\end{description}\end{quote}
\subsubsection*{Notes}

See \sphinxurl{http://www.cawcr.gov.au/projects/verification/}
\subsubsection*{Examples}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{da\PYGZus{}cmp} \PYG{o}{=} \PYG{n}{xr}\PYG{o}{.}\PYG{n}{DataArray}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{random}\PYG{o}{.}\PYG{n}{normal}\PYG{p}{(}\PYG{n}{size}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{,}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} 
\PYG{g+gp}{... }                      \PYG{n}{coords}\PYG{o}{=}\PYG{p}{[}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{x}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{y}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{]}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{da\PYGZus{}ref} \PYG{o}{=} \PYG{n}{xr}\PYG{o}{.}\PYG{n}{DataArray}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{random}\PYG{o}{.}\PYG{n}{normal}\PYG{p}{(}\PYG{n}{size}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{,}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} 
\PYG{g+gp}{... }                      \PYG{n}{coords}\PYG{o}{=}\PYG{p}{[}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{x}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{y}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{]}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{category\PYGZus{}edges\PYGZus{}cmp} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{linspace}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{3}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{category\PYGZus{}edges\PYGZus{}ref} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{linspace}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{3}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{contingency} \PYG{o}{=} \PYG{n}{doppyo}\PYG{o}{.}\PYG{n}{skill}\PYG{o}{.}\PYG{n}{contingency}\PYG{p}{(}\PYG{n}{da\PYGZus{}cmp}\PYG{p}{,} \PYG{n}{da\PYGZus{}ref}\PYG{p}{,} \PYG{n}{category\PYGZus{}edges\PYGZus{}cmp}\PYG{p}{,} 
\PYG{g+gp}{... }                                       \PYG{n}{category\PYGZus{}edges\PYGZus{}ref}\PYG{p}{,} \PYG{n}{over\PYGZus{}dims}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{y}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{doppyo}\PYG{o}{.}\PYG{n}{skill}\PYG{o}{.}\PYG{n}{false\PYGZus{}alarm\PYGZus{}rate}\PYG{p}{(}\PYG{n}{contingency}\PYG{p}{)}
\PYG{g+go}{\PYGZlt{}xarray.DataArray \PYGZsq{}false\PYGZus{}alarm\PYGZus{}rate\PYGZsq{} (x: 3)\PYGZgt{}}
\PYG{g+go}{array([ 0.,  0., nan])}
\PYG{g+go}{Coordinates:}
\PYG{g+go}{  * x        (x) int64 0 1 2}
\end{sphinxVerbatim}

\end{fulllineitems}

\index{success\_ratio() (in module skill)@\spxentry{success\_ratio()}\spxextra{in module skill}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{skill_doc:skill.success_ratio}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{skill.}}\sphinxbfcode{\sphinxupquote{success\_ratio}}}{\emph{contingency}, \emph{yes\_category=2}}{}
Returns the success ratio given dichotomous contingency data

\begin{DUlineblock}{0em}
\item[] Author: Dougie Squire
\item[] Date: 12/05/2018
\end{DUlineblock}
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{description}
\item[{\sphinxstylestrong{contingency}}] \leavevmode{[}xarray DataArray{]}
A 2 category contingency table of the form output from doppyo.skill.contingency

\item[{\sphinxstylestrong{success\_ratio}}] \leavevmode{[}value, optional{]}
The coordinate value of the category corresponding to ‘yes’

\end{description}

\item[{Returns}] \leavevmode\begin{description}
\item[{\sphinxstylestrong{success\_ratio}}] \leavevmode{[}xarray DataArray{]}
An array containing the success ratios

\end{description}

\end{description}\end{quote}
\subsubsection*{Notes}

See \sphinxurl{http://www.cawcr.gov.au/projects/verification/}
\subsubsection*{Examples}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{da\PYGZus{}cmp} \PYG{o}{=} \PYG{n}{xr}\PYG{o}{.}\PYG{n}{DataArray}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{random}\PYG{o}{.}\PYG{n}{normal}\PYG{p}{(}\PYG{n}{size}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{,}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} 
\PYG{g+gp}{... }                      \PYG{n}{coords}\PYG{o}{=}\PYG{p}{[}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{x}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{y}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{]}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{da\PYGZus{}ref} \PYG{o}{=} \PYG{n}{xr}\PYG{o}{.}\PYG{n}{DataArray}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{random}\PYG{o}{.}\PYG{n}{normal}\PYG{p}{(}\PYG{n}{size}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{,}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} 
\PYG{g+gp}{... }                      \PYG{n}{coords}\PYG{o}{=}\PYG{p}{[}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{x}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{y}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{]}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{category\PYGZus{}edges\PYGZus{}cmp} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{linspace}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{3}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{category\PYGZus{}edges\PYGZus{}ref} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{linspace}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{3}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{contingency} \PYG{o}{=} \PYG{n}{doppyo}\PYG{o}{.}\PYG{n}{skill}\PYG{o}{.}\PYG{n}{contingency}\PYG{p}{(}\PYG{n}{da\PYGZus{}cmp}\PYG{p}{,} \PYG{n}{da\PYGZus{}ref}\PYG{p}{,} \PYG{n}{category\PYGZus{}edges\PYGZus{}cmp}\PYG{p}{,} 
\PYG{g+gp}{... }                                       \PYG{n}{category\PYGZus{}edges\PYGZus{}ref}\PYG{p}{,} \PYG{n}{over\PYGZus{}dims}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{y}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{doppyo}\PYG{o}{.}\PYG{n}{skill}\PYG{o}{.}\PYG{n}{success\PYGZus{}ratio}\PYG{p}{(}\PYG{n}{contingency}\PYG{p}{)}
\PYG{g+go}{\PYGZlt{}xarray.DataArray \PYGZsq{}success\PYGZus{}ratio\PYGZsq{} (x: 3)\PYGZgt{}}
\PYG{g+go}{array([nan, nan,  1.])}
\PYG{g+go}{Coordinates:}
\PYG{g+go}{  * x        (x) int64 0 1 2}
\end{sphinxVerbatim}

\end{fulllineitems}

\index{threat\_score() (in module skill)@\spxentry{threat\_score()}\spxextra{in module skill}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{skill_doc:skill.threat_score}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{skill.}}\sphinxbfcode{\sphinxupquote{threat\_score}}}{\emph{contingency}, \emph{yes\_category=2}}{}
Returns the threat score given dichotomous contingency data

\begin{DUlineblock}{0em}
\item[] Author: Dougie Squire
\item[] Date: 12/05/2018
\end{DUlineblock}
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{description}
\item[{\sphinxstylestrong{contingency}}] \leavevmode{[}xarray DataArray{]}
A 2 category contingency table of the form output from doppyo.skill.contingency

\item[{\sphinxstylestrong{success\_ratio}}] \leavevmode{[}value, optional{]}
The coordinate value of the category corresponding to ‘yes’

\end{description}

\item[{Returns}] \leavevmode\begin{description}
\item[{\sphinxstylestrong{threat\_score}}] \leavevmode{[}xarray DataArray{]}
An array containing the threat scores

\end{description}

\end{description}\end{quote}
\subsubsection*{Notes}

See \sphinxurl{http://www.cawcr.gov.au/projects/verification/}
\subsubsection*{Examples}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{da\PYGZus{}cmp} \PYG{o}{=} \PYG{n}{xr}\PYG{o}{.}\PYG{n}{DataArray}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{random}\PYG{o}{.}\PYG{n}{normal}\PYG{p}{(}\PYG{n}{size}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{,}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} 
\PYG{g+gp}{... }                      \PYG{n}{coords}\PYG{o}{=}\PYG{p}{[}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{x}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{y}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{]}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{da\PYGZus{}ref} \PYG{o}{=} \PYG{n}{xr}\PYG{o}{.}\PYG{n}{DataArray}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{random}\PYG{o}{.}\PYG{n}{normal}\PYG{p}{(}\PYG{n}{size}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{,}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} 
\PYG{g+gp}{... }                      \PYG{n}{coords}\PYG{o}{=}\PYG{p}{[}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{x}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{y}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{]}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{category\PYGZus{}edges\PYGZus{}cmp} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{linspace}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{3}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{category\PYGZus{}edges\PYGZus{}ref} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{linspace}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{3}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{contingency} \PYG{o}{=} \PYG{n}{doppyo}\PYG{o}{.}\PYG{n}{skill}\PYG{o}{.}\PYG{n}{contingency}\PYG{p}{(}\PYG{n}{da\PYGZus{}cmp}\PYG{p}{,} \PYG{n}{da\PYGZus{}ref}\PYG{p}{,} \PYG{n}{category\PYGZus{}edges\PYGZus{}cmp}\PYG{p}{,} 
\PYG{g+gp}{... }                                       \PYG{n}{category\PYGZus{}edges\PYGZus{}ref}\PYG{p}{,} \PYG{n}{over\PYGZus{}dims}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{y}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{doppyo}\PYG{o}{.}\PYG{n}{skill}\PYG{o}{.}\PYG{n}{threat\PYGZus{}score}\PYG{p}{(}\PYG{n}{contingency}\PYG{p}{)}
\PYG{g+go}{\PYGZlt{}xarray.DataArray \PYGZsq{}threat\PYGZus{}score\PYGZsq{} (x: 3)\PYGZgt{}}
\PYG{g+go}{array([0. , 0. , 0.5])}
\PYG{g+go}{Coordinates:}
\PYG{g+go}{  * x        (x) int64 0 1 2}
\end{sphinxVerbatim}

\end{fulllineitems}

\index{equit\_threat\_score() (in module skill)@\spxentry{equit\_threat\_score()}\spxextra{in module skill}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{skill_doc:skill.equit_threat_score}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{skill.}}\sphinxbfcode{\sphinxupquote{equit\_threat\_score}}}{\emph{contingency}, \emph{yes\_category=2}}{}
Returns the equitable threat score given dichotomous contingency data

\begin{DUlineblock}{0em}
\item[] Author: Dougie Squire
\item[] Date: 12/05/2018
\end{DUlineblock}
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{description}
\item[{\sphinxstylestrong{contingency}}] \leavevmode{[}xarray DataArray{]}
A 2 category contingency table of the form output from doppyo.skill.contingency

\item[{\sphinxstylestrong{success\_ratio}}] \leavevmode{[}value, optional{]}
The coordinate value of the category corresponding to ‘yes’

\end{description}

\item[{Returns}] \leavevmode\begin{description}
\item[{\sphinxstylestrong{equit\_threat\_score}}] \leavevmode{[}xarray DataArray{]}
An array containing the equitable threat scores

\end{description}

\end{description}\end{quote}
\subsubsection*{Notes}

See \sphinxurl{http://www.cawcr.gov.au/projects/verification/}
\subsubsection*{Examples}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{da\PYGZus{}cmp} \PYG{o}{=} \PYG{n}{xr}\PYG{o}{.}\PYG{n}{DataArray}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{random}\PYG{o}{.}\PYG{n}{normal}\PYG{p}{(}\PYG{n}{size}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{,}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} 
\PYG{g+gp}{... }                      \PYG{n}{coords}\PYG{o}{=}\PYG{p}{[}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{x}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{y}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{]}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{da\PYGZus{}ref} \PYG{o}{=} \PYG{n}{xr}\PYG{o}{.}\PYG{n}{DataArray}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{random}\PYG{o}{.}\PYG{n}{normal}\PYG{p}{(}\PYG{n}{size}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{,}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} 
\PYG{g+gp}{... }                      \PYG{n}{coords}\PYG{o}{=}\PYG{p}{[}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{x}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{y}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{]}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{category\PYGZus{}edges\PYGZus{}cmp} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{linspace}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{3}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{category\PYGZus{}edges\PYGZus{}ref} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{linspace}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{3}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{contingency} \PYG{o}{=} \PYG{n}{doppyo}\PYG{o}{.}\PYG{n}{skill}\PYG{o}{.}\PYG{n}{contingency}\PYG{p}{(}\PYG{n}{da\PYGZus{}cmp}\PYG{p}{,} \PYG{n}{da\PYGZus{}ref}\PYG{p}{,} \PYG{n}{category\PYGZus{}edges\PYGZus{}cmp}\PYG{p}{,} 
\PYG{g+gp}{... }                                       \PYG{n}{category\PYGZus{}edges\PYGZus{}ref}\PYG{p}{,} \PYG{n}{over\PYGZus{}dims}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{y}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{doppyo}\PYG{o}{.}\PYG{n}{skill}\PYG{o}{.}\PYG{n}{equit\PYGZus{}threat\PYGZus{}score}\PYG{p}{(}\PYG{n}{contingency}\PYG{p}{)}
\PYG{g+go}{\PYGZlt{}xarray.DataArray \PYGZsq{}equit\PYGZus{}threat\PYGZus{}score\PYGZsq{} (x: 3)\PYGZgt{}}
\PYG{g+go}{array([0., 0., 0.])}
\PYG{g+go}{Coordinates:}
\PYG{g+go}{  * x        (x) int64 0 1 2}
\end{sphinxVerbatim}

\end{fulllineitems}

\index{odds\_ratio() (in module skill)@\spxentry{odds\_ratio()}\spxextra{in module skill}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{skill_doc:skill.odds_ratio}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{skill.}}\sphinxbfcode{\sphinxupquote{odds\_ratio}}}{\emph{contingency}, \emph{yes\_category=2}}{}
Returns the odds ratio given dichotomous contingency data

\begin{DUlineblock}{0em}
\item[] Author: Dougie Squire
\item[] Date: 12/05/2018
\end{DUlineblock}
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{description}
\item[{\sphinxstylestrong{contingency}}] \leavevmode{[}xarray DataArray{]}
A 2 category contingency table of the form output from doppyo.skill.contingency

\item[{\sphinxstylestrong{success\_ratio}}] \leavevmode{[}value, optional{]}
The coordinate value of the category corresponding to ‘yes’

\end{description}

\item[{Returns}] \leavevmode\begin{description}
\item[{\sphinxstylestrong{odds\_ratio}}] \leavevmode{[}xarray DataArray{]}
An array containing the equitable odds ratios

\end{description}

\end{description}\end{quote}
\subsubsection*{Notes}

See \sphinxurl{http://www.cawcr.gov.au/projects/verification/}
\subsubsection*{Examples}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{da\PYGZus{}cmp} \PYG{o}{=} \PYG{n}{xr}\PYG{o}{.}\PYG{n}{DataArray}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{random}\PYG{o}{.}\PYG{n}{normal}\PYG{p}{(}\PYG{n}{size}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{,}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} 
\PYG{g+gp}{... }                      \PYG{n}{coords}\PYG{o}{=}\PYG{p}{[}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{x}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{y}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{]}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{da\PYGZus{}ref} \PYG{o}{=} \PYG{n}{xr}\PYG{o}{.}\PYG{n}{DataArray}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{random}\PYG{o}{.}\PYG{n}{normal}\PYG{p}{(}\PYG{n}{size}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{,}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} 
\PYG{g+gp}{... }                      \PYG{n}{coords}\PYG{o}{=}\PYG{p}{[}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{x}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{y}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{]}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{category\PYGZus{}edges\PYGZus{}cmp} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{linspace}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{3}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{category\PYGZus{}edges\PYGZus{}ref} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{linspace}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{3}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{contingency} \PYG{o}{=} \PYG{n}{doppyo}\PYG{o}{.}\PYG{n}{skill}\PYG{o}{.}\PYG{n}{contingency}\PYG{p}{(}\PYG{n}{da\PYGZus{}cmp}\PYG{p}{,} \PYG{n}{da\PYGZus{}ref}\PYG{p}{,} \PYG{n}{category\PYGZus{}edges\PYGZus{}cmp}\PYG{p}{,} 
\PYG{g+gp}{... }                                       \PYG{n}{category\PYGZus{}edges\PYGZus{}ref}\PYG{p}{,} \PYG{n}{over\PYGZus{}dims}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{y}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{doppyo}\PYG{o}{.}\PYG{n}{skill}\PYG{o}{.}\PYG{n}{odds\PYGZus{}ratio}\PYG{p}{(}\PYG{n}{contingency}\PYG{p}{)}
\PYG{g+go}{\PYGZlt{}xarray.DataArray \PYGZsq{}odds\PYGZus{}ratio\PYGZsq{} (x: 3)\PYGZgt{}}
\PYG{g+go}{array([ 0.,  0., nan])}
\PYG{g+go}{Coordinates:}
\PYG{g+go}{  * x        (x) int64 0 1 2}
\end{sphinxVerbatim}

\end{fulllineitems}

\index{odds\_ratio\_skill\_score() (in module skill)@\spxentry{odds\_ratio\_skill\_score()}\spxextra{in module skill}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{skill_doc:skill.odds_ratio_skill_score}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{skill.}}\sphinxbfcode{\sphinxupquote{odds\_ratio\_skill\_score}}}{\emph{contingency}, \emph{yes\_category=2}}{}
Returns the odds ratio skill score given dichotomous contingency data

\begin{DUlineblock}{0em}
\item[] Author: Dougie Squire
\item[] Date: 12/05/2018
\end{DUlineblock}
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{description}
\item[{\sphinxstylestrong{contingency}}] \leavevmode{[}xarray DataArray{]}
A 2 category contingency table of the form output from doppyo.skill.contingency

\item[{\sphinxstylestrong{success\_ratio}}] \leavevmode{[}value, optional{]}
The coordinate value of the category corresponding to ‘yes’

\end{description}

\item[{Returns}] \leavevmode\begin{description}
\item[{\sphinxstylestrong{odds\_ratio\_skill\_score}}] \leavevmode{[}xarray DataArray{]}
An array containing the equitable odds ratio skill scores

\end{description}

\end{description}\end{quote}
\subsubsection*{Notes}

See \sphinxurl{http://www.cawcr.gov.au/projects/verification/}
\subsubsection*{Examples}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{da\PYGZus{}cmp} \PYG{o}{=} \PYG{n}{xr}\PYG{o}{.}\PYG{n}{DataArray}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{random}\PYG{o}{.}\PYG{n}{normal}\PYG{p}{(}\PYG{n}{size}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{,}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} 
\PYG{g+gp}{... }                      \PYG{n}{coords}\PYG{o}{=}\PYG{p}{[}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{x}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{y}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{]}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{da\PYGZus{}ref} \PYG{o}{=} \PYG{n}{xr}\PYG{o}{.}\PYG{n}{DataArray}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{random}\PYG{o}{.}\PYG{n}{normal}\PYG{p}{(}\PYG{n}{size}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{,}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} 
\PYG{g+gp}{... }                      \PYG{n}{coords}\PYG{o}{=}\PYG{p}{[}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{x}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{y}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{]}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{category\PYGZus{}edges\PYGZus{}cmp} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{linspace}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{3}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{category\PYGZus{}edges\PYGZus{}ref} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{linspace}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{3}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{contingency} \PYG{o}{=} \PYG{n}{doppyo}\PYG{o}{.}\PYG{n}{skill}\PYG{o}{.}\PYG{n}{contingency}\PYG{p}{(}\PYG{n}{da\PYGZus{}cmp}\PYG{p}{,} \PYG{n}{da\PYGZus{}ref}\PYG{p}{,} \PYG{n}{category\PYGZus{}edges\PYGZus{}cmp}\PYG{p}{,} 
\PYG{g+gp}{... }                                       \PYG{n}{category\PYGZus{}edges\PYGZus{}ref}\PYG{p}{,} \PYG{n}{over\PYGZus{}dims}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{y}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{doppyo}\PYG{o}{.}\PYG{n}{skill}\PYG{o}{.}\PYG{n}{odds\PYGZus{}ratio\PYGZus{}skill\PYGZus{}score}\PYG{p}{(}\PYG{n}{contingency}\PYG{p}{)}
\PYG{g+go}{\PYGZlt{}xarray.DataArray \PYGZsq{}odds\PYGZus{}ratio\PYGZus{}skill\PYGZsq{} (x: 3)\PYGZgt{}}
\PYG{g+go}{array([\PYGZhy{}1., \PYGZhy{}1., nan])}
\PYG{g+go}{Coordinates:}
\PYG{g+go}{  * x        (x) int64 0 1 2}
\end{sphinxVerbatim}

\end{fulllineitems}

\index{mean\_additive\_bias() (in module skill)@\spxentry{mean\_additive\_bias()}\spxextra{in module skill}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{skill_doc:skill.mean_additive_bias}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{skill.}}\sphinxbfcode{\sphinxupquote{mean\_additive\_bias}}}{\emph{da\_cmp}, \emph{da\_ref}, \emph{over\_dims}}{}
Returns the additive bias between comparison and reference datasets

\begin{DUlineblock}{0em}
\item[] Author: Dougie Squire
\item[] Date: 28/04/2018
\end{DUlineblock}
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{description}
\item[{\sphinxstylestrong{da\_cmp}}] \leavevmode{[}xarray DataArray{]}
Array containing data to be compared to reference dataset (usually forecasts)

\item[{\sphinxstylestrong{da\_ref}}] \leavevmode{[}xarray DataArray{]}
Array containing reference data (usually observations)

\item[{\sphinxstylestrong{over\_dims}}] \leavevmode{[}str or sequence of str, optional{]}
Dimensions over which to compute the mean additive bias

\end{description}

\item[{Returns}] \leavevmode\begin{description}
\item[{\sphinxstylestrong{mean\_additive\_bias}}] \leavevmode{[}xarray DataArray{]}
Array containing the mean additive biases

\end{description}

\end{description}\end{quote}
\subsubsection*{Notes}

See \sphinxurl{http://www.cawcr.gov.au/projects/verification/}
\subsubsection*{Examples}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{da\PYGZus{}cmp} \PYG{o}{=} \PYG{n}{xr}\PYG{o}{.}\PYG{n}{DataArray}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{random}\PYG{o}{.}\PYG{n}{normal}\PYG{p}{(}\PYG{n}{size}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{,}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} 
\PYG{g+gp}{... }                      \PYG{n}{coords}\PYG{o}{=}\PYG{p}{[}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{x}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{y}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{]}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{da\PYGZus{}ref} \PYG{o}{=} \PYG{n}{xr}\PYG{o}{.}\PYG{n}{DataArray}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{random}\PYG{o}{.}\PYG{n}{normal}\PYG{p}{(}\PYG{n}{size}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{,}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} 
\PYG{g+gp}{... }                      \PYG{n}{coords}\PYG{o}{=}\PYG{p}{[}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{x}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{y}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{]}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{doppyo}\PYG{o}{.}\PYG{n}{skill}\PYG{o}{.}\PYG{n}{mean\PYGZus{}additive\PYGZus{}bias}\PYG{p}{(}\PYG{n}{da\PYGZus{}cmp}\PYG{p}{,} \PYG{n}{da\PYGZus{}ref}\PYG{p}{,} \PYG{n}{over\PYGZus{}dims}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{x}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{g+go}{\PYGZlt{}xarray.DataArray \PYGZsq{}mean\PYGZus{}additive\PYGZus{}bias\PYGZsq{} (y: 3)\PYGZgt{}}
\PYG{g+go}{array([0.328462, 0.172263, 0.402438])}
\PYG{g+go}{Coordinates:}
\PYG{g+go}{  * y        (y) int64 0 1 2}
\end{sphinxVerbatim}

\end{fulllineitems}

\index{mean\_multiplicative\_bias() (in module skill)@\spxentry{mean\_multiplicative\_bias()}\spxextra{in module skill}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{skill_doc:skill.mean_multiplicative_bias}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{skill.}}\sphinxbfcode{\sphinxupquote{mean\_multiplicative\_bias}}}{\emph{da\_cmp}, \emph{da\_ref}, \emph{over\_dims}}{}
Returns the multiplicative bias between comparison and reference datasets

\begin{DUlineblock}{0em}
\item[] Author: Dougie Squire
\item[] Date: 28/04/2018
\end{DUlineblock}
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{description}
\item[{\sphinxstylestrong{da\_cmp}}] \leavevmode{[}xarray DataArray{]}
Array containing data to be compared to reference dataset (usually forecasts)

\item[{\sphinxstylestrong{da\_ref}}] \leavevmode{[}xarray DataArray{]}
Array containing reference data (usually observations)

\item[{\sphinxstylestrong{over\_dims}}] \leavevmode{[}str or sequence of str, optional{]}
Dimensions over which to compute the mean multiplicative bias

\end{description}

\item[{Returns}] \leavevmode\begin{description}
\item[{\sphinxstylestrong{mean\_multiplicative\_bias}}] \leavevmode{[}xarray DataArray{]}
Array containing the mean multiplicative biases

\end{description}

\end{description}\end{quote}
\subsubsection*{Notes}

See \sphinxurl{http://www.cawcr.gov.au/projects/verification/}
\subsubsection*{Examples}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{da\PYGZus{}cmp} \PYG{o}{=} \PYG{n}{xr}\PYG{o}{.}\PYG{n}{DataArray}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{random}\PYG{o}{.}\PYG{n}{normal}\PYG{p}{(}\PYG{n}{size}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{,}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} 
\PYG{g+gp}{... }                      \PYG{n}{coords}\PYG{o}{=}\PYG{p}{[}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{x}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{y}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{]}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{da\PYGZus{}ref} \PYG{o}{=} \PYG{n}{xr}\PYG{o}{.}\PYG{n}{DataArray}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{random}\PYG{o}{.}\PYG{n}{normal}\PYG{p}{(}\PYG{n}{size}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{,}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} 
\PYG{g+gp}{... }                      \PYG{n}{coords}\PYG{o}{=}\PYG{p}{[}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{x}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{y}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{]}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{doppyo}\PYG{o}{.}\PYG{n}{skill}\PYG{o}{.}\PYG{n}{mean\PYGZus{}multiplicative\PYGZus{}bias}\PYG{p}{(}\PYG{n}{da\PYGZus{}cmp}\PYG{p}{,} \PYG{n}{da\PYGZus{}ref}\PYG{p}{,} \PYG{n}{over\PYGZus{}dims}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{x}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{g+go}{\PYGZlt{}xarray.DataArray \PYGZsq{}mean\PYGZus{}multiplicative\PYGZus{}bias\PYGZsq{} (y: 3)\PYGZgt{}}
\PYG{g+go}{array([ 2.108882,  4.356835, \PYGZhy{}0.83234 ])}
\PYG{g+go}{Coordinates:}
\PYG{g+go}{  * y        (y) int64 0 1 2}
\end{sphinxVerbatim}

\end{fulllineitems}

\index{mean\_absolute\_error() (in module skill)@\spxentry{mean\_absolute\_error()}\spxextra{in module skill}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{skill_doc:skill.mean_absolute_error}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{skill.}}\sphinxbfcode{\sphinxupquote{mean\_absolute\_error}}}{\emph{da\_cmp}, \emph{da\_ref}, \emph{over\_dims}}{}
Returns the mean absolute error between comparison and reference datasets

\begin{DUlineblock}{0em}
\item[] Author: Dougie Squire
\item[] Date: 28/04/2018
\end{DUlineblock}
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{description}
\item[{\sphinxstylestrong{da\_cmp}}] \leavevmode{[}xarray DataArray{]}
Array containing data to be compared to reference dataset (usually forecasts)

\item[{\sphinxstylestrong{da\_ref}}] \leavevmode{[}xarray DataArray{]}
Array containing reference data (usually observations)

\item[{\sphinxstylestrong{over\_dims}}] \leavevmode{[}str or sequence of str, optional{]}
Dimensions over which to compute the mean absolute error

\end{description}

\item[{Returns}] \leavevmode\begin{description}
\item[{\sphinxstylestrong{mean\_absolute\_error}}] \leavevmode{[}xarray DataArray{]}
Array containing the mean absolute error

\end{description}

\end{description}\end{quote}
\subsubsection*{Notes}

See \sphinxurl{http://www.cawcr.gov.au/projects/verification/}
\subsubsection*{Examples}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{da\PYGZus{}cmp} \PYG{o}{=} \PYG{n}{xr}\PYG{o}{.}\PYG{n}{DataArray}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{random}\PYG{o}{.}\PYG{n}{normal}\PYG{p}{(}\PYG{n}{size}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{,}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} 
\PYG{g+gp}{... }                      \PYG{n}{coords}\PYG{o}{=}\PYG{p}{[}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{x}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{y}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{]}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{da\PYGZus{}ref} \PYG{o}{=} \PYG{n}{xr}\PYG{o}{.}\PYG{n}{DataArray}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{random}\PYG{o}{.}\PYG{n}{normal}\PYG{p}{(}\PYG{n}{size}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{,}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} 
\PYG{g+gp}{... }                      \PYG{n}{coords}\PYG{o}{=}\PYG{p}{[}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{x}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{y}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{]}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{doppyo}\PYG{o}{.}\PYG{n}{skill}\PYG{o}{.}\PYG{n}{mean\PYGZus{}absolute\PYGZus{}error}\PYG{p}{(}\PYG{n}{da\PYGZus{}cmp}\PYG{p}{,} \PYG{n}{da\PYGZus{}ref}\PYG{p}{,} \PYG{n}{over\PYGZus{}dims}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{x}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{g+go}{\PYGZlt{}xarray.DataArray \PYGZsq{}mean\PYGZus{}absolute\PYGZus{}error\PYGZsq{} (y: 3)\PYGZgt{}}
\PYG{g+go}{array([1.030629, 1.265555, 0.770711])}
\PYG{g+go}{Coordinates:}
\PYG{g+go}{  * y        (y) int64 0 1 2}
\end{sphinxVerbatim}

\end{fulllineitems}

\index{mean\_squared\_error() (in module skill)@\spxentry{mean\_squared\_error()}\spxextra{in module skill}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{skill_doc:skill.mean_squared_error}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{skill.}}\sphinxbfcode{\sphinxupquote{mean\_squared\_error}}}{\emph{da\_cmp}, \emph{da\_ref}, \emph{over\_dims}}{}
Returns the mean sqaured error between comparison and reference datasets

\begin{DUlineblock}{0em}
\item[] Author: Dougie Squire
\item[] Date: 28/04/2018
\end{DUlineblock}
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{description}
\item[{\sphinxstylestrong{da\_cmp}}] \leavevmode{[}xarray DataArray{]}
Array containing data to be compared to reference dataset (usually forecasts)

\item[{\sphinxstylestrong{da\_ref}}] \leavevmode{[}xarray DataArray{]}
Array containing reference data (usually observations)

\item[{\sphinxstylestrong{over\_dims}}] \leavevmode{[}str or sequence of str, optional{]}
Dimensions over which to compute the mean squared error

\end{description}

\item[{Returns}] \leavevmode\begin{description}
\item[{\sphinxstylestrong{mean\_squared\_error}}] \leavevmode{[}xarray DataArray{]}
Array containing the mean squared error

\end{description}

\end{description}\end{quote}
\subsubsection*{Notes}

See \sphinxurl{http://www.cawcr.gov.au/projects/verification/}
\subsubsection*{Examples}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{da\PYGZus{}cmp} \PYG{o}{=} \PYG{n}{xr}\PYG{o}{.}\PYG{n}{DataArray}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{random}\PYG{o}{.}\PYG{n}{normal}\PYG{p}{(}\PYG{n}{size}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{,}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} 
\PYG{g+gp}{... }                      \PYG{n}{coords}\PYG{o}{=}\PYG{p}{[}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{x}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{y}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{]}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{da\PYGZus{}ref} \PYG{o}{=} \PYG{n}{xr}\PYG{o}{.}\PYG{n}{DataArray}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{random}\PYG{o}{.}\PYG{n}{normal}\PYG{p}{(}\PYG{n}{size}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{,}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} 
\PYG{g+gp}{... }                      \PYG{n}{coords}\PYG{o}{=}\PYG{p}{[}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{x}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{y}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{]}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{doppyo}\PYG{o}{.}\PYG{n}{skill}\PYG{o}{.}\PYG{n}{mean\PYGZus{}squared\PYGZus{}error}\PYG{p}{(}\PYG{n}{da\PYGZus{}cmp}\PYG{p}{,} \PYG{n}{da\PYGZus{}ref}\PYG{p}{,} \PYG{n}{over\PYGZus{}dims}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{x}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{g+go}{\PYGZlt{}xarray.DataArray \PYGZsq{}mean\PYGZus{}squared\PYGZus{}error\PYGZsq{} (y: 3)\PYGZgt{}}
\PYG{g+go}{array([1.257412, 1.725008, 0.721863])}
\PYG{g+go}{Coordinates:}
\PYG{g+go}{  * y        (y) int64 0 1 2}
\end{sphinxVerbatim}

\end{fulllineitems}

\index{rms\_error() (in module skill)@\spxentry{rms\_error()}\spxextra{in module skill}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{skill_doc:skill.rms_error}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{skill.}}\sphinxbfcode{\sphinxupquote{rms\_error}}}{\emph{da\_cmp}, \emph{da\_ref}, \emph{over\_dims}}{}
Returns the root mean sqaured error between comparison and reference datasets

\begin{DUlineblock}{0em}
\item[] Author: Dougie Squire
\item[] Date: 28/04/2018
\end{DUlineblock}
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{description}
\item[{\sphinxstylestrong{da\_cmp}}] \leavevmode{[}xarray DataArray{]}
Array containing data to be compared to reference dataset (usually forecasts)

\item[{\sphinxstylestrong{da\_ref}}] \leavevmode{[}xarray DataArray{]}
Array containing reference data (usually observations)

\item[{\sphinxstylestrong{over\_dims}}] \leavevmode{[}str or sequence of str, optional{]}
Dimensions over which to compute the root mean squared error

\end{description}

\item[{Returns}] \leavevmode\begin{description}
\item[{\sphinxstylestrong{rms\_error}}] \leavevmode{[}xarray DataArray{]}
Array containing the root mean squared error

\end{description}

\end{description}\end{quote}
\subsubsection*{Notes}

See \sphinxurl{http://www.cawcr.gov.au/projects/verification/}
\subsubsection*{Examples}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{da\PYGZus{}cmp} \PYG{o}{=} \PYG{n}{xr}\PYG{o}{.}\PYG{n}{DataArray}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{random}\PYG{o}{.}\PYG{n}{normal}\PYG{p}{(}\PYG{n}{size}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{,}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} 
\PYG{g+gp}{... }                      \PYG{n}{coords}\PYG{o}{=}\PYG{p}{[}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{x}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{y}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{]}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{da\PYGZus{}ref} \PYG{o}{=} \PYG{n}{xr}\PYG{o}{.}\PYG{n}{DataArray}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{random}\PYG{o}{.}\PYG{n}{normal}\PYG{p}{(}\PYG{n}{size}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{,}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} 
\PYG{g+gp}{... }                      \PYG{n}{coords}\PYG{o}{=}\PYG{p}{[}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{x}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{y}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{]}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{doppyo}\PYG{o}{.}\PYG{n}{skill}\PYG{o}{.}\PYG{n}{rms\PYGZus{}error}\PYG{p}{(}\PYG{n}{da\PYGZus{}cmp}\PYG{p}{,} \PYG{n}{da\PYGZus{}ref}\PYG{p}{,} \PYG{n}{over\PYGZus{}dims}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{x}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{g+go}{\PYGZlt{}xarray.DataArray \PYGZsq{}root\PYGZus{}mean\PYGZus{}squared\PYGZus{}error\PYGZsq{} (y: 3)\PYGZgt{}}
\PYG{g+go}{array([1.964753, 1.426566, 1.20612 ])}
\PYG{g+go}{Coordinates:}
\PYG{g+go}{  * y        (y) int64 0 1 2}
\end{sphinxVerbatim}

\end{fulllineitems}

\index{Pearson\_corrcoeff() (in module skill)@\spxentry{Pearson\_corrcoeff()}\spxextra{in module skill}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{skill_doc:skill.Pearson_corrcoeff}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{skill.}}\sphinxbfcode{\sphinxupquote{Pearson\_corrcoeff}}}{\emph{da\_cmp}, \emph{da\_ref}, \emph{over\_dims}, \emph{subtract\_local\_mean=True}}{}
Returns the Pearson correlation coefficients over the specified dimensions.

\begin{DUlineblock}{0em}
\item[] Author: Dougie Squire
\item[] Date: 28/04/2018
\end{DUlineblock}
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{description}
\item[{\sphinxstylestrong{da\_cmp}}] \leavevmode{[}xarray DataArray{]}
Array containing data to be compared to reference dataset (usually forecasts)

\item[{\sphinxstylestrong{da\_ref}}] \leavevmode{[}xarray DataArray{]}
Array containing reference data (usually observations)

\item[{\sphinxstylestrong{over\_dims}}] \leavevmode{[}str or sequence of str, optional{]}
Dimensions over which to compute the correlation coefficients

\item[{\sphinxstylestrong{subtract\_local\_mean}}] \leavevmode{[}bool, optional{]}
If True, this function will subtract the mean computed over over\_dims. Otherwise, no mean                    field is removed prior to computing the correlation

\end{description}

\item[{Returns}] \leavevmode\begin{description}
\item[{\sphinxstylestrong{Pearson\_corrcoeff}}] \leavevmode{[}xarray DataArray{]}
Array containing the Pearson correlation coefficients

\end{description}

\end{description}\end{quote}
\subsubsection*{Notes}

\begin{DUlineblock}{0em}
\item[] If any dimensions in over\_dims do not exist in either da\_cmp or da\_ref, the correlation is                 computed over all dimensions in over\_dims that appear in both da\_cmp and da\_ref, and then                 averaged over any remaining dimensions in over\_dims
\item[] See \sphinxurl{http://www.cawcr.gov.au/projects/verification/}
\end{DUlineblock}
\subsubsection*{Examples}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{da\PYGZus{}cmp} \PYG{o}{=} \PYG{n}{xr}\PYG{o}{.}\PYG{n}{DataArray}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{random}\PYG{o}{.}\PYG{n}{normal}\PYG{p}{(}\PYG{n}{size}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{100}\PYG{p}{,}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} 
\PYG{g+gp}{... }                      \PYG{n}{coords}\PYG{o}{=}\PYG{p}{[}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{x}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{100}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{y}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{]}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{da\PYGZus{}ref} \PYG{o}{=} \PYG{n}{xr}\PYG{o}{.}\PYG{n}{DataArray}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{random}\PYG{o}{.}\PYG{n}{normal}\PYG{p}{(}\PYG{n}{size}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{100}\PYG{p}{,}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} 
\PYG{g+gp}{... }                      \PYG{n}{coords}\PYG{o}{=}\PYG{p}{[}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{x}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{100}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{y}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{]}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{doppyo}\PYG{o}{.}\PYG{n}{skill}\PYG{o}{.}\PYG{n}{Pearson\PYGZus{}corrcoeff}\PYG{p}{(}\PYG{n}{da\PYGZus{}cmp}\PYG{p}{,} \PYG{n}{da\PYGZus{}ref}\PYG{p}{,} \PYG{n}{over\PYGZus{}dims}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{x}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{g+go}{\PYGZlt{}xarray.DataArray \PYGZsq{}Pearson\PYGZus{}corrcoeff\PYGZsq{} (y: 3)\PYGZgt{}}
\PYG{g+go}{array([\PYGZhy{}0.040584, \PYGZhy{}0.037983, \PYGZhy{}0.020941])}
\PYG{g+go}{Coordinates:}
\PYG{g+go}{  * y        (y) int64 0 1 2}
\end{sphinxVerbatim}

\end{fulllineitems}

\index{sign\_test() (in module skill)@\spxentry{sign\_test()}\spxextra{in module skill}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{skill_doc:skill.sign_test}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{skill.}}\sphinxbfcode{\sphinxupquote{sign\_test}}}{\emph{da\_cmp1}, \emph{da\_cmp2}, \emph{da\_ref}, \emph{time\_dim='init\_date'}}{}
Returns the Delsole and Tippett sign test over the given time period

\begin{DUlineblock}{0em}
\item[] Author: Dougie Squire
\item[] Date: 26/03/2019
\end{DUlineblock}
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{description}
\item[{\sphinxstylestrong{da\_cmp1}}] \leavevmode{[}xarray DataArray{]}
Array containing data to be compared to da\_cmp1

\item[{\sphinxstylestrong{da\_cmp2}}] \leavevmode{[}xarray DataArray{]}
Array containing data to be compared to da\_cmp2

\item[{\sphinxstylestrong{da\_ref}}] \leavevmode{[}xarray DataArray{]}
Array containing data to use as reference

\item[{\sphinxstylestrong{time\_dim}}] \leavevmode{[}str, optional{]}
Name of dimension over which to compute the random walk

\end{description}

\item[{Returns}] \leavevmode\begin{description}
\item[{\sphinxstylestrong{sign\_test}}] \leavevmode{[}xarray DataArray{]}
Array containing the results of the sign test

\item[{\sphinxstylestrong{confidence}}] \leavevmode{[}xarray DataArray{]}
Array containing 95\% confidence bounds

\end{description}

\end{description}\end{quote}
\subsubsection*{Notes}

See Delsole and Tippett 2016 \sphinxtitleref{Forecast Comparison Based on Random Walks}
\subsubsection*{Examples}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{x} \PYG{o}{=} \PYG{n}{xr}\PYG{o}{.}\PYG{n}{DataArray}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{random}\PYG{o}{.}\PYG{n}{normal}\PYG{p}{(}\PYG{n}{size}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{,}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} 
\PYG{g+gp}{... }                 \PYG{n}{coords}\PYG{o}{=}\PYG{p}{[}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{t}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{x}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{]}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{y} \PYG{o}{=} \PYG{n}{xr}\PYG{o}{.}\PYG{n}{DataArray}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{random}\PYG{o}{.}\PYG{n}{normal}\PYG{p}{(}\PYG{n}{size}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{,}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} 
\PYG{g+gp}{... }                \PYG{n}{coords}\PYG{o}{=}\PYG{p}{[}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{t}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{x}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{]}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{o} \PYG{o}{=} \PYG{n}{xr}\PYG{o}{.}\PYG{n}{DataArray}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{random}\PYG{o}{.}\PYG{n}{normal}\PYG{p}{(}\PYG{n}{size}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{,}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} 
\PYG{g+gp}{... }                 \PYG{n}{coords}\PYG{o}{=}\PYG{p}{[}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{t}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{x}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{]}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{walk}\PYG{p}{,} \PYG{n}{confidence} \PYG{o}{=} \PYG{n}{sign\PYGZus{}test}\PYG{p}{(}\PYG{n}{x}\PYG{p}{,} \PYG{n}{y}\PYG{p}{,} \PYG{n}{o}\PYG{p}{,} \PYG{n}{time\PYGZus{}dim}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{t}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{walk}
\PYG{g+go}{\PYGZlt{}xarray.DataArray (t: 3, x: 3)\PYGZgt{}}
\PYG{g+go}{array([[\PYGZhy{}1, \PYGZhy{}1, \PYGZhy{}1],}
\PYG{g+go}{       [ 0,  0, \PYGZhy{}2],}
\PYG{g+go}{       [\PYGZhy{}1, \PYGZhy{}1, \PYGZhy{}3]])}
\PYG{g+go}{Coordinates:}
\PYG{g+go}{  * t        (t) int64 0 1 2}
\PYG{g+go}{  * x        (x) int64 0 1 2}
\end{sphinxVerbatim}

\end{fulllineitems}



\section{\sphinxstyleliteralintitle{\sphinxupquote{utils}}}
\label{\detokenize{utils_doc:module-utils}}\label{\detokenize{utils_doc:utils}}\label{\detokenize{utils_doc::doc}}\index{utils (module)@\spxentry{utils}\spxextra{module}}
General support functions for the doppyo package


\subsection{API}
\label{\detokenize{utils_doc:api}}\index{timer (class in utils)@\spxentry{timer}\spxextra{class in utils}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{utils_doc:utils.timer}}\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{class }}\sphinxcode{\sphinxupquote{utils.}}\sphinxbfcode{\sphinxupquote{timer}}}{\emph{name=None}}{}
Reports time taken to complete code snippets.

\begin{DUlineblock}{0em}
\item[] Author: Dougie Squire
\item[] Date: 14/02/2018
\end{DUlineblock}
\subsubsection*{Examples}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{k}{with} \PYG{n}{doppyo}\PYG{o}{.}\PYG{n}{utils}\PYG{o}{.}\PYG{n}{timer}\PYG{p}{(}\PYG{p}{)}\PYG{p}{:}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }    \PYG{n}{x} \PYG{o}{=} \PYG{l+m+mi}{1} \PYG{o}{+} \PYG{l+m+mi}{1}
\PYG{g+go}{Elapsed: 4.5299530029296875e\PYGZhy{}06 sec}
\end{sphinxVerbatim}

\end{fulllineitems}

\index{constants (class in utils)@\spxentry{constants}\spxextra{class in utils}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{utils_doc:utils.constants}}\pysigline{\sphinxbfcode{\sphinxupquote{class }}\sphinxcode{\sphinxupquote{utils.}}\sphinxbfcode{\sphinxupquote{constants}}}
Returns commonly used constants.

\begin{DUlineblock}{0em}
\item[] Author: Dougie Squire
\item[] Date: 14/02/2018
\end{DUlineblock}
\subsubsection*{Examples}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{pi} \PYG{o}{=} \PYG{n}{doppyo}\PYG{o}{.}\PYG{n}{utils}\PYG{o}{.}\PYG{n}{constants}\PYG{p}{(}\PYG{p}{)}\PYG{o}{.}\PYG{n}{pi}
\end{sphinxVerbatim}
\begin{quote}\begin{description}
\item[{Attributes}] \leavevmode\begin{description}
\item[{\sphinxstylestrong{C\_l}}] \leavevmode
\item[{\sphinxstylestrong{C\_pd}}] \leavevmode
\item[{\sphinxstylestrong{C\_pv}}] \leavevmode
\item[{\sphinxstylestrong{C\_vd}}] \leavevmode
\item[{\sphinxstylestrong{C\_vv}}] \leavevmode
\item[{\sphinxstylestrong{Ce}}] \leavevmode
\item[{\sphinxstylestrong{Omega}}] \leavevmode
\item[{\sphinxstylestrong{R\_d}}] \leavevmode
\item[{\sphinxstylestrong{R\_earth}}] \leavevmode
\item[{\sphinxstylestrong{R\_v}}] \leavevmode
\item[{\sphinxstylestrong{g}}] \leavevmode
\item[{\sphinxstylestrong{pi}}] \leavevmode
\end{description}

\end{description}\end{quote}

\end{fulllineitems}

\index{skewness() (in module utils)@\spxentry{skewness()}\spxextra{in module utils}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{utils_doc:utils.skewness}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{utils.}}\sphinxbfcode{\sphinxupquote{skewness}}}{\emph{da}, \emph{dim}}{}
Returns the skewness along dimension dim

\begin{DUlineblock}{0em}
\item[] Author: Dougie Squire
\item[] Date: 20/08/2018
\end{DUlineblock}
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{description}
\item[{\sphinxstylestrong{da}}] \leavevmode{[}xarray DataArray{]}
Array containing values for which to compute skewness

\item[{\sphinxstylestrong{dim}}] \leavevmode{[}str or sequence of str{]}
Dimension(s) over which to compute the skewness

\end{description}

\item[{Returns}] \leavevmode\begin{description}
\item[{\sphinxstylestrong{skewness}}] \leavevmode{[}xarray DataArray{]}
New DataArray object with skewness applied to its data and the indicated dimension(s) removed

\end{description}

\end{description}\end{quote}
\subsubsection*{Examples}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{arr} \PYG{o}{=} \PYG{n}{xr}\PYG{o}{.}\PYG{n}{DataArray}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{6}\PYG{p}{)}\PYG{o}{.}\PYG{n}{reshape}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{,} \PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{,} 
\PYG{g+gp}{... }                   \PYG{n}{coords}\PYG{o}{=}\PYG{p}{[}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{x}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{a}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{b}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}\PYG{p}{,} \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{y}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{,} \PYG{l+m+mi}{2}\PYG{p}{]}\PYG{p}{)}\PYG{p}{]}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{arr}
\PYG{g+go}{\PYGZlt{}xarray.DataArray (x: 2, y: 3)\PYGZgt{}}
\PYG{g+go}{array([[0, 1, 2],}
\PYG{g+go}{       [3, 4, 5]])}
\PYG{g+go}{Coordinates:}
\PYG{g+go}{  * x        (x) \PYGZlt{}U1 \PYGZsq{}a\PYGZsq{} \PYGZsq{}b\PYGZsq{}}
\PYG{g+go}{  * y        (y) int64 0 1 2}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{doppyo}\PYG{o}{.}\PYG{n}{utils}\PYG{o}{.}\PYG{n}{skewness}\PYG{p}{(}\PYG{n}{arr}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{x}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{g+go}{\PYGZlt{}xarray.DataArray (y: 3)\PYGZgt{}}
\PYG{g+go}{array([0., 0., 0.])}
\PYG{g+go}{Coordinates:}
\PYG{g+go}{  * y        (y) int64 0 1 2}
\end{sphinxVerbatim}

\end{fulllineitems}

\index{kurtosis() (in module utils)@\spxentry{kurtosis()}\spxextra{in module utils}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{utils_doc:utils.kurtosis}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{utils.}}\sphinxbfcode{\sphinxupquote{kurtosis}}}{\emph{da}, \emph{dim}}{}
Returns the kurtosis along dimension dim

\begin{DUlineblock}{0em}
\item[] Author: Dougie Squire
\item[] Date: 20/08/2018
\end{DUlineblock}
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{description}
\item[{\sphinxstylestrong{da}}] \leavevmode{[}xarray DataArray{]}
Array containing values for which to compute kurtosis

\item[{\sphinxstylestrong{dim}}] \leavevmode{[}str or sequence of str{]}
Dimension(s) over which to compute the kurtosis

\end{description}

\item[{Returns}] \leavevmode\begin{description}
\item[{\sphinxstylestrong{kurtosis}}] \leavevmode{[}xarray DataArray{]}
New DataArray object with kurtosis applied to its data and the indicated dimension(s) removed

\end{description}

\end{description}\end{quote}
\subsubsection*{Examples}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{arr} \PYG{o}{=} \PYG{n}{xr}\PYG{o}{.}\PYG{n}{DataArray}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{6}\PYG{p}{)}\PYG{o}{.}\PYG{n}{reshape}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{,} \PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{,} 
\PYG{g+gp}{... }                   \PYG{n}{coords}\PYG{o}{=}\PYG{p}{[}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{x}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{a}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{b}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}\PYG{p}{,} \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{y}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{,} \PYG{l+m+mi}{2}\PYG{p}{]}\PYG{p}{)}\PYG{p}{]}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{arr}
\PYG{g+go}{\PYGZlt{}xarray.DataArray (x: 2, y: 3)\PYGZgt{}}
\PYG{g+go}{array([[0, 1, 2],}
\PYG{g+go}{       [3, 4, 5]])}
\PYG{g+go}{Coordinates:}
\PYG{g+go}{  * x        (x) \PYGZlt{}U1 \PYGZsq{}a\PYGZsq{} \PYGZsq{}b\PYGZsq{}}
\PYG{g+go}{  * y        (y) int64 0 1 2}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{doppyo}\PYG{o}{.}\PYG{n}{utils}\PYG{o}{.}\PYG{n}{kurtosis}\PYG{p}{(}\PYG{n}{arr}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{x}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{g+go}{\PYGZlt{}xarray.DataArray (y: 3)\PYGZgt{}}
\PYG{g+go}{array([1., 1., 1.])}
\PYG{g+go}{Coordinates:}
\PYG{g+go}{  * y        (y) int64 0 1 2}
\end{sphinxVerbatim}

\end{fulllineitems}

\index{digitize() (in module utils)@\spxentry{digitize()}\spxextra{in module utils}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{utils_doc:utils.digitize}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{utils.}}\sphinxbfcode{\sphinxupquote{digitize}}}{\emph{da}, \emph{bin\_edges}}{}
Returns the indices of the bins to which each value in input array belongs.

\begin{DUlineblock}{0em}
\item[] Author: Dougie Squire
\item[] Date: 31/10/2018
\end{DUlineblock}
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{description}
\item[{\sphinxstylestrong{da}}] \leavevmode{[}xarray DataArray{]}
Array containing values to digitize

\item[{\sphinxstylestrong{dim}}] \leavevmode{[}array\_like{]}
Array of bin edges. Output indices, i, are such that bin\_edges{[}i-1{]} \textless{}= x \textless{} bin\_edges{[}i{]}

\end{description}

\item[{Returns}] \leavevmode\begin{description}
\item[{\sphinxstylestrong{digitized}}] \leavevmode{[}xarray DataArray{]}
New DataArray object of indices

\end{description}

\end{description}\end{quote}
\subsubsection*{Examples}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{da} \PYG{o}{=} \PYG{n}{xr}\PYG{o}{.}\PYG{n}{DataArray}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{random}\PYG{o}{.}\PYG{n}{normal}\PYG{p}{(}\PYG{n}{size}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{20}\PYG{p}{,}\PYG{l+m+mi}{40}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} \PYG{n}{coords}\PYG{o}{=}\PYG{p}{[}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{x}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{20}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} 
\PYG{g+gp}{... }                                                          \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{y}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{40}\PYG{p}{)}\PYG{p}{)}\PYG{p}{]}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{bins} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{linspace}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{10}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{bin\PYGZus{}edges} \PYG{o}{=} \PYG{n}{doppyo}\PYG{o}{.}\PYG{n}{utils}\PYG{o}{.}\PYG{n}{get\PYGZus{}bin\PYGZus{}edges}\PYG{p}{(}\PYG{n}{bins}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{doppyo}\PYG{o}{.}\PYG{n}{utils}\PYG{o}{.}\PYG{n}{digitize}\PYG{p}{(}\PYG{n}{da}\PYG{p}{,} \PYG{n}{bin\PYGZus{}edges}\PYG{p}{)}
\PYG{g+go}{\PYGZlt{}xarray.DataArray \PYGZsq{}digitized\PYGZsq{} (x: 20, y: 40)\PYGZgt{}}
\PYG{g+go}{array([[ 7,  6,  4, ...,  5,  6,  7],}
\PYG{g+go}{       [ 5, 11,  2, ...,  7,  6,  0],}
\PYG{g+go}{       [ 9,  3,  2, ...,  6,  5,  6],}
\PYG{g+go}{       ...,}
\PYG{g+go}{       [11, 10,  8, ...,  6,  5,  2],}
\PYG{g+go}{       [ 3, 10,  3, ...,  8,  7,  7],}
\PYG{g+go}{       [ 5,  4,  9, ...,  5,  5,  7]])}
\PYG{g+go}{Coordinates:}
\PYG{g+go}{  * x        (x) int64 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19}
\PYG{g+go}{  * y        (y) int64 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 ...}
\end{sphinxVerbatim}

\end{fulllineitems}

\index{pdf() (in module utils)@\spxentry{pdf()}\spxextra{in module utils}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{utils_doc:utils.pdf}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{utils.}}\sphinxbfcode{\sphinxupquote{pdf}}}{\emph{da}, \emph{bin\_edges}, \emph{over\_dims}}{}
Returns the probability distribution function along the specified dimensions

\begin{DUlineblock}{0em}
\item[] Author: Dougie Squire
\item[] Date: 01/10/2018
\end{DUlineblock}
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{description}
\item[{\sphinxstylestrong{da}}] \leavevmode{[}xarray DataArray{]}
Array containing values used to compute the pdf

\item[{\sphinxstylestrong{bin\_edges}}] \leavevmode{[}array\_like{]}
The bin edges, including the rightmost edge

\item[{\sphinxstylestrong{over\_dims}}] \leavevmode{[}str or sequence of str{]}
Dimension(s) over which to compute the pdf

\end{description}

\item[{Returns}] \leavevmode\begin{description}
\item[{\sphinxstylestrong{pdf}}] \leavevmode{[}xarray DataArray{]}
New DataArray object containing pdf

\end{description}

\end{description}\end{quote}
\subsubsection*{Notes}

This function uses \sphinxcode{\sphinxupquote{doppyo.utils.histogram()}} which uses \sphinxcode{\sphinxupquote{xr.groupby\_bins}} when over\_dims is a subset                 of da.dims and is therefore not parallelized in these cases. There are efforts underway to parallelize                 groupby operations in xarray, see \sphinxurl{https://github.com/pydata/xarray/issues/585}
\subsubsection*{Examples}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{da} \PYG{o}{=} \PYG{n}{xr}\PYG{o}{.}\PYG{n}{DataArray}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{random}\PYG{o}{.}\PYG{n}{normal}\PYG{p}{(}\PYG{n}{size}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{100}\PYG{p}{,}\PYG{l+m+mi}{100}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} \PYG{n}{coords}\PYG{o}{=}\PYG{p}{[}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{x}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{100}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{y}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{100}\PYG{p}{)}\PYG{p}{)}\PYG{p}{]}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{bins} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{linspace}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{10}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{bin\PYGZus{}edges} \PYG{o}{=} \PYG{n}{doppyo}\PYG{o}{.}\PYG{n}{utils}\PYG{o}{.}\PYG{n}{get\PYGZus{}bin\PYGZus{}edges}\PYG{p}{(}\PYG{n}{bins}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{doppyo}\PYG{o}{.}\PYG{n}{utils}\PYG{o}{.}\PYG{n}{pdf}\PYG{p}{(}\PYG{n}{da}\PYG{p}{,} \PYG{n}{bin\PYGZus{}edges}\PYG{o}{=}\PYG{n}{bin\PYGZus{}edges}\PYG{p}{,} \PYG{n}{over\PYGZus{}dims}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{x}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{g+go}{\PYGZlt{}xarray.DataArray (bins: 10, y: 100)\PYGZgt{}}
\PYG{g+go}{array([[0.069588, 0.046392, 0.046875, ..., 0.090909, 0.070312, 0.090909],}
\PYG{g+go}{       [0.208763, 0.255155, 0.140625, ..., 0.113636, 0.117187, 0.113636],}
\PYG{g+go}{       [0.278351, 0.115979, 0.304688, ..., 0.25    , 0.234375, 0.227273],}
\PYG{g+go}{       ...,}
\PYG{g+go}{       [0.115979, 0.255155, 0.46875 , ..., 0.25    , 0.210937, 0.136364],}
\PYG{g+go}{       [0.046392, 0.139175, 0.117188, ..., 0.090909, 0.1875  , 0.136364],}
\PYG{g+go}{       [0.046392, 0.069588, 0.046875, ..., 0.022727, 0.070312, 0.068182]])}
\PYG{g+go}{Coordinates:}
\PYG{g+go}{  * bins     (bins) float64 \PYGZhy{}2.0 \PYGZhy{}1.556 \PYGZhy{}1.111 \PYGZhy{}0.6667 \PYGZhy{}0.2222 0.2222 0.6667 ...}
\PYG{g+go}{  * y        (y) int64 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 ...}
\end{sphinxVerbatim}

\end{fulllineitems}

\index{cdf() (in module utils)@\spxentry{cdf()}\spxextra{in module utils}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{utils_doc:utils.cdf}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{utils.}}\sphinxbfcode{\sphinxupquote{cdf}}}{\emph{da}, \emph{bin\_edges}, \emph{over\_dims}}{}
Returns the cumulative probability distribution function along the specified dimensions

\begin{DUlineblock}{0em}
\item[] Author: Dougie Squire
\item[] Date: 01/10/2018
\end{DUlineblock}
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{description}
\item[{\sphinxstylestrong{da}}] \leavevmode{[}xarray DataArray{]}
Array containing values used to compute the cdf

\item[{\sphinxstylestrong{bin\_edges}}] \leavevmode{[}array\_like{]}
The bin edges, including the rightmost edge

\item[{\sphinxstylestrong{over\_dims}}] \leavevmode{[}str or sequence of str{]}
Dimension(s) over which to compute the cdf

\end{description}

\item[{Returns}] \leavevmode\begin{description}
\item[{\sphinxstylestrong{cdf}}] \leavevmode{[}xarray DataArray{]}
New DataArray object containing cdf

\end{description}

\end{description}\end{quote}
\subsubsection*{Notes}

This function uses \sphinxcode{\sphinxupquote{doppyo.utils.histogram()}} which uses \sphinxcode{\sphinxupquote{xr.groupby\_bins}} when over\_dims is a subset                 of da.dims and is therefore not parallelized in these cases. There are efforts underway to parallelize                 groupby operations in xarray, see \sphinxurl{https://github.com/pydata/xarray/issues/585}
\subsubsection*{Examples}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{da} \PYG{o}{=} \PYG{n}{xr}\PYG{o}{.}\PYG{n}{DataArray}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{random}\PYG{o}{.}\PYG{n}{normal}\PYG{p}{(}\PYG{n}{size}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{100}\PYG{p}{,}\PYG{l+m+mi}{100}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} \PYG{n}{coords}\PYG{o}{=}\PYG{p}{[}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{x}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{100}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{y}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{100}\PYG{p}{)}\PYG{p}{)}\PYG{p}{]}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{bins} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{linspace}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{10}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{bin\PYGZus{}edges} \PYG{o}{=} \PYG{n}{doppyo}\PYG{o}{.}\PYG{n}{utils}\PYG{o}{.}\PYG{n}{get\PYGZus{}bin\PYGZus{}edges}\PYG{p}{(}\PYG{n}{bins}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{doppyo}\PYG{o}{.}\PYG{n}{utils}\PYG{o}{.}\PYG{n}{cdf}\PYG{p}{(}\PYG{n}{da}\PYG{p}{,} \PYG{n}{bin\PYGZus{}edges}\PYG{o}{=}\PYG{n}{bin\PYGZus{}edges}\PYG{p}{,} \PYG{n}{over\PYGZus{}dims}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{x}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{g+go}{\PYGZlt{}xarray.DataArray (bins: 10, y: 100)\PYGZgt{}}
\PYG{g+go}{array([[0.050505, 0.      , 0.030612, ..., 0.020202, 0.010204, 0.020619],}
\PYG{g+go}{       [0.121212, 0.085106, 0.081633, ..., 0.080808, 0.081633, 0.061856],}
\PYG{g+go}{       [0.232323, 0.138298, 0.142857, ..., 0.171717, 0.183673, 0.195876],}
\PYG{g+go}{       ...,}
\PYG{g+go}{       [0.939394, 0.925532, 0.908163, ..., 0.909091, 0.94898 , 0.907216],}
\PYG{g+go}{       [0.979798, 0.968085, 0.969388, ..., 0.959596, 0.979592, 0.989691],}
\PYG{g+go}{       [1.      , 1.      , 1.      , ..., 1.      , 1.      , 1.      ]])}
\PYG{g+go}{Coordinates:}
\PYG{g+go}{  * bins     (bins) float64 \PYGZhy{}2.0 \PYGZhy{}1.556 \PYGZhy{}1.111 \PYGZhy{}0.6667 \PYGZhy{}0.2222 0.2222 0.6667 ...}
\PYG{g+go}{  * y        (y) int64 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 ...}
\end{sphinxVerbatim}

\end{fulllineitems}

\index{Gaussian\_pdf() (in module utils)@\spxentry{Gaussian\_pdf()}\spxextra{in module utils}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{utils_doc:utils.Gaussian_pdf}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{utils.}}\sphinxbfcode{\sphinxupquote{Gaussian\_pdf}}}{\emph{x}}{}
Evaluate standard Gaussian pdf at x

\begin{DUlineblock}{0em}
\item[] Author: Dougie Squire
\item[] Date: 26/03/2019
\end{DUlineblock}
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{description}
\item[{\sphinxstylestrong{x}}] \leavevmode{[}array\_like, float{]}
Point(s) at which to evaluate the Gaussian pdf

\end{description}

\item[{Returns}] \leavevmode\begin{description}
\item[{\sphinxstylestrong{p}}] \leavevmode{[}array\_like, float{]}
Same shape as x containing the evaluated pdf values

\end{description}

\end{description}\end{quote}
\subsubsection*{Examples}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{doppyo}\PYG{o}{.}\PYG{n}{utils}\PYG{o}{.}\PYG{n}{gaussian\PYGZus{}pdf}\PYG{p}{(}\PYG{l+m+mf}{0.5}\PYG{p}{)}
\PYG{g+go}{0.3520653267642995}
\end{sphinxVerbatim}

\end{fulllineitems}

\index{Gaussian\_cdf() (in module utils)@\spxentry{Gaussian\_cdf()}\spxextra{in module utils}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{utils_doc:utils.Gaussian_cdf}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{utils.}}\sphinxbfcode{\sphinxupquote{Gaussian\_cdf}}}{\emph{x}, \emph{n=100}}{}
Evaluate standard Gaussian cdf at x (numerical integral over n points)

\begin{DUlineblock}{0em}
\item[] Author: Dougie Squire
\item[] Date: 26/03/2019
\end{DUlineblock}
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{description}
\item[{\sphinxstylestrong{x}}] \leavevmode{[}array\_like, float{]}
Point(s) at which to evaluate the Gaussian cdf

\item[{\sphinxstylestrong{n}}] \leavevmode{[}int, optional{]}
Number of points to use to evaulate the numerical integral

\end{description}

\item[{Returns}] \leavevmode\begin{description}
\item[{\sphinxstylestrong{p}}] \leavevmode{[}xarray DataArray{]}
Same shape as x containing the evaluated cdf values

\end{description}

\end{description}\end{quote}
\subsubsection*{Examples}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{doppyo}\PYG{o}{.}\PYG{n}{utils}\PYG{o}{.}\PYG{n}{gaussian\PYGZus{}cdf}\PYG{p}{(}\PYG{l+m+mf}{0.5}\PYG{p}{)}
\PYG{g+go}{\PYGZlt{}xarray.DataArray \PYGZsq{}integral\PYGZsq{} ()\PYGZgt{}}
\PYG{g+go}{array(0.691462)}
\end{sphinxVerbatim}

\end{fulllineitems}

\index{histogram() (in module utils)@\spxentry{histogram()}\spxextra{in module utils}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{utils_doc:utils.histogram}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{utils.}}\sphinxbfcode{\sphinxupquote{histogram}}}{\emph{da}, \emph{bin\_edges}, \emph{over\_dims}}{}
Returns the histogram over the specified dimensions

\begin{DUlineblock}{0em}
\item[] Author: Dougie Squire
\item[] Date: 01/10/2018
\end{DUlineblock}
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{description}
\item[{\sphinxstylestrong{da}}] \leavevmode{[}xarray DataArray{]}
Array containing values used to compute the histogram

\item[{\sphinxstylestrong{bin\_edges}}] \leavevmode{[}array\_like{]}
The bin edges, including the rightmost edge

\item[{\sphinxstylestrong{over\_dims}}] \leavevmode{[}str or sequence of str{]}
Dimension(s) over which to compute the histogram

\end{description}

\item[{Returns}] \leavevmode\begin{description}
\item[{\sphinxstylestrong{histogram}}] \leavevmode{[}xarray DataArray{]}
New DataArray object containing the histogram

\end{description}

\end{description}\end{quote}


\sphinxstrong{See also:}


\sphinxcode{\sphinxupquote{numpy.histogram}}, \sphinxcode{\sphinxupquote{dask.array.histogram}}


\subsubsection*{Notes}

This function uses \sphinxcode{\sphinxupquote{xr.groupby\_bins}} when over\_dims is a subset of da.dims and is therefore not                 parallelized/lazy in these cases. There are efforts underway to parallelize groupby operations                 in xarray, see \sphinxurl{https://github.com/pydata/xarray/issues/585}
\subsubsection*{Examples}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{da} \PYG{o}{=} \PYG{n}{xr}\PYG{o}{.}\PYG{n}{DataArray}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{random}\PYG{o}{.}\PYG{n}{normal}\PYG{p}{(}\PYG{n}{size}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{100}\PYG{p}{,}\PYG{l+m+mi}{100}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} 
\PYG{g+gp}{... }                  \PYG{n}{coords}\PYG{o}{=}\PYG{p}{[}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{x}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{100}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{y}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{100}\PYG{p}{)}\PYG{p}{)}\PYG{p}{]}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{bins} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{linspace}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{10}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{bin\PYGZus{}edges} \PYG{o}{=} \PYG{n}{doppyo}\PYG{o}{.}\PYG{n}{utils}\PYG{o}{.}\PYG{n}{get\PYGZus{}bin\PYGZus{}edges}\PYG{p}{(}\PYG{n}{bins}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{doppyo}\PYG{o}{.}\PYG{n}{utils}\PYG{o}{.}\PYG{n}{histogram}\PYG{p}{(}\PYG{n}{da}\PYG{p}{,} \PYG{n}{bin\PYGZus{}edges}\PYG{o}{=}\PYG{n}{bin\PYGZus{}edges}\PYG{p}{,} \PYG{n}{over\PYGZus{}dims}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{x}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{g+go}{\PYGZlt{}xarray.DataArray \PYGZsq{}data\PYGZsq{} (bins: 10, y: 100)\PYGZgt{}}
\PYG{g+go}{array([[ 3.,  1.,  6., ...,  2.,  4.,  3.],}
\PYG{g+go}{       [ 2., 12.,  4., ...,  7.,  3.,  7.],}
\PYG{g+go}{       [ 9.,  9., 11., ..., 19., 13.,  6.],}
\PYG{g+go}{       ...,}
\PYG{g+go}{       [13.,  9.,  4., ...,  6.,  6., 11.],}
\PYG{g+go}{       [ 3.,  6.,  3., ...,  3.,  7.,  4.],}
\PYG{g+go}{       [ 2.,  0.,  1., ...,  3.,  3.,  4.]])}
\PYG{g+go}{Coordinates:}
\PYG{g+go}{  * bins     (bins) float64 \PYGZhy{}2.0 \PYGZhy{}1.556 \PYGZhy{}1.111 \PYGZhy{}0.6667 \PYGZhy{}0.2222 0.2222 0.6667 ...}
\PYG{g+go}{  * y        (y) int64 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 ...}
\end{sphinxVerbatim}

\end{fulllineitems}

\index{get\_bin\_edges() (in module utils)@\spxentry{get\_bin\_edges()}\spxextra{in module utils}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{utils_doc:utils.get_bin_edges}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{utils.}}\sphinxbfcode{\sphinxupquote{get\_bin\_edges}}}{\emph{bins}}{}
Returns bin edges of provided bins

\begin{DUlineblock}{0em}
\item[] Author: Dougie Squire
\item[] Date: 06/03/2018
\end{DUlineblock}
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{description}
\item[{\sphinxstylestrong{bins}}] \leavevmode{[}array\_like{]}
One-dimensional array of bin values to compute bin edges

\end{description}

\item[{Returns}] \leavevmode\begin{description}
\item[{\sphinxstylestrong{edges}}] \leavevmode{[}array\_like{]}
Array of bin edges where the first and last edge are computed using the spacing between                     the first-and-second and second-last-and-last bins, respectively. This array is one                    element larger than the input array

\end{description}

\end{description}\end{quote}
\subsubsection*{Examples}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{bins} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{linspace}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{10}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{bin\PYGZus{}edges} \PYG{o}{=} \PYG{n}{doppyo}\PYG{o}{.}\PYG{n}{utils}\PYG{o}{.}\PYG{n}{get\PYGZus{}bin\PYGZus{}edges}\PYG{p}{(}\PYG{n}{bins}\PYG{p}{)}
\PYG{g+go}{array([\PYGZhy{}2.5, \PYGZhy{}1.5, \PYGZhy{}0.5,  0.5,  1.5,  2.5])}
\end{sphinxVerbatim}

\end{fulllineitems}

\index{polyfit() (in module utils)@\spxentry{polyfit()}\spxextra{in module utils}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{utils_doc:utils.polyfit}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{utils.}}\sphinxbfcode{\sphinxupquote{polyfit}}}{\emph{x}, \emph{y}, \emph{order}, \emph{over\_dims}}{}
Returns least squares polynomial fit of the specified order

\begin{DUlineblock}{0em}
\item[] Author: Dougie Squire
\item[] Date: 25/03/2019
\end{DUlineblock}
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{description}
\item[{\sphinxstylestrong{x}}] \leavevmode{[}xarray DataArray{]}
Array containing x-coordinates of the sample points

\item[{\sphinxstylestrong{y}}] \leavevmode{[}xarray DataArray{]}
Array containing y-coordinates of the sample points

\item[{\sphinxstylestrong{over\_dims}}] \leavevmode{[}str or sequence of str, optional{]}
Dimensions over which to compute the fit

\end{description}

\item[{Returns}] \leavevmode\begin{description}
\item[{\sphinxstylestrong{coefficients}}] \leavevmode{[}xarray DataArray{]}
Array containing the coefficients of the fit

\end{description}

\end{description}\end{quote}


\sphinxstrong{See also:}


\sphinxcode{\sphinxupquote{numpy.polyfit}}


\subsubsection*{Examples}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{x} \PYG{o}{=} \PYG{n}{xr}\PYG{o}{.}\PYG{n}{DataArray}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{random}\PYG{o}{.}\PYG{n}{normal}\PYG{p}{(}\PYG{n}{size}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{,}\PYG{l+m+mi}{3}\PYG{p}{,}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} 
\PYG{g+gp}{... }                 \PYG{n}{coords}\PYG{o}{=}\PYG{p}{[}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{x}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{y}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{z}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{]}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{y} \PYG{o}{=} \PYG{n}{xr}\PYG{o}{.}\PYG{n}{DataArray}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{random}\PYG{o}{.}\PYG{n}{normal}\PYG{p}{(}\PYG{n}{size}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{,}\PYG{l+m+mi}{3}\PYG{p}{,}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} 
\PYG{g+gp}{... }                 \PYG{n}{coords}\PYG{o}{=}\PYG{p}{[}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{x}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{y}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{z}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{]}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{doppyo}\PYG{o}{.}\PYG{n}{utils}\PYG{o}{.}\PYG{n}{polyfit}\PYG{p}{(}\PYG{n}{x}\PYG{p}{,} \PYG{n}{y}\PYG{p}{,} \PYG{n}{order}\PYG{o}{=}\PYG{l+m+mi}{2}\PYG{p}{,} \PYG{n}{over\PYGZus{}dims}\PYG{o}{=}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{x}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{y}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}
\PYG{g+go}{\PYGZlt{}xarray.DataArray \PYGZsq{}fit\PYGZsq{} (z: 3, degree: 3)\PYGZgt{}}
\PYG{g+go}{array([[\PYGZhy{}0.17262 ,  0.423925,  0.644511],}
\PYG{g+go}{       [\PYGZhy{}0.217319,  0.033146,  1.139249],}
\PYG{g+go}{       [ 0.520737, \PYGZhy{}0.641632, \PYGZhy{}1.095306]])}
\PYG{g+go}{Coordinates:}
\PYG{g+go}{  * z        (z) int64 0 1 2}
\PYG{g+go}{  * degree   (degree) int64 0 1 2}
\end{sphinxVerbatim}

\end{fulllineitems}

\index{polyval() (in module utils)@\spxentry{polyval()}\spxextra{in module utils}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{utils_doc:utils.polyval}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{utils.}}\sphinxbfcode{\sphinxupquote{polyval}}}{\emph{x}, \emph{p}, \emph{over\_dims}}{}
Evaluate a polynomial at specific values

\begin{DUlineblock}{0em}
\item[] Author: Dougie Squire
\item[] Date: 25/03/2019
\end{DUlineblock}
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{description}
\item[{\sphinxstylestrong{x}}] \leavevmode{[}xarray DataArray{]}
Array containing x-coordinates of the sample points

\item[{\sphinxstylestrong{p}}] \leavevmode{[}xarray DataArray{]}
Array containing the polynomial coefficients

\item[{\sphinxstylestrong{over\_dims}}] \leavevmode{[}str or sequence of str, optional{]}
Dimensions over which to compute the fit. Should match over\_dims handed to polyfit

\end{description}

\item[{Returns}] \leavevmode\begin{description}
\item[{\sphinxstylestrong{fit}}] \leavevmode{[}xarray DataArray{]}
Evaluated polynomial values

\end{description}

\end{description}\end{quote}


\sphinxstrong{See also:}


\sphinxcode{\sphinxupquote{numpy.polyval}}


\subsubsection*{Examples}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{x} \PYG{o}{=} \PYG{n}{xr}\PYG{o}{.}\PYG{n}{DataArray}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{random}\PYG{o}{.}\PYG{n}{normal}\PYG{p}{(}\PYG{n}{size}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{,}\PYG{l+m+mi}{3}\PYG{p}{,}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} 
\PYG{g+gp}{... }                 \PYG{n}{coords}\PYG{o}{=}\PYG{p}{[}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{x}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{y}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{z}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{]}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{y} \PYG{o}{=} \PYG{n}{xr}\PYG{o}{.}\PYG{n}{DataArray}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{random}\PYG{o}{.}\PYG{n}{normal}\PYG{p}{(}\PYG{n}{size}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{,}\PYG{l+m+mi}{3}\PYG{p}{,}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} 
\PYG{g+gp}{... }                 \PYG{n}{coords}\PYG{o}{=}\PYG{p}{[}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{x}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{y}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{z}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{]}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{p} \PYG{o}{=} \PYG{n}{polyfit}\PYG{p}{(}\PYG{n}{x}\PYG{p}{,} \PYG{n}{y}\PYG{p}{,} \PYG{n}{order}\PYG{o}{=}\PYG{l+m+mi}{2}\PYG{p}{,} \PYG{n}{over\PYGZus{}dims}\PYG{o}{=}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{x}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{y}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{xf} \PYG{o}{=} \PYG{n}{xr}\PYG{o}{.}\PYG{n}{DataArray}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{random}\PYG{o}{.}\PYG{n}{normal}\PYG{p}{(}\PYG{n}{size}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{,}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} 
\PYG{g+gp}{... }                  \PYG{n}{coords}\PYG{o}{=}\PYG{p}{[}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{x}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{y}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{]}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{doppyo}\PYG{o}{.}\PYG{n}{utils}\PYG{o}{.}\PYG{n}{polyval}\PYG{p}{(}\PYG{n}{p}\PYG{p}{,} \PYG{n}{xf}\PYG{p}{,} \PYG{n}{over\PYGZus{}dims}\PYG{o}{=}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{x}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{y}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}
\PYG{g+go}{\PYGZlt{}xarray.DataArray (z: 3, x: 3, y: 3)\PYGZgt{}}
\PYG{g+go}{array([[[ 0.680063,  0.687067,  0.37378 ],}
\PYG{g+go}{        [ 0.68157 ,  0.593822,  0.564625],}
\PYG{g+go}{        [ 0.661166,  0.651231,  0.373721]],}
\PYG{g+gp}{...}
\PYG{g+go}{       [[\PYGZhy{}0.526172, \PYGZhy{}0.343878,  1.040153],}
\PYG{g+go}{        [\PYGZhy{}0.310027, \PYGZhy{}0.374777,  0.251314],}
\PYG{g+go}{        [\PYGZhy{}0.197566, \PYGZhy{}0.488106,  1.04039 ]],}
\PYG{g+gp}{...}
\PYG{g+go}{       [[ 1.009727, \PYGZhy{}0.11369 ,  0.517851],}
\PYG{g+go}{        [\PYGZhy{}0.152397,  2.377984, \PYGZhy{}0.149194],}
\PYG{g+go}{        [\PYGZhy{}0.227379,  1.532419,  0.518102]]])}
\PYG{g+go}{Coordinates:}
\PYG{g+go}{  * z        (z) int64 0 1 2}
\PYG{g+go}{  * x        (x) int64 0 1 2}
\PYG{g+go}{  * y        (y) int64 0 1 2}
\end{sphinxVerbatim}

\end{fulllineitems}

\index{differentiate\_wrt() (in module utils)@\spxentry{differentiate\_wrt()}\spxextra{in module utils}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{utils_doc:utils.differentiate_wrt}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{utils.}}\sphinxbfcode{\sphinxupquote{differentiate\_wrt}}}{\emph{da}, \emph{dim}, \emph{x}}{}
Returns the gradient along dim using x to compute differences. This function is required                 because the current implementation of xr.differentiate (0.10.9) can only differentiate with                 respect to a 1D coordinate. It is common to want to differentiate with respect to something                 that changes as a function of multiple dimensions (e.g. the zonal distance between regularly                 spaced lat/lon points varies as a function of lat and lon). Uses second order accurate central                 differencing in the interior points and first order accurate one-sided (forward or backwards)                 differencing at the boundaries.

\begin{DUlineblock}{0em}
\item[] Author: Dougie Squire
\item[] Date: 02/11/2018
\end{DUlineblock}
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{description}
\item[{\sphinxstylestrong{da}}] \leavevmode{[}xarray DataArray{]}
Array containing values to differentiate

\item[{\sphinxstylestrong{dim}}] \leavevmode{[}str{]}
The dimension to be used to compute the gradient

\item[{\sphinxstylestrong{x}}] \leavevmode{[}xarray DataArray{]}
Array containing values to differentiate with respect to. Must be broadcastable with da

\end{description}

\item[{Returns}] \leavevmode\begin{description}
\item[{\sphinxstylestrong{differentiated}}] \leavevmode{[}xarray DataArray{]}
New DataArray object containing the differentiate data

\end{description}

\end{description}\end{quote}


\sphinxstrong{See also:}


\sphinxcode{\sphinxupquote{xarray.DataArray.differentiate}}, \sphinxcode{\sphinxupquote{numpy.gradient}}


\subsubsection*{Examples}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{A} \PYG{o}{=} \PYG{n}{xr}\PYG{o}{.}\PYG{n}{DataArray}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{random}\PYG{o}{.}\PYG{n}{normal}\PYG{p}{(}\PYG{n}{size}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{180}\PYG{p}{,}\PYG{l+m+mi}{360}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} \PYG{n}{coords}\PYG{o}{=}\PYG{p}{[}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{lat}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{90}\PYG{p}{,}\PYG{l+m+mi}{90}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{lon}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{l+m+mi}{360}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{)}\PYG{p}{]}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{x}\PYG{p}{,} \PYG{n}{y} \PYG{o}{=} \PYG{n}{doppyo}\PYG{o}{.}\PYG{n}{utils}\PYG{o}{.}\PYG{n}{xy\PYGZus{}from\PYGZus{}lonlat}\PYG{p}{(}\PYG{n}{A}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{lon}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{,} \PYG{n}{A}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{lat}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{differentiate\PYGZus{}wrt}\PYG{p}{(}\PYG{n}{A}\PYG{p}{,} \PYG{n}{dim}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{lon}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{x}\PYG{o}{=}\PYG{n}{x}\PYG{p}{)}
\PYG{g+go}{\PYGZlt{}xarray.DataArray \PYGZsq{}differentiated\PYGZsq{} (lat: 180, lon: 360)\PYGZgt{}}
\PYG{g+go}{array([[ 3.674336e+10, \PYGZhy{}9.015981e+10, \PYGZhy{}2.150203e+11, ..., \PYGZhy{}6.471076e+10,}
\PYG{g+go}{        \PYGZhy{}6.057067e+09,  1.253664e+11],}
\PYG{g+go}{       [\PYGZhy{}4.133347e\PYGZhy{}07, \PYGZhy{}3.932972e\PYGZhy{}04, \PYGZhy{}5.982892e\PYGZhy{}04, ...,  2.972605e\PYGZhy{}04,}
\PYG{g+go}{         9.456351e\PYGZhy{}04,  1.907131e\PYGZhy{}03],}
\PYG{g+go}{       [\PYGZhy{}6.596434e\PYGZhy{}04,  6.147016e\PYGZhy{}06,  2.370071e\PYGZhy{}04, ..., \PYGZhy{}8.578490e\PYGZhy{}06,}
\PYG{g+go}{         9.281731e\PYGZhy{}06,  2.211755e\PYGZhy{}04],}
\PYG{g+go}{       ...,}
\PYG{g+go}{       [\PYGZhy{}6.467389e\PYGZhy{}05,  6.315746e\PYGZhy{}05,  1.713705e\PYGZhy{}04, ...,  9.742767e\PYGZhy{}05,}
\PYG{g+go}{         1.043358e\PYGZhy{}04,  1.066228e\PYGZhy{}04],}
\PYG{g+go}{       [ 1.542484e\PYGZhy{}04,  2.802838e\PYGZhy{}04,  5.511727e\PYGZhy{}05, ...,  1.665500e\PYGZhy{}04,}
\PYG{g+go}{        \PYGZhy{}6.087167e\PYGZhy{}06, \PYGZhy{}3.060961e\PYGZhy{}04],}
\PYG{g+go}{       [\PYGZhy{}5.991109e\PYGZhy{}04,  2.085148e\PYGZhy{}04,  4.525132e\PYGZhy{}04, ..., \PYGZhy{}9.346556e\PYGZhy{}05,}
\PYG{g+go}{        \PYGZhy{}7.977593e\PYGZhy{}05,  3.411080e\PYGZhy{}05]])}
\PYG{g+go}{Coordinates:}
\PYG{g+go}{  * lat      (lat) int64 \PYGZhy{}90 \PYGZhy{}89 \PYGZhy{}88 \PYGZhy{}87 \PYGZhy{}86 \PYGZhy{}85 \PYGZhy{}84 ... 83 84 85 86 87 88 89}
\PYG{g+go}{  * lon      (lon) int64 0 1 2 3 4 5 6 7 8 ... 352 353 354 355 356 357 358 359}
\end{sphinxVerbatim}

\end{fulllineitems}

\index{xy\_from\_lonlat() (in module utils)@\spxentry{xy\_from\_lonlat()}\spxextra{in module utils}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{utils_doc:utils.xy_from_lonlat}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{utils.}}\sphinxbfcode{\sphinxupquote{xy\_from\_lonlat}}}{\emph{lon}, \emph{lat}}{}
Returns x/y in m from grid points that are in a longitude/latitude format.

\begin{DUlineblock}{0em}
\item[] Author: Dougie Squire
\item[] Date: 01/11/2018
\end{DUlineblock}
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{description}
\item[{\sphinxstylestrong{lon}}] \leavevmode{[}xarray DataArray{]}
Array containing longitudes stored relative to longitude dimension/coordinate

\item[{\sphinxstylestrong{lat}}] \leavevmode{[}xarray DataArray{]}
Array containing latitudes stored relative to latitude dimension/coordinate

\end{description}

\item[{Returns}] \leavevmode\begin{description}
\item[{\sphinxstylestrong{x}}] \leavevmode{[}xarray DataArray{]}
Array containing zonal distance in m

\item[{\sphinxstylestrong{y}}] \leavevmode{[}xarray DataArray{]}
Array containing meridional distance in m

\end{description}

\end{description}\end{quote}
\subsubsection*{Examples}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{lat} \PYG{o}{=} \PYG{n}{xr}\PYG{o}{.}\PYG{n}{DataArray}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{90}\PYG{p}{,}\PYG{l+m+mi}{90}\PYG{p}{,}\PYG{l+m+mi}{90}\PYG{p}{)}\PYG{p}{,} \PYG{n}{dims}\PYG{o}{=}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{lat}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{lon} \PYG{o}{=} \PYG{n}{xr}\PYG{o}{.}\PYG{n}{DataArray}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{l+m+mi}{360}\PYG{p}{,}\PYG{l+m+mi}{90}\PYG{p}{)}\PYG{p}{,} \PYG{n}{dims}\PYG{o}{=}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{lon}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{doppyo}\PYG{o}{.}\PYG{n}{utils}\PYG{o}{.}\PYG{n}{xy\PYGZus{}from\PYGZus{}lonlat}\PYG{p}{(}\PYG{n}{lon}\PYG{o}{=}\PYG{n}{lon}\PYG{p}{,} \PYG{n}{lat}\PYG{o}{=}\PYG{n}{lat}\PYG{p}{)}
\PYG{g+go}{(\PYGZlt{}xarray.DataArray (lat: 2, lon: 4)\PYGZgt{}}
\PYG{g+go}{ array([[0.000000e+00, 6.127853e\PYGZhy{}10, 1.225571e\PYGZhy{}09, 1.838356e\PYGZhy{}09],}
\PYG{g+go}{        [0.000000e+00, 1.000754e+07, 2.001509e+07, 3.002263e+07]])}
\PYG{g+go}{ Dimensions without coordinates: lat, lon, \PYGZlt{}xarray.DataArray (lat: 2, lon: 4)\PYGZgt{}}
\PYG{g+go}{ array([[\PYGZhy{}10007543.39801, \PYGZhy{}10007543.39801, \PYGZhy{}10007543.39801, \PYGZhy{}10007543.39801],}
\PYG{g+go}{        [        0.     ,         0.     ,         0.     ,         0.     ]])}
\PYG{g+go}{ Dimensions without coordinates: lat, lon)}
\end{sphinxVerbatim}

\end{fulllineitems}

\index{integrate() (in module utils)@\spxentry{integrate()}\spxextra{in module utils}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{utils_doc:utils.integrate}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{utils.}}\sphinxbfcode{\sphinxupquote{integrate}}}{\emph{da}, \emph{over\_dim}, \emph{x=None}, \emph{dx=None}, \emph{method='trapz'}, \emph{cumulative=False}, \emph{skipna=False}}{}
Returns trapezoidal/rectangular integration along specified dimension

\begin{DUlineblock}{0em}
\item[] Author: Dougie Squire
\item[] Date: 16/08/2018
\end{DUlineblock}
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{description}
\item[{\sphinxstylestrong{da}}] \leavevmode{[}xarray DataArray{]}
Array containing values to integrate

\item[{\sphinxstylestrong{over\_dim}}] \leavevmode{[}str{]}
Dimension to integrate

\item[{\sphinxstylestrong{x}}] \leavevmode{[}xarray DataArray, optional{]}
Values to use for integrand. Must contain dimensions over\_dim. If None, x is determined                    from the coords associated with over\_dim

\item[{\sphinxstylestrong{dx}}] \leavevmode{[}value, optional{]}
Integrand spacing used to compute the integral. If None, dx is determined from x

\item[{\sphinxstylestrong{method}}] \leavevmode{[}str, optional{]}
Method of performing integral. Options are ‘trapz’ for trapezoidal integration, or ‘rect’                    for rectangular integration

\item[{\sphinxstylestrong{cumulative}}] \leavevmode{[}bool, optional{]}
If True, return the cumulative integral

\end{description}

\item[{Returns}] \leavevmode\begin{description}
\item[{\sphinxstylestrong{integral}}] \leavevmode{[}xarray DataArray{]}
Array containing the integral along the specified dimension

\end{description}

\end{description}\end{quote}


\sphinxstrong{See also:}


\sphinxcode{\sphinxupquote{numpy.trapz}}


\subsubsection*{Examples}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{A} \PYG{o}{=} \PYG{n}{xr}\PYG{o}{.}\PYG{n}{DataArray}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{random}\PYG{o}{.}\PYG{n}{normal}\PYG{p}{(}\PYG{n}{size}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} \PYG{n}{coords}\PYG{o}{=}\PYG{p}{[}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{x}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} 
\PYG{g+gp}{... }                                                       \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{y}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{)}\PYG{p}{]}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{doppyo}\PYG{o}{.}\PYG{n}{utils}\PYG{o}{.}\PYG{n}{integrate}\PYG{p}{(}\PYG{n}{A}\PYG{p}{,} \PYG{n}{over\PYGZus{}dim}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{x}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{g+go}{\PYGZlt{}xarray.DataArray \PYGZsq{}integral\PYGZsq{} (y: 2)\PYGZgt{}}
\PYG{g+go}{array([\PYGZhy{}0.20331 , \PYGZhy{}0.781251])}
\PYG{g+go}{Coordinates:}
\PYG{g+go}{  * y        (y) int64 0 1}
\end{sphinxVerbatim}

\end{fulllineitems}

\index{add() (in module utils)@\spxentry{add()}\spxextra{in module utils}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{utils_doc:utils.add}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{utils.}}\sphinxbfcode{\sphinxupquote{add}}}{\emph{data\_1}, \emph{data\_2}}{}
Returns the addition of two arrays, data\_1 + data\_2. Useful for xr.apply type operations

\begin{DUlineblock}{0em}
\item[] Author: Dougie Squire
\item[] Date: 27/06/2018
\end{DUlineblock}
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{description}
\item[{\sphinxstylestrong{data\_1}}] \leavevmode{[}array\_like{]}
The first array

\item[{\sphinxstylestrong{data\_2}}] \leavevmode{[}array\_like{]}
The second array

\end{description}

\item[{Returns}] \leavevmode\begin{description}
\item[{\sphinxstylestrong{addition}}] \leavevmode{[}array\_like{]}
The addition of data\_1 and data\_2

\end{description}

\end{description}\end{quote}
\subsubsection*{Examples}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{A} \PYG{o}{=} \PYG{n}{xr}\PYG{o}{.}\PYG{n}{DataArray}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{random}\PYG{o}{.}\PYG{n}{normal}\PYG{p}{(}\PYG{n}{size}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} \PYG{n}{coords}\PYG{o}{=}\PYG{p}{[}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{x}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{y}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{)}\PYG{p}{]}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{B} \PYG{o}{=} \PYG{n}{xr}\PYG{o}{.}\PYG{n}{DataArray}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{random}\PYG{o}{.}\PYG{n}{normal}\PYG{p}{(}\PYG{n}{size}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} \PYG{n}{coords}\PYG{o}{=}\PYG{p}{[}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{x}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{y}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{)}\PYG{p}{]}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{doppyo}\PYG{o}{.}\PYG{n}{utils}\PYG{o}{.}\PYG{n}{add}\PYG{p}{(}\PYG{n}{A}\PYG{p}{,}\PYG{n}{B}\PYG{p}{)}
\PYG{g+go}{\PYGZlt{}xarray.DataArray (x: 3, y: 2)\PYGZgt{}}
\PYG{g+go}{array([[\PYGZhy{}0.333176,  0.344428],}
\PYG{g+go}{       [ 0.629463,  0.515872],}
\PYG{g+go}{       [ 1.121926,  0.567797]])}
\PYG{g+go}{Coordinates:}
\PYG{g+go}{  * x        (x) int64 0 1 2}
\PYG{g+go}{  * y        (y) int64 0 1}
\end{sphinxVerbatim}

\end{fulllineitems}

\index{subtract() (in module utils)@\spxentry{subtract()}\spxextra{in module utils}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{utils_doc:utils.subtract}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{utils.}}\sphinxbfcode{\sphinxupquote{subtract}}}{\emph{data\_1}, \emph{data\_2}}{}
Returns the difference of two arrays, data\_1 - data\_2. Useful for xr.apply type operations

\begin{DUlineblock}{0em}
\item[] Author: Dougie Squire
\item[] Date: 27/06/2018
\end{DUlineblock}
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{description}
\item[{\sphinxstylestrong{data\_1}}] \leavevmode{[}array\_like{]}
The first array

\item[{\sphinxstylestrong{data\_2}}] \leavevmode{[}array\_like{]}
The second array

\end{description}

\item[{Returns}] \leavevmode\begin{description}
\item[{\sphinxstylestrong{subtraction}}] \leavevmode{[}array\_like{]}
The difference between data\_1 and data\_2

\end{description}

\end{description}\end{quote}
\subsubsection*{Examples}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{A} \PYG{o}{=} \PYG{n}{xr}\PYG{o}{.}\PYG{n}{DataArray}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{random}\PYG{o}{.}\PYG{n}{normal}\PYG{p}{(}\PYG{n}{size}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} \PYG{n}{coords}\PYG{o}{=}\PYG{p}{[}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{x}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{y}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{)}\PYG{p}{]}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{B} \PYG{o}{=} \PYG{n}{xr}\PYG{o}{.}\PYG{n}{DataArray}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{random}\PYG{o}{.}\PYG{n}{normal}\PYG{p}{(}\PYG{n}{size}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} \PYG{n}{coords}\PYG{o}{=}\PYG{p}{[}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{x}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{y}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{)}\PYG{p}{]}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{doppyo}\PYG{o}{.}\PYG{n}{utils}\PYG{o}{.}\PYG{n}{subtract}\PYG{p}{(}\PYG{n}{A}\PYG{p}{,}\PYG{n}{B}\PYG{p}{)}
\PYG{g+go}{\PYGZlt{}xarray.DataArray (x: 3, y: 2)\PYGZgt{}}
\PYG{g+go}{array([[\PYGZhy{}0.265376,  1.331496],}
\PYG{g+go}{       [ 1.065077, \PYGZhy{}1.278974],}
\PYG{g+go}{       [ 3.691209, \PYGZhy{}1.928883]])}
\PYG{g+go}{Coordinates:}
\PYG{g+go}{  * x        (x) int64 0 1 2}
\PYG{g+go}{  * y        (y) int64 0 1}
\end{sphinxVerbatim}

\end{fulllineitems}

\index{multiply() (in module utils)@\spxentry{multiply()}\spxextra{in module utils}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{utils_doc:utils.multiply}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{utils.}}\sphinxbfcode{\sphinxupquote{multiply}}}{\emph{data\_1}, \emph{data\_2}}{}
Returns the multiplication of two fields, data\_1 * data\_2. Useful for xr.apply type operations

\begin{DUlineblock}{0em}
\item[] Author: Dougie Squire
\item[] Date: 27/06/2018
\end{DUlineblock}
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{description}
\item[{\sphinxstylestrong{data\_1}}] \leavevmode{[}array\_like{]}
The first array

\item[{\sphinxstylestrong{data\_2}}] \leavevmode{[}array\_like{]}
The second array

\end{description}

\item[{Returns}] \leavevmode\begin{description}
\item[{\sphinxstylestrong{multiplication}}] \leavevmode{[}array\_like{]}
The multiplication of data\_1 and data\_2

\end{description}

\end{description}\end{quote}
\subsubsection*{Examples}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{A} \PYG{o}{=} \PYG{n}{xr}\PYG{o}{.}\PYG{n}{DataArray}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{random}\PYG{o}{.}\PYG{n}{normal}\PYG{p}{(}\PYG{n}{size}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} \PYG{n}{coords}\PYG{o}{=}\PYG{p}{[}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{x}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{y}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{)}\PYG{p}{]}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{B} \PYG{o}{=} \PYG{n}{xr}\PYG{o}{.}\PYG{n}{DataArray}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{random}\PYG{o}{.}\PYG{n}{normal}\PYG{p}{(}\PYG{n}{size}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} \PYG{n}{coords}\PYG{o}{=}\PYG{p}{[}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{x}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{y}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{)}\PYG{p}{]}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{doppyo}\PYG{o}{.}\PYG{n}{utils}\PYG{o}{.}\PYG{n}{multiply}\PYG{p}{(}\PYG{n}{A}\PYG{p}{,}\PYG{n}{B}\PYG{p}{)}
\PYG{g+go}{\PYGZlt{}xarray.DataArray (x: 3, y: 2)\PYGZgt{}}
\PYG{g+go}{array([[\PYGZhy{}0.219773,  0.235889],}
\PYG{g+go}{       [\PYGZhy{}0.529542, \PYGZhy{}1.30342 ],}
\PYG{g+go}{       [\PYGZhy{}1.048924,  0.20482 ]])}
\PYG{g+go}{Coordinates:}
\PYG{g+go}{  * x        (x) int64 0 1 2}
\PYG{g+go}{  * y        (y) int64 0 1}
\end{sphinxVerbatim}

\end{fulllineitems}

\index{divide() (in module utils)@\spxentry{divide()}\spxextra{in module utils}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{utils_doc:utils.divide}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{utils.}}\sphinxbfcode{\sphinxupquote{divide}}}{\emph{data\_1}, \emph{data\_2}}{}
Returns the division of two fields, data\_1 / data\_2. Useful for xr.apply type operations

\begin{DUlineblock}{0em}
\item[] Author: Dougie Squire
\item[] Date: 27/06/2018
\end{DUlineblock}
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{description}
\item[{\sphinxstylestrong{data\_1}}] \leavevmode{[}array\_like{]}
The first array

\item[{\sphinxstylestrong{data\_2}}] \leavevmode{[}array\_like{]}
The second array

\end{description}

\item[{Returns}] \leavevmode\begin{description}
\item[{\sphinxstylestrong{division}}] \leavevmode{[}array\_like{]}
The division of data\_1 by data\_2

\end{description}

\end{description}\end{quote}
\subsubsection*{Examples}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{A} \PYG{o}{=} \PYG{n}{xr}\PYG{o}{.}\PYG{n}{DataArray}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{random}\PYG{o}{.}\PYG{n}{normal}\PYG{p}{(}\PYG{n}{size}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} \PYG{n}{coords}\PYG{o}{=}\PYG{p}{[}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{x}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{y}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{)}\PYG{p}{]}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{B} \PYG{o}{=} \PYG{n}{xr}\PYG{o}{.}\PYG{n}{DataArray}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{random}\PYG{o}{.}\PYG{n}{normal}\PYG{p}{(}\PYG{n}{size}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} \PYG{n}{coords}\PYG{o}{=}\PYG{p}{[}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{x}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{y}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{)}\PYG{p}{]}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{doppyo}\PYG{o}{.}\PYG{n}{utils}\PYG{o}{.}\PYG{n}{divide}\PYG{p}{(}\PYG{n}{A}\PYG{p}{,}\PYG{n}{B}\PYG{p}{)}
\PYG{g+go}{\PYGZlt{}xarray.DataArray (x: 3, y: 2)\PYGZgt{}}
\PYG{g+go}{array([[\PYGZhy{}0.310139,  0.071369],}
\PYG{g+go}{       [\PYGZhy{}0.647227, \PYGZhy{}0.427525],}
\PYG{g+go}{       [\PYGZhy{}0.179623,  1.229811]])}
\PYG{g+go}{Coordinates:}
\PYG{g+go}{  * x        (x) int64 0 1 2}
\PYG{g+go}{  * y        (y) int64 0 1}
\end{sphinxVerbatim}

\end{fulllineitems}

\index{average() (in module utils)@\spxentry{average()}\spxextra{in module utils}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{utils_doc:utils.average}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{utils.}}\sphinxbfcode{\sphinxupquote{average}}}{\emph{da}, \emph{dim=None}, \emph{weights=None}}{}
Returns the weighted average

\begin{DUlineblock}{0em}
\item[] Author: Dougie Squire
\item[] Date: 06/08/2018
\end{DUlineblock}
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{description}
\item[{\sphinxstylestrong{da}}] \leavevmode{[}xarray DataArray{]}
Array to be averaged

\item[{\sphinxstylestrong{dim}}] \leavevmode{[}str or sequence of str, optional{]}
Dimension(s) over which to compute weighted average. If None, average is computed over all                    dimensions

\item[{\sphinxstylestrong{weights}}] \leavevmode{[}xarray DataArray, optional{]}
Weights to apply during averaging. Shape of weights must be broadcastable to shape of da.                    If None, unity weighting is applied

\end{description}

\item[{Returns}] \leavevmode\begin{description}
\item[{\sphinxstylestrong{weighted}}] \leavevmode{[}xarray DataArray{]}
Weighted average of input array along specified dimensions

\end{description}

\end{description}\end{quote}
\subsubsection*{Examples}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{A} \PYG{o}{=} \PYG{n}{xr}\PYG{o}{.}\PYG{n}{DataArray}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{random}\PYG{o}{.}\PYG{n}{normal}\PYG{p}{(}\PYG{n}{size}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{4}\PYG{p}{,}\PYG{l+m+mi}{4}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} \PYG{n}{coords}\PYG{o}{=}\PYG{p}{[}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{lat}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{90}\PYG{p}{,}\PYG{l+m+mi}{90}\PYG{p}{,}\PYG{l+m+mi}{45}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} 
\PYG{g+gp}{... }                                                       \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{lon}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{l+m+mi}{360}\PYG{p}{,}\PYG{l+m+mi}{90}\PYG{p}{)}\PYG{p}{)}\PYG{p}{]}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{degtorad} \PYG{o}{=} \PYG{n}{doppyo}\PYG{o}{.}\PYG{n}{utils}\PYG{o}{.}\PYG{n}{constants}\PYG{p}{(}\PYG{p}{)}\PYG{o}{.}\PYG{n}{pi} \PYG{o}{/} \PYG{l+m+mi}{180}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{cos\PYGZus{}lat} \PYG{o}{=} \PYG{n}{xr}\PYG{o}{.}\PYG{n}{ufuncs}\PYG{o}{.}\PYG{n}{cos}\PYG{p}{(}\PYG{n}{A}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{lat}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{*} \PYG{n}{degtorad}\PYG{p}{)} 
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{doppyo}\PYG{o}{.}\PYG{n}{utils}\PYG{o}{.}\PYG{n}{average}\PYG{p}{(}\PYG{n}{A}\PYG{p}{,} \PYG{n}{dim}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{lat}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{weights}\PYG{o}{=}\PYG{n}{cos\PYGZus{}lat}\PYG{p}{)}
\PYG{g+go}{\PYGZlt{}xarray.DataArray (lon: 4)\PYGZgt{}}
\PYG{g+go}{array([\PYGZhy{}0.473632, \PYGZhy{}0.241208, \PYGZhy{}0.954826,  0.498559])}
\PYG{g+go}{Coordinates:}
\PYG{g+go}{  * lon      (lon) int64 0 90 180 270}
\end{sphinxVerbatim}

\end{fulllineitems}

\index{fft() (in module utils)@\spxentry{fft()}\spxextra{in module utils}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{utils_doc:utils.fft}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{utils.}}\sphinxbfcode{\sphinxupquote{fft}}}{\emph{da}, \emph{dim}, \emph{nfft=None}, \emph{dx=None}, \emph{twosided=False}, \emph{shift=True}}{}
Returns the sequentual ffts of the provided array along the specified dimensions

\begin{DUlineblock}{0em}
\item[] Author: Dougie Squire
\item[] Date: 06/08/2018
\end{DUlineblock}
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{description}
\item[{\sphinxstylestrong{da}}] \leavevmode{[}xarray.DataArray{]}
Array from which compute the fft

\item[{\sphinxstylestrong{dim}}] \leavevmode{[}str or sequence{]}
Dimensions along which to compute the fft

\item[{\sphinxstylestrong{nfft}}] \leavevmode{[}float or sequence, optional{]}
Number of points in each dimensions to use in the transformation. If None, the full length                    of each dimension is used.

\item[{\sphinxstylestrong{dx}}] \leavevmode{[}float or sequence, optional{]}
Define the spacing of the dimensions. If None, the spacing is computed directly from the                     coordinates associated with the dimensions. If dx is a time array, frequencies are computed                     in Hz

\item[{\sphinxstylestrong{twosided}}] \leavevmode{[}bool, optional{]}
When the DFT is computed for purely real input, the output is Hermitian-symmetric,                     meaning the negative frequency terms are just the complex conjugates of the corresponding                     positive-frequency terms, and the negative-frequency terms are therefore redundant.                    If True, force the fft to include negative and positive frequencies, even if the input                     data is real. If the input array is complex, one must set twosided=True

\item[{\sphinxstylestrong{shift}}] \leavevmode{[}bool, optional{]}
If True, the frequency axes are shifted to center the 0 frequency, otherwise negative                     frequencies follow positive frequencies as in \sphinxcode{\sphinxupquote{numpy.fft.ftt}}

\end{description}

\item[{Returns}] \leavevmode\begin{description}
\item[{\sphinxstylestrong{fft}}] \leavevmode{[}xarray DataArray{]}
Array containing the sequentual ffts of the provided array along the specified dimensions

\end{description}

\end{description}\end{quote}


\sphinxstrong{See also:}


\sphinxcode{\sphinxupquote{dask.array.fft}}, \sphinxcode{\sphinxupquote{numpy.fft}}


\subsubsection*{Notes}

A real fft is performed over the first dimension, which is faster. The transforms over the                 remaining dimensions are then computed with the classic fft.
\subsubsection*{Examples}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{A} \PYG{o}{=} \PYG{n}{xr}\PYG{o}{.}\PYG{n}{DataArray}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{random}\PYG{o}{.}\PYG{n}{normal}\PYG{p}{(}\PYG{n}{size}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{4}\PYG{p}{,}\PYG{l+m+mi}{4}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} 
\PYG{g+gp}{... }                 \PYG{n}{coords}\PYG{o}{=}\PYG{p}{[}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{lat}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{90}\PYG{p}{,}\PYG{l+m+mi}{90}\PYG{p}{,}\PYG{l+m+mi}{45}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} 
\PYG{g+gp}{... }                         \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{time}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{pd}\PYG{o}{.}\PYG{n}{date\PYGZus{}range}\PYG{p}{(}\PYG{n}{start}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{1/1/2018}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{periods}\PYG{o}{=}\PYG{l+m+mi}{4}\PYG{p}{,} \PYG{n}{freq}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{D}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{p}{)}\PYG{p}{]}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{doppyo}\PYG{o}{.}\PYG{n}{utils}\PYG{o}{.}\PYG{n}{fft}\PYG{p}{(}\PYG{n}{A}\PYG{p}{,} \PYG{n}{dim}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{time}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{twosided}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{,} \PYG{n}{shift}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{)}
\PYG{g+go}{\PYGZlt{}xarray.DataArray \PYGZsq{}fft\PYGZsq{} (lat: 4, f\PYGZus{}time: 4)\PYGZgt{}}
\PYG{g+go}{array([[ 2.996572+0.j      , \PYGZhy{}2.833156\PYGZhy{}0.676355j, \PYGZhy{}0.038218+0.j      ,}
\PYG{g+go}{        \PYGZhy{}2.833156+0.676355j],}
\PYG{g+go}{       [\PYGZhy{}0.66788 +0.j      ,  0.551732\PYGZhy{}3.406326j,  2.003329+0.j      ,}
\PYG{g+go}{         0.551732+3.406326j],}
\PYG{g+go}{       [ 2.032978+0.j      ,  0.657454+1.703941j,  2.085695+0.j      ,}
\PYG{g+go}{         0.657454\PYGZhy{}1.703941j],}
\PYG{g+go}{       [ 0.462405+0.j      , \PYGZhy{}0.815011+2.357146j, \PYGZhy{}1.257371+0.j      ,}
\PYG{g+go}{        \PYGZhy{}0.815011\PYGZhy{}2.357146j]])}
\PYG{g+go}{Coordinates:}
\PYG{g+go}{  * lat      (lat) int64 \PYGZhy{}90 \PYGZhy{}45 0 45}
\PYG{g+go}{  * f\PYGZus{}time   (f\PYGZus{}time) float64 \PYGZhy{}5.787e\PYGZhy{}06 \PYGZhy{}2.894e\PYGZhy{}06 0.0 2.894e\PYGZhy{}06}
\end{sphinxVerbatim}

\end{fulllineitems}

\index{ifft() (in module utils)@\spxentry{ifft()}\spxextra{in module utils}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{utils_doc:utils.ifft}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{utils.}}\sphinxbfcode{\sphinxupquote{ifft}}}{\emph{da}, \emph{dim}, \emph{nifft=None}, \emph{shifted=True}}{}
Returns the sequentual iffts of the provided array along the specified dimensions. Note, it is                 not possible to reconstruct the  dimension along which the fft was performed (r\_dim) from                 knowledge only of the fft “frequencies” (f\_dim). For example, time cannot be reconstructed from                 frequency. Here, r\_dim is defined relative to 0 in steps of dx as determined from f\_dim. It may                 be necessary for the user to use the original (pre-fft) dimension to redefine r\_dim after the                ifft is performed (see the Examples s ection of this docstring).

\begin{DUlineblock}{0em}
\item[] Author: Dougie Squire
\item[] Date: 06/08/2018
\end{DUlineblock}
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{description}
\item[{\sphinxstylestrong{da}}] \leavevmode{[}xarray.DataArray{]}
Array from which compute the ifft

\item[{\sphinxstylestrong{dim}}] \leavevmode{[}str or sequence{]}
Dimensions along which to compute the ifft

\item[{\sphinxstylestrong{nifft}}] \leavevmode{[}float or sequence, optional{]}
Number of points in each dimensions to use in the transformation. If None, the full length                    of each dimension is used.

\item[{\sphinxstylestrong{shifted}}] \leavevmode{[}bool, optional{]}
If True, assumes that the input dimensions are shifted to center the 0 frequency, otherwise                     assumes negative frequencies follow positive frequencies as in \sphinxcode{\sphinxupquote{numpy.fft.ftt}}

\end{description}

\item[{Returns}] \leavevmode\begin{description}
\item[{\sphinxstylestrong{ifft}}] \leavevmode{[}xarray DataArray{]}
Array containing the sequentual iffts of the provided array along the specified dimensions

\end{description}

\end{description}\end{quote}


\sphinxstrong{See also:}


\sphinxcode{\sphinxupquote{dask.array.ifft}}, \sphinxcode{\sphinxupquote{numpy.ifft}}


\subsubsection*{Examples}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{A} \PYG{o}{=} \PYG{n}{xr}\PYG{o}{.}\PYG{n}{DataArray}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{random}\PYG{o}{.}\PYG{n}{normal}\PYG{p}{(}\PYG{n}{size}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{4}\PYG{p}{,}\PYG{l+m+mi}{4}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} 
\PYG{g+gp}{... }                 \PYG{n}{coords}\PYG{o}{=}\PYG{p}{[}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{lat}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{90}\PYG{p}{,}\PYG{l+m+mi}{90}\PYG{p}{,}\PYG{l+m+mi}{45}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} 
\PYG{g+gp}{... }                 \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{time}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{pd}\PYG{o}{.}\PYG{n}{date\PYGZus{}range}\PYG{p}{(}\PYG{n}{start}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{1/1/2018}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{periods}\PYG{o}{=}\PYG{l+m+mi}{4}\PYG{p}{,} \PYG{n}{freq}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{D}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{p}{)}\PYG{p}{]}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{A\PYGZus{}fft} \PYG{o}{=} \PYG{n}{doppyo}\PYG{o}{.}\PYG{n}{utils}\PYG{o}{.}\PYG{n}{fft}\PYG{p}{(}\PYG{n}{A}\PYG{p}{,} \PYG{n}{dim}\PYG{o}{=}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{time}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{lat}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{,} \PYG{n}{twosided}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{,} \PYG{n}{shift}\PYG{o}{=}\PYG{k+kc}{False}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{A\PYGZus{}new} \PYG{o}{=} \PYG{n}{doppyo}\PYG{o}{.}\PYG{n}{utils}\PYG{o}{.}\PYG{n}{ifft}\PYG{p}{(}\PYG{n}{A\PYGZus{}fft}\PYG{p}{,} \PYG{n}{dim}\PYG{o}{=}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{f\PYGZus{}lat}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{f\PYGZus{}time}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{,} \PYG{n}{shifted}\PYG{o}{=}\PYG{k+kc}{False}\PYG{p}{)}\PYG{o}{.}\PYG{n}{real}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n+nb}{print}\PYG{p}{(}\PYG{n}{A\PYGZus{}new}\PYG{p}{)}
\PYG{g+go}{\PYGZlt{}xarray.DataArray \PYGZsq{}ifft\PYGZsq{} (lat: 4, time: 4)\PYGZgt{}}
\PYG{g+go}{array([[\PYGZhy{}0.821396, \PYGZhy{}0.321925, \PYGZhy{}0.183761,  1.020338],}
\PYG{g+go}{       [ 0.147125,  0.17867 ,  0.343659,  1.487173],}
\PYG{g+go}{       [\PYGZhy{}1.53012 ,  1.586665, \PYGZhy{}0.097846,  1.535701],}
\PYG{g+go}{       [ 0.663949, \PYGZhy{}0.9256  ,  0.086642,  0.586463]])}
\PYG{g+go}{Coordinates:}
\PYG{g+go}{  * lat      (lat) float64 0.0 45.0 90.0 135.0}
\PYG{g+go}{  * time     (time) float64 0.0 8.64e+04 1.728e+05 2.592e+05}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{A\PYGZus{}new}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{lat}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{=} \PYG{n}{A}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{lat}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{A\PYGZus{}new}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{time}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{=} \PYG{n}{A}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{time}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n+nb}{print}\PYG{p}{(}\PYG{n}{A\PYGZus{}new}\PYG{p}{)}
\PYG{g+go}{\PYGZlt{}xarray.DataArray \PYGZsq{}ifft\PYGZsq{} (lat: 4, time: 4)\PYGZgt{}}
\PYG{g+go}{array([[\PYGZhy{}0.821396, \PYGZhy{}0.321925, \PYGZhy{}0.183761,  1.020338],}
\PYG{g+go}{       [ 0.147125,  0.17867 ,  0.343659,  1.487173],}
\PYG{g+go}{       [\PYGZhy{}1.53012 ,  1.586665, \PYGZhy{}0.097846,  1.535701],}
\PYG{g+go}{       [ 0.663949, \PYGZhy{}0.9256  ,  0.086642,  0.586463]])}
\PYG{g+go}{Coordinates:}
\PYG{g+go}{  * lat      (lat) int64 \PYGZhy{}90 \PYGZhy{}45 0 45}
\PYG{g+go}{  * time     (time) datetime64[ns] 2018\PYGZhy{}01\PYGZhy{}01 2018\PYGZhy{}01\PYGZhy{}02 2018\PYGZhy{}01\PYGZhy{}03 2018\PYGZhy{}01\PYGZhy{}04}
\end{sphinxVerbatim}

\end{fulllineitems}

\index{fftfilt() (in module utils)@\spxentry{fftfilt()}\spxextra{in module utils}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{utils_doc:utils.fftfilt}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{utils.}}\sphinxbfcode{\sphinxupquote{fftfilt}}}{\emph{da}, \emph{dim}, \emph{method}, \emph{dx}, \emph{x\_cut}}{}
Spectrally filters the provided array along dimension dim.

\begin{DUlineblock}{0em}
\item[] Author: Dougie Squire
\item[] Date: 15/09/2018
\end{DUlineblock}
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{description}
\item[{\sphinxstylestrong{da}}] \leavevmode{[}xarray.DataArray{]}
Array to filter

\item[{\sphinxstylestrong{dim}}] \leavevmode{[}str{]}
Dimension along which to filter

\item[{\sphinxstylestrong{method}}] \leavevmode{[}\{\sphinxcode{\sphinxupquote{"low pass"}}, \sphinxcode{\sphinxupquote{"high pass"}}, \sphinxcode{\sphinxupquote{"band pass"}}\}{]}
Filter method to use

\item[{\sphinxstylestrong{dx}}] \leavevmode{[}value{]}
Define the spacing of the dimension.

\item[{\sphinxstylestrong{xc}}] \leavevmode{[}value or array\_like (if method = \sphinxcode{\sphinxupquote{'band pass'}}){]}
Define the filter cut-off value(s), e.g. x\_cut = 5*dx

\end{description}

\item[{Returns}] \leavevmode\begin{description}
\item[{\sphinxstylestrong{filtered}}] \leavevmode{[}xarray.DataArray{]}
Filtered array

\end{description}

\end{description}\end{quote}
\subsubsection*{Examples}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{A} \PYG{o}{=} \PYG{n}{xr}\PYG{o}{.}\PYG{n}{DataArray}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{random}\PYG{o}{.}\PYG{n}{normal}\PYG{p}{(}\PYG{n}{size}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{100}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} 
\PYG{g+gp}{... }                 \PYG{n}{coords}\PYG{o}{=}\PYG{p}{[}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{time}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{pd}\PYG{o}{.}\PYG{n}{date\PYGZus{}range}\PYG{p}{(}\PYG{n}{start}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{1/1/2018}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{periods}\PYG{o}{=}\PYG{l+m+mi}{100}\PYG{p}{,} \PYG{n}{freq}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{D}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{p}{)}\PYG{p}{]}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{A\PYGZus{}filt} \PYG{o}{=} \PYG{n}{doppyo}\PYG{o}{.}\PYG{n}{utils}\PYG{o}{.}\PYG{n}{fftfilt}\PYG{p}{(}\PYG{n}{A}\PYG{p}{,} \PYG{n}{dim}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{time}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{method}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{low pass}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{dx}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{n}{x\PYGZus{}cut}\PYG{o}{=}\PYG{l+m+mi}{10}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n+nb}{print}\PYG{p}{(}\PYG{n}{A\PYGZus{}filt}\PYG{p}{)}
\PYG{g+go}{\PYGZlt{}xarray.DataArray \PYGZsq{}filtered\PYGZsq{} (time: 1000)\PYGZgt{}}
\PYG{g+go}{array([ 0.120893,  0.059256, \PYGZhy{}0.085101, ..., \PYGZhy{}0.351555, \PYGZhy{}0.112201,  0.061701])}
\PYG{g+go}{Coordinates:}
\PYG{g+go}{  * time     (time) datetime64[ns] 2018\PYGZhy{}01\PYGZhy{}01 2018\PYGZhy{}01\PYGZhy{}02 ... 2020\PYGZhy{}09\PYGZhy{}26}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{A}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{A\PYGZus{}filt}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\end{fulllineitems}

\index{isosurface() (in module utils)@\spxentry{isosurface()}\spxextra{in module utils}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{utils_doc:utils.isosurface}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{utils.}}\sphinxbfcode{\sphinxupquote{isosurface}}}{\emph{da}, \emph{coord}, \emph{target}}{}
Returns the values of a coordinate in the input array where the input array values equals                 a prescribed target. E.g. returns the depth of the 20 degC isotherm. Returns nans for all                 points in input array where isosurface is not defined. If

\begin{DUlineblock}{0em}
\item[] Author: Thomas Moore and Dougie Squire
\item[] Date: 02/10/2018
\end{DUlineblock}
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{description}
\item[{\sphinxstylestrong{da}}] \leavevmode{[}xarray DataArray{]}
Array of values to be isosurfaced

\item[{\sphinxstylestrong{coord}}] \leavevmode{[}str{]}
Name of coordinate to contruct isosurface about

\item[{\sphinxstylestrong{target}}] \leavevmode{[}value{]}
Isosurface value

\end{description}

\item[{Returns}] \leavevmode\begin{description}
\item[{\sphinxstylestrong{isosurface}}] \leavevmode{[}xarray DataArray{]}
Values of coord where da is closest to target. If multiple occurences of target occur                     along coord, only the maximum value of coord is returned

\end{description}

\end{description}\end{quote}
\subsubsection*{Notes}

If multiple occurences of target occur along coord, only the maximum value of coord is                returned

To do
\begin{itemize}
\item {} 
The current version includes no interpolation between grid spacing. This should be added as                 an option in the future

\end{itemize}
\subsubsection*{Examples}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{A} \PYG{o}{=} \PYG{n}{xr}\PYG{o}{.}\PYG{n}{DataArray}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{random}\PYG{o}{.}\PYG{n}{normal}\PYG{p}{(}\PYG{n}{size}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{5}\PYG{p}{,}\PYG{l+m+mi}{5}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} 
\PYG{g+gp}{... }                 \PYG{n}{coords}\PYG{o}{=}\PYG{p}{[}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{x}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{5}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{y}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{5}\PYG{p}{)}\PYG{p}{)}\PYG{p}{]}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{isosurface}\PYG{p}{(}\PYG{n}{A}\PYG{p}{,} \PYG{n}{coord}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{x}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{target}\PYG{o}{=}\PYG{l+m+mi}{0}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{doppyo}\PYG{o}{.}\PYG{n}{utils}\PYG{o}{.}\PYG{n}{isosurface}\PYG{p}{(}\PYG{n}{A}\PYG{p}{,} \PYG{n}{coord}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{x}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{target}\PYG{o}{=}\PYG{l+m+mi}{0}\PYG{p}{)}
\PYG{g+go}{\PYGZlt{}xarray.DataArray \PYGZsq{}isosurface\PYGZsq{} (y: 5)\PYGZgt{}}
\PYG{g+go}{array([ 4.,  1., nan,  3.,  4.])}
\PYG{g+go}{Coordinates:}
\PYG{g+go}{  * y        (y) int64 0 1 2 3 4}
\end{sphinxVerbatim}

\end{fulllineitems}

\index{load\_mean\_climatology() (in module utils)@\spxentry{load\_mean\_climatology()}\spxextra{in module utils}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{utils_doc:utils.load_mean_climatology}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{utils.}}\sphinxbfcode{\sphinxupquote{load\_mean\_climatology}}}{\emph{clim}, \emph{freq}, \emph{variable=None}, \emph{time\_name=None}, \emph{**kwargs}}{}
Returns pre-saved climatology at desired frequency.

\begin{DUlineblock}{0em}
\item[] Author: Dougie Squire
\item[] Date: 04/03/2018
\end{DUlineblock}
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{description}
\item[{\sphinxstylestrong{clim}}] \leavevmode{[}str{]}
Name of climatology to load. Currently available options are: \sphinxcode{\sphinxupquote{"jra\_1958-2016"}},                     \sphinxcode{\sphinxupquote{"cafe\_f1\_atmos\_2003-2017"}}, \sphinxcode{\sphinxupquote{"cafe\_f1\_ocean\_2003-2017"}}, \sphinxcode{\sphinxupquote{"cafe\_c2\_atmos\_400-499"}},                     \sphinxcode{\sphinxupquote{"cafe\_c2\_atmos\_500-549"}}, \sphinxcode{\sphinxupquote{"cafe\_c2\_ocean\_400-499"}}, \sphinxcode{\sphinxupquote{"cafe\_c2\_ocean\_500-549"}},                     \sphinxcode{\sphinxupquote{"HadISST\_1870-2018"}}, \sphinxcode{\sphinxupquote{"REMSS\_2002-2018"}}

\item[{\sphinxstylestrong{freq}}] \leavevmode{[}str{]}
Desired frequency of climatology (daily or longer) e.g. ‘D’, ‘M’

\item[{\sphinxstylestrong{variable}}] \leavevmode{[}str, optional{]}
Variable to load. If None, all variables are returned

\item[{\sphinxstylestrong{time\_name}}] \leavevmode{[}str, optional{]}
Name of the time dimension. If None, doppyo will attempt to determine time\_name                     automatically

\item[{\sphinxstylestrong{**kwargs}}] \leavevmode{[}dict{]}
Additional arguments to pass to load command

\end{description}

\item[{Returns}] \leavevmode\begin{description}
\item[{\sphinxstylestrong{climatology}}] \leavevmode{[}xarray DataArray{]}
Requested climatology

\end{description}

\end{description}\end{quote}
\subsubsection*{Notes}

Can only be run from a system connected to Bowen cloud storage
\subsubsection*{Examples}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{doppyo}\PYG{o}{.}\PYG{n}{utils}\PYG{o}{.}\PYG{n}{load\PYGZus{}mean\PYGZus{}climatology}\PYG{p}{(}\PYG{n}{clim}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{cafe\PYGZus{}c2\PYGZus{}atmos\PYGZus{}500\PYGZhy{}549}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{freq}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{D}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{variable}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{u}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{g+go}{\PYGZlt{}xarray.DataArray \PYGZsq{}u\PYGZsq{} (time: 366, level: 37, lat: 90, lon: 144)\PYGZgt{}}
\PYG{g+go}{[175504320 values with dtype=float32]}
\PYG{g+go}{Coordinates:}
\PYG{g+go}{  * lon      (lon) float64 1.25 3.75 6.25 8.75 11.25 ... 351.2 353.8 356.2 358.8}
\PYG{g+go}{  * lat      (lat) float64 \PYGZhy{}89.49 \PYGZhy{}87.98 \PYGZhy{}85.96 \PYGZhy{}83.93 ... 85.96 87.98 89.49}
\PYG{g+go}{  * level    (level) float32 1.0 2.0 3.0 5.0 7.0 ... 925.0 950.0 975.0 1000.0}
\PYG{g+go}{  * time     (time) datetime64[ns] 2016\PYGZhy{}01\PYGZhy{}01T12:00:00 ... 2016\PYGZhy{}12\PYGZhy{}31T12:00:00}
\PYG{g+go}{Attributes:}
\PYG{g+go}{    long\PYGZus{}name:      zonal wind}
\PYG{g+go}{    units:          m/sec}
\PYG{g+go}{    valid\PYGZus{}range:    [\PYGZhy{}32767  32767]}
\PYG{g+go}{    packing:        4}
\PYG{g+go}{    cell\PYGZus{}methods:   time: mean}
\PYG{g+go}{    time\PYGZus{}avg\PYGZus{}info:  average\PYGZus{}T1,average\PYGZus{}T2,average\PYGZus{}DT}
\end{sphinxVerbatim}

\end{fulllineitems}

\index{anomalize() (in module utils)@\spxentry{anomalize()}\spxextra{in module utils}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{utils_doc:utils.anomalize}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{utils.}}\sphinxbfcode{\sphinxupquote{anomalize}}}{\emph{data}, \emph{clim}, \emph{time\_name=None}}{}
Returns anomalies of data about clim

\begin{DUlineblock}{0em}
\item[] Author: Dougie Squire
\item[] Date: 04/03/2018
\end{DUlineblock}
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{description}
\item[{\sphinxstylestrong{data}}] \leavevmode{[}xarray DataArray{]}
Array to compute anomalies from

\item[{\sphinxstylestrong{clim}}] \leavevmode{[}xarray DataArray{]}
Array to compute anomalies about

\item[{\sphinxstylestrong{time\_name}}] \leavevmode{[}str, optional{]}
Name of the time dimension. If None, doppyo will attempt to determine time\_name                     automatically

\end{description}

\item[{Returns}] \leavevmode\begin{description}
\item[{\sphinxstylestrong{anomalies}}] \leavevmode{[}xarray DataArray{]}
Array containing anomalies of data about clim

\end{description}

\end{description}\end{quote}
\subsubsection*{Notes}

Cannot anomalize about multiple day/month/year climatologies, e.g. 5-day averages
\subsubsection*{Examples}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{A} \PYG{o}{=} \PYG{n}{xr}\PYG{o}{.}\PYG{n}{DataArray}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{random}\PYG{o}{.}\PYG{n}{normal}\PYG{p}{(}\PYG{n}{size}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{1000}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} 
\PYG{g+gp}{... }                 \PYG{n}{coords}\PYG{o}{=}\PYG{p}{[}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{time}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{pd}\PYG{o}{.}\PYG{n}{date\PYGZus{}range}\PYG{p}{(}\PYG{n}{start}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{1/1/2000}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{periods}\PYG{o}{=}\PYG{l+m+mi}{1000}\PYG{p}{,} \PYG{n}{freq}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{D}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{p}{)}\PYG{p}{]}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{A\PYGZus{}clim} \PYG{o}{=} \PYG{n}{A}\PYG{o}{.}\PYG{n}{groupby}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{time.month}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{o}{.}\PYG{n}{mean}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{time}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{doppyo}\PYG{o}{.}\PYG{n}{utils}\PYG{o}{.}\PYG{n}{anomalize}\PYG{p}{(}\PYG{n}{A}\PYG{p}{,} \PYG{n}{A\PYGZus{}clim}\PYG{p}{)}
\PYG{g+go}{\PYGZlt{}xarray.DataArray (time: 1000)\PYGZgt{}}
\PYG{g+go}{array([\PYGZhy{}3.050884, \PYGZhy{}0.361403, \PYGZhy{}0.893451, ...,  0.685141,  0.477916, \PYGZhy{}1.175434])}
\PYG{g+go}{Coordinates:}
\PYG{g+go}{  * time     (time) datetime64[ns] 2000\PYGZhy{}01\PYGZhy{}01 2000\PYGZhy{}01\PYGZhy{}02 ... 2002\PYGZhy{}09\PYGZhy{}26}
\end{sphinxVerbatim}

\end{fulllineitems}

\index{trunc\_time() (in module utils)@\spxentry{trunc\_time()}\spxextra{in module utils}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{utils_doc:utils.trunc_time}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{utils.}}\sphinxbfcode{\sphinxupquote{trunc\_time}}}{\emph{da}, \emph{freq}, \emph{time\_name=None}}{}
Truncates values in provided array to provided frequency

\begin{DUlineblock}{0em}
\item[] Author: Dougie Squire
\item[] Date: 04/04/2018
\end{DUlineblock}
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{description}
\item[{\sphinxstylestrong{da}}] \leavevmode{[}xarray DataArray{]}
Array containing time coordinate to be truncated

\item[{\sphinxstylestrong{freq}}] \leavevmode{[}str{]}
Truncation frequency. Options are ‘s’, ‘m’, ‘h’, D’, ‘M’, ‘Y’

\item[{\sphinxstylestrong{time\_name}}] \leavevmode{[}str, optional{]}
Name of the time dimension. If None, doppyo will attempt to determine time\_name                     automatically

\end{description}

\item[{Returns}] \leavevmode\begin{description}
\item[{\sphinxstylestrong{truncated}}] \leavevmode{[}xarray DataArray{]}
time-truncated array

\end{description}

\end{description}\end{quote}
\subsubsection*{Examples}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{A} \PYG{o}{=} \PYG{n}{xr}\PYG{o}{.}\PYG{n}{DataArray}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{random}\PYG{o}{.}\PYG{n}{normal}\PYG{p}{(}\PYG{n}{size}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{10}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} 
\PYG{g+gp}{... }                 \PYG{n}{coords}\PYG{o}{=}\PYG{p}{[}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{time}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{pd}\PYG{o}{.}\PYG{n}{date\PYGZus{}range}\PYG{p}{(}\PYG{n}{start}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{1/1/2000}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} 
\PYG{g+gp}{... }                          \PYG{n}{periods}\PYG{o}{=}\PYG{l+m+mi}{10}\PYG{p}{,} \PYG{n}{freq}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{M}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{o}{.}\PYG{n}{shift}\PYG{p}{(}\PYG{l+m+mi}{5}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{D}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{p}{)}\PYG{p}{]}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{doppyo}\PYG{o}{.}\PYG{n}{utils}\PYG{o}{.}\PYG{n}{trunc\PYGZus{}time}\PYG{p}{(}\PYG{n}{A}\PYG{p}{,} \PYG{n}{freq}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{M}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)} 
\PYG{g+go}{\PYGZlt{}xarray.DataArray (time: 10)\PYGZgt{}}
\PYG{g+go}{array([\PYGZhy{}0.197528,  1.022739, \PYGZhy{}0.50139 ,  0.128189, \PYGZhy{}0.886135,  0.570657,}
\PYG{g+go}{       \PYGZhy{}0.336125, \PYGZhy{}0.499281,  1.143722,  1.987681])}
\PYG{g+go}{Coordinates:}
\PYG{g+go}{  * time     (time) datetime64[ns] 2000\PYGZhy{}02\PYGZhy{}01 2000\PYGZhy{}03\PYGZhy{}01 ... 2000\PYGZhy{}11\PYGZhy{}01}
\end{sphinxVerbatim}

\end{fulllineitems}

\index{leadtime\_to\_datetime() (in module utils)@\spxentry{leadtime\_to\_datetime()}\spxextra{in module utils}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{utils_doc:utils.leadtime_to_datetime}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{utils.}}\sphinxbfcode{\sphinxupquote{leadtime\_to\_datetime}}}{\emph{da}, \emph{init\_date\_name='init\_date'}, \emph{lead\_time\_name='lead\_time'}, \emph{time\_name='time'}}{}
Converts time information from initial date / lead time dimension pair to single datetime                 dimension (i.e. timeseries)

\begin{DUlineblock}{0em}
\item[] Author: Dougie Squire
\item[] Date: 04/04/2018
\end{DUlineblock}
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{description}
\item[{\sphinxstylestrong{da}}] \leavevmode{[}xarray DataArray{]}
Array in initial date / lead time format to convert to datetime format

\item[{\sphinxstylestrong{init\_date\_name}}] \leavevmode{[}str, optional{]}
Name of initial date dimension

\item[{\sphinxstylestrong{lead\_time\_name}}] \leavevmode{[}str, optional{]}
Name of lead time dimension

\item[{\sphinxstylestrong{time\_name}}] \leavevmode{[}str, optional{]}
Name of time dimension to create

\end{description}

\item[{Returns}] \leavevmode\begin{description}
\item[{\sphinxstylestrong{converted}}] \leavevmode{[}xarray DataArray{]}
Array converted to datetime format

\end{description}

\end{description}\end{quote}
\subsubsection*{Examples}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{A} \PYG{o}{=} \PYG{n}{xr}\PYG{o}{.}\PYG{n}{DataArray}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{random}\PYG{o}{.}\PYG{n}{normal}\PYG{p}{(}\PYG{n}{size}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{10}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} 
\PYG{g+gp}{... }                 \PYG{n}{coords}\PYG{o}{=}\PYG{p}{[}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{time}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{pd}\PYG{o}{.}\PYG{n}{date\PYGZus{}range}\PYG{p}{(}\PYG{n}{start}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{1/1/2000}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{periods}\PYG{o}{=}\PYG{l+m+mi}{10}\PYG{p}{,} \PYG{n}{freq}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{M}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{p}{)}\PYG{p}{]}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{B} \PYG{o}{=} \PYG{n}{doppyo}\PYG{o}{.}\PYG{n}{utils}\PYG{o}{.}\PYG{n}{datetime\PYGZus{}to\PYGZus{}leadtime}\PYG{p}{(}\PYG{n}{A}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{doppyo}\PYG{o}{.}\PYG{n}{utils}\PYG{o}{.}\PYG{n}{leadtime\PYGZus{}to\PYGZus{}datetime}\PYG{p}{(}\PYG{n}{B}\PYG{p}{)}
\PYG{g+go}{\PYGZlt{}xarray.DataArray (time: 10)\PYGZgt{}}
\PYG{g+go}{array([\PYGZhy{}0.158172,  1.319148,  0.648378,  0.577859,  0.371392, \PYGZhy{}1.380317,}
\PYG{g+go}{        0.126416,  1.184546,  0.107898,  1.304755])}
\PYG{g+go}{Coordinates:}
\PYG{g+go}{  * time     (time) datetime64[ns] 2000\PYGZhy{}01\PYGZhy{}31 2000\PYGZhy{}02\PYGZhy{}29 ... 2000\PYGZhy{}10\PYGZhy{}31}
\end{sphinxVerbatim}

\end{fulllineitems}

\index{datetime\_to\_leadtime() (in module utils)@\spxentry{datetime\_to\_leadtime()}\spxextra{in module utils}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{utils_doc:utils.datetime_to_leadtime}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{utils.}}\sphinxbfcode{\sphinxupquote{datetime\_to\_leadtime}}}{\emph{da}, \emph{init\_date\_name='init\_date'}, \emph{lead\_time\_name='lead\_time'}, \emph{time\_name='time'}}{}
Converts time information from single datetime dimension (i.e. timeseries) to initial date /                lead time dimension pair

\begin{DUlineblock}{0em}
\item[] Author: Dougie Squire
\item[] Date: 04/04/2018
\end{DUlineblock}
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{description}
\item[{\sphinxstylestrong{da}}] \leavevmode{[}xarray DataArray{]}
Array to in datetime format to convert to initial date / lead time format

\item[{\sphinxstylestrong{init\_date\_name}}] \leavevmode{[}str, optional{]}
Name of initial date dimension to create

\item[{\sphinxstylestrong{lead\_time\_name}}] \leavevmode{[}str, optional{]}
Name of lead time dimension to create

\item[{\sphinxstylestrong{time\_name}}] \leavevmode{[}str, optional{]}
Name of time dimension

\end{description}

\item[{Returns}] \leavevmode\begin{description}
\item[{\sphinxstylestrong{converted}}] \leavevmode{[}xarray DataArray{]}
Array converted to initial date / lead time format

\end{description}

\end{description}\end{quote}
\subsubsection*{Notes}

Only compatible with time coordinates that have frequencies that can be determined by pandas.infer\_freq().                 This means that ambiguous frequencies, such as month-centred monthly frequencies must be preprocessed for                compatibility (see doppyo.utils.trunc\_freq())
\subsubsection*{Examples}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{A} \PYG{o}{=} \PYG{n}{xr}\PYG{o}{.}\PYG{n}{DataArray}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{random}\PYG{o}{.}\PYG{n}{normal}\PYG{p}{(}\PYG{n}{size}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{10}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} 
\PYG{g+gp}{... }                 \PYG{n}{coords}\PYG{o}{=}\PYG{p}{[}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{time}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{pd}\PYG{o}{.}\PYG{n}{date\PYGZus{}range}\PYG{p}{(}\PYG{n}{start}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{1/1/2000}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{periods}\PYG{o}{=}\PYG{l+m+mi}{10}\PYG{p}{,} \PYG{n}{freq}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{M}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{p}{)}\PYG{p}{]}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{doppyo}\PYG{o}{.}\PYG{n}{utils}\PYG{o}{.}\PYG{n}{datetime\PYGZus{}to\PYGZus{}leadtime}\PYG{p}{(}\PYG{n}{A}\PYG{p}{)}
\PYG{g+go}{\PYGZlt{}xarray.DataArray (lead\PYGZus{}time: 10)\PYGZgt{}}
\PYG{g+go}{array([ 0.450976, \PYGZhy{}1.671764,  0.681519,  0.836319, \PYGZhy{}0.005434,  0.144954,}
\PYG{g+go}{        0.719887,  0.344615,  0.461055,  0.736307])}
\PYG{g+go}{Coordinates:}
\PYG{g+go}{  * lead\PYGZus{}time  (lead\PYGZus{}time) int64 0 1 2 3 4 5 6 7 8 9}
\PYG{g+go}{    init\PYGZus{}date  datetime64[ns] 2000\PYGZhy{}01\PYGZhy{}31}
\end{sphinxVerbatim}

\end{fulllineitems}

\index{repeat\_datapoint() (in module utils)@\spxentry{repeat\_datapoint()}\spxextra{in module utils}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{utils_doc:utils.repeat_datapoint}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{utils.}}\sphinxbfcode{\sphinxupquote{repeat\_datapoint}}}{\emph{da}, \emph{coord}, \emph{coord\_val}}{}
Returns array with data at coord = coord\_val repeated across all other elements in coord.                 This is useful for generating persistence forecasts

\begin{DUlineblock}{0em}
\item[] Author: Dougie Squire
\item[] Date: 02/06/2018
\end{DUlineblock}
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{description}
\item[{\sphinxstylestrong{da}}] \leavevmode{[}xarray DataArray{]}
Array containing darta to repeat

\item[{\sphinxstylestrong{coord}}] \leavevmode{[}str{]}
Coordinate in da over which to repeat the data at coord = coord\_val

\item[{\sphinxstylestrong{coord\_val}}] \leavevmode{[}value{]}
The value of coord giving the data to be repeated

\end{description}

\item[{Returns}] \leavevmode\begin{description}
\item[{\sphinxstylestrong{repeated}}] \leavevmode{[}xarray DataArray{]}
Array with data at coord=coord\_val repeated across all other elements in coord

\end{description}

\end{description}\end{quote}
\subsubsection*{Examples}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{A} \PYG{o}{=} \PYG{n}{xr}\PYG{o}{.}\PYG{n}{DataArray}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{random}\PYG{o}{.}\PYG{n}{normal}\PYG{p}{(}\PYG{n}{size}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} 
\PYG{g+gp}{... }                 \PYG{n}{coords}\PYG{o}{=}\PYG{p}{[}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{x}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{y}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{)}\PYG{p}{]}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{doppyo}\PYG{o}{.}\PYG{n}{utils}\PYG{o}{.}\PYG{n}{repeat\PYGZus{}datapoint}\PYG{p}{(}\PYG{n}{A}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{x}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+m+mi}{2}\PYG{p}{)}
\PYG{g+go}{\PYGZlt{}xarray.DataArray (x: 3, y: 2)\PYGZgt{}}
\PYG{g+go}{array([[\PYGZhy{}1.805652,  0.526434],}
\PYG{g+go}{       [\PYGZhy{}1.805652,  0.526434],}
\PYG{g+go}{       [\PYGZhy{}1.805652,  0.526434]])}
\PYG{g+go}{Coordinates:}
\PYG{g+go}{  * x        (x) int64 0 1 2}
\PYG{g+go}{  * y        (y) int64 0 1}
\end{sphinxVerbatim}

\end{fulllineitems}

\index{get\_latlon\_region() (in module utils)@\spxentry{get\_latlon\_region()}\spxextra{in module utils}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{utils_doc:utils.get_latlon_region}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{utils.}}\sphinxbfcode{\sphinxupquote{get\_latlon\_region}}}{\emph{da}, \emph{box}}{}
Returns an array containing those elements of the input array that fall within the provided                lat-lon box

\begin{DUlineblock}{0em}
\item[] Author: Dougie Squire
\item[] Date: 04/04/2018
\end{DUlineblock}
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{description}
\item[{\sphinxstylestrong{da}}] \leavevmode{[}xarray DataArray{]}
Array to extract lat-lon box from

\item[{\sphinxstylestrong{box}}] \leavevmode{[}array\_like{]}
Edges of lat-lon box in the format {[}lat\_min, lat\_max, lon\_min, lon\_max{]}

\end{description}

\item[{Returns}] \leavevmode\begin{description}
\item[{\sphinxstylestrong{reduced}}] \leavevmode{[}xarray DataArray{]}
Array containing those elements of the input array that fall within the box

\end{description}

\end{description}\end{quote}
\subsubsection*{Examples}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{A} \PYG{o}{=} \PYG{n}{xr}\PYG{o}{.}\PYG{n}{DataArray}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{random}\PYG{o}{.}\PYG{n}{normal}\PYG{p}{(}\PYG{n}{size}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{180}\PYG{p}{,}\PYG{l+m+mi}{360}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} 
\PYG{g+gp}{... }                 \PYG{n}{coords}\PYG{o}{=}\PYG{p}{[}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{lat}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{90}\PYG{p}{,}\PYG{l+m+mi}{90}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{lon}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{280}\PYG{p}{,}\PYG{l+m+mi}{80}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{)}\PYG{p}{]}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{doppyo}\PYG{o}{.}\PYG{n}{utils}\PYG{o}{.}\PYG{n}{get\PYGZus{}latlon\PYGZus{}region}\PYG{p}{(}\PYG{n}{A}\PYG{p}{,} \PYG{p}{[}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{10}\PYG{p}{,} \PYG{l+m+mi}{10}\PYG{p}{,} \PYG{l+m+mi}{70}\PYG{p}{,} \PYG{l+m+mi}{90}\PYG{p}{]}\PYG{p}{)}
\PYG{g+go}{\PYGZlt{}xarray.DataArray (lat: 21, lon: 21)\PYGZgt{}}
\PYG{g+go}{array([[ 0.854745,  1.53709 ,  0.491165, ..., \PYGZhy{}0.675664,  1.572102, \PYGZhy{}0.931492],}
\PYG{g+go}{       [ 0.570822,  0.60621 , \PYGZhy{}0.125524, ..., \PYGZhy{}1.731507,  0.853652,  0.845369],}
\PYG{g+go}{       [\PYGZhy{}0.061811,  0.758512,  1.215573, ..., \PYGZhy{}1.275482,  2.668203,  0.791314],}
\PYG{g+go}{       ...,}
\PYG{g+go}{       [\PYGZhy{}0.263597,  0.102755, \PYGZhy{}2.775252, ..., \PYGZhy{}0.736136,  0.944762,  0.005952],}
\PYG{g+go}{       [ 0.009949,  0.409897, \PYGZhy{}0.138621, ...,  1.054246,  1.30817 , \PYGZhy{}0.539534],}
\PYG{g+go}{       [ 1.281245, \PYGZhy{}0.792166, \PYGZhy{}1.736007, ...,  0.474207, \PYGZhy{}0.781518,  0.738593]])}
\PYG{g+go}{Coordinates:}
\PYG{g+go}{  * lat      (lat) int64 \PYGZhy{}10 \PYGZhy{}9 \PYGZhy{}8 \PYGZhy{}7 \PYGZhy{}6 \PYGZhy{}5 \PYGZhy{}4 \PYGZhy{}3 \PYGZhy{}2 \PYGZhy{}1 0 1 2 3 4 5 6 7 8 9 10}
\PYG{g+go}{  * lon      (lon) int64 \PYGZhy{}280 \PYGZhy{}279 \PYGZhy{}278 \PYGZhy{}277 \PYGZhy{}276 \PYGZhy{}275 ... 74 75 76 77 78 79}
\end{sphinxVerbatim}

\end{fulllineitems}

\index{latlon\_average() (in module utils)@\spxentry{latlon\_average()}\spxextra{in module utils}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{utils_doc:utils.latlon_average}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{utils.}}\sphinxbfcode{\sphinxupquote{latlon\_average}}}{\emph{da}, \emph{box}}{}
Returns the average of the input array over a provide lat-lon box,

\begin{DUlineblock}{0em}
\item[] Author: Dougie Squire
\item[] Date: 04/04/2018
\end{DUlineblock}
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{description}
\item[{\sphinxstylestrong{da}}] \leavevmode{[}xarray DataArray{]}
Array to average lat-lon box from

\item[{\sphinxstylestrong{box}}] \leavevmode{[}array\_like{]}
Edges of lat-lon box in the format {[}lat\_min, lat\_max, lon\_min, lon\_max{]}

\end{description}

\item[{Returns}] \leavevmode\begin{description}
\item[{\sphinxstylestrong{reduced}}] \leavevmode{[}xarray DataArray{]}
Array containing those elements of the input array that fall within the box

\end{description}

\end{description}\end{quote}
\subsubsection*{Examples}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{A} \PYG{o}{=} \PYG{n}{xr}\PYG{o}{.}\PYG{n}{DataArray}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{random}\PYG{o}{.}\PYG{n}{normal}\PYG{p}{(}\PYG{n}{size}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{180}\PYG{p}{,}\PYG{l+m+mi}{360}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} 
\PYG{g+gp}{... }                 \PYG{n}{coords}\PYG{o}{=}\PYG{p}{[}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{lat}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{90}\PYG{p}{,}\PYG{l+m+mi}{90}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{lon}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{280}\PYG{p}{,}\PYG{l+m+mi}{80}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{)}\PYG{p}{]}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{doppyo}\PYG{o}{.}\PYG{n}{utils}\PYG{o}{.}\PYG{n}{latlon\PYGZus{}average}\PYG{p}{(}\PYG{n}{A}\PYG{p}{,} \PYG{p}{[}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{10}\PYG{p}{,} \PYG{l+m+mi}{10}\PYG{p}{,} \PYG{l+m+mi}{70}\PYG{p}{,} \PYG{l+m+mi}{90}\PYG{p}{]}\PYG{p}{)}
\PYG{g+go}{\PYGZlt{}xarray.DataArray ()\PYGZgt{}}
\PYG{g+go}{array(\PYGZhy{}0.056776)}
\end{sphinxVerbatim}

\end{fulllineitems}

\index{stack\_by\_init\_date() (in module utils)@\spxentry{stack\_by\_init\_date()}\spxextra{in module utils}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{utils_doc:utils.stack_by_init_date}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{utils.}}\sphinxbfcode{\sphinxupquote{stack\_by\_init\_date}}}{\emph{da}, \emph{init\_dates}, \emph{N\_lead\_steps}, \emph{init\_date\_name='init\_date'}, \emph{lead\_time\_name='lead\_time'}, \emph{time\_name='time'}}{}
Stacks provided timeseries array in an inital date / lead time format. Note this process                 replicates data and can substantially increase memory usage. Lead time frequency will match                 frequency of input data. Returns nans if requested times lie outside of the available range

\begin{DUlineblock}{0em}
\item[] Author: Dougie Squire
\item[] Date: 14/03/2018
\end{DUlineblock}
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{description}
\item[{\sphinxstylestrong{da}}] \leavevmode{[}xarray DataArray{]}
Timeseries array to be stacked

\item[{\sphinxstylestrong{init\_dates}}] \leavevmode{[}array\_like of datetime objects{]}
Initial dates to stack onto

\item[{\sphinxstylestrong{N\_lead\_steps}}] \leavevmode{[}value{]}
Number of lead time steps

\item[{\sphinxstylestrong{init\_date\_name}}] \leavevmode{[}str, optional{]}
Name of initial date dimension

\item[{\sphinxstylestrong{lead\_time\_name}}] \leavevmode{[}str, optional{]}
Name of lead time dimension

\item[{\sphinxstylestrong{time\_name}}] \leavevmode{[}str, optional{]}
Name of time dimension

\end{description}

\item[{Returns}] \leavevmode\begin{description}
\item[{\sphinxstylestrong{stacked}}] \leavevmode{[}xarray DataArray{]}
Stacked xarray in inital date / lead time format

\end{description}

\end{description}\end{quote}
\subsubsection*{Examples}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{A} \PYG{o}{=} \PYG{n}{xr}\PYG{o}{.}\PYG{n}{DataArray}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{random}\PYG{o}{.}\PYG{n}{normal}\PYG{p}{(}\PYG{n}{size}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} 
\PYG{g+gp}{... }                 \PYG{n}{coords}\PYG{o}{=}\PYG{p}{[}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{time}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{pd}\PYG{o}{.}\PYG{n}{date\PYGZus{}range}\PYG{p}{(}\PYG{n}{start}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{2000\PYGZhy{}01\PYGZhy{}01}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{periods}\PYG{o}{=}\PYG{l+m+mi}{3}\PYG{p}{,} \PYG{n}{freq}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{MS}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{p}{)}\PYG{p}{]}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{init\PYGZus{}dates} \PYG{o}{=} \PYG{n}{pd}\PYG{o}{.}\PYG{n}{date\PYGZus{}range}\PYG{p}{(}\PYG{n}{start}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{1999\PYGZhy{}11\PYGZhy{}01}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{periods}\PYG{o}{=}\PYG{l+m+mi}{3}\PYG{p}{,} \PYG{n}{freq}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{MS}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{doppyo}\PYG{o}{.}\PYG{n}{utils}\PYG{o}{.}\PYG{n}{stack\PYGZus{}by\PYGZus{}init\PYGZus{}date}\PYG{p}{(}\PYG{n}{A}\PYG{p}{,} \PYG{n}{init\PYGZus{}dates}\PYG{o}{=}\PYG{n}{init\PYGZus{}dates}\PYG{p}{,} \PYG{n}{N\PYGZus{}lead\PYGZus{}steps}\PYG{o}{=}\PYG{l+m+mi}{3}\PYG{p}{)}
\PYG{g+go}{\PYGZlt{}xarray.DataArray (init\PYGZus{}date: 3, lead\PYGZus{}time: 3)\PYGZgt{}}
\PYG{g+go}{array([[      nan,       nan,       nan],}
\PYG{g+go}{       [      nan,       nan,       nan],}
\PYG{g+go}{       [ 0.509276, \PYGZhy{}3.046124, \PYGZhy{}0.665343]])}
\PYG{g+go}{Coordinates:}
\PYG{g+go}{  * lead\PYGZus{}time  (lead\PYGZus{}time) int64 0 1 2}
\PYG{g+go}{  * init\PYGZus{}date  (init\PYGZus{}date) datetime64[ns] 1999\PYGZhy{}11\PYGZhy{}01 1999\PYGZhy{}12\PYGZhy{}01 2000\PYGZhy{}01\PYGZhy{}01}
\end{sphinxVerbatim}

\end{fulllineitems}

\index{concat\_times() (in module utils)@\spxentry{concat\_times()}\spxextra{in module utils}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{utils_doc:utils.concat_times}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{utils.}}\sphinxbfcode{\sphinxupquote{concat\_times}}}{\emph{da}, \emph{init\_date\_name='init\_date'}, \emph{lead\_time\_name='lead\_time'}, \emph{time\_name='time'}}{}
Unstack and concatenate all init\_date/lead\_time rows into single time dimension

\begin{DUlineblock}{0em}
\item[] Author: Dougie Squire
\item[] Date: 22/04/2018
\end{DUlineblock}
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{description}
\item[{\sphinxstylestrong{da}}] \leavevmode{[}xarray DataArray{]}
Array to be unstacked and concatenated

\item[{\sphinxstylestrong{init\_date\_name}}] \leavevmode{[}str, optional{]}
Name of initial date dimension

\item[{\sphinxstylestrong{lead\_time\_name}}] \leavevmode{[}str, optional{]}
Name of lead time dimension

\item[{\sphinxstylestrong{time\_name}}] \leavevmode{[}str, optional{]}
Name of time dimension

\end{description}

\item[{Returns}] \leavevmode\begin{description}
\item[{\sphinxstylestrong{concatenated}}] \leavevmode{[}xarray DataArray{]}
Unstacked and concatenated array

\end{description}

\end{description}\end{quote}
\subsubsection*{Examples}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{A} \PYG{o}{=} \PYG{n}{xr}\PYG{o}{.}\PYG{n}{DataArray}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{random}\PYG{o}{.}\PYG{n}{normal}\PYG{p}{(}\PYG{n}{size}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{,}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} 
\PYG{g+gp}{... }                 \PYG{n}{coords}\PYG{o}{=}\PYG{p}{[}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{init\PYGZus{}date}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} 
\PYG{g+gp}{... }                          \PYG{n}{pd}\PYG{o}{.}\PYG{n}{date\PYGZus{}range}\PYG{p}{(}\PYG{n}{start}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{1/1/2018}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{periods}\PYG{o}{=}\PYG{l+m+mi}{3}\PYG{p}{,} \PYG{n}{freq}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{M}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} 
\PYG{g+gp}{... }                         \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{lead\PYGZus{}time}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{]}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{A}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{lead\PYGZus{}time}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{.}\PYG{n}{attrs}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{units}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{M}\PYG{l+s+s1}{\PYGZsq{}}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{doppyo}\PYG{o}{.}\PYG{n}{utils}\PYG{o}{.}\PYG{n}{concat\PYGZus{}times}\PYG{p}{(}\PYG{n}{A}\PYG{p}{)}
\PYG{g+go}{\PYGZlt{}xarray.DataArray (time: 9)\PYGZgt{}}
\PYG{g+go}{array([\PYGZhy{}1.65746 ,  0.57727 ,  0.010619, \PYGZhy{}0.008245,  0.119201, \PYGZhy{}0.445606,}
\PYG{g+go}{       \PYGZhy{}0.546745,  0.157267, \PYGZhy{}1.616096])}
\PYG{g+go}{Coordinates:}
\PYG{g+go}{  * time     (time) datetime64[ns] 2018\PYGZhy{}01\PYGZhy{}31 2018\PYGZhy{}02\PYGZhy{}28 ... 2018\PYGZhy{}05\PYGZhy{}31}
\end{sphinxVerbatim}

\end{fulllineitems}

\index{prune() (in module utils)@\spxentry{prune()}\spxextra{in module utils}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{utils_doc:utils.prune}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{utils.}}\sphinxbfcode{\sphinxupquote{prune}}}{\emph{da}, \emph{squeeze=False}}{}
Removes all coordinates that are not dimensions

\begin{DUlineblock}{0em}
\item[] Author: Dougie Squire
\item[] Date: 22/04/2018
\end{DUlineblock}
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{description}
\item[{\sphinxstylestrong{da}}] \leavevmode{[}xarray DataArray{]}
Array to prune

\item[{\sphinxstylestrong{squeeze}}] \leavevmode{[}bool, optional{]}
If True, squeeze the array (i.e. remove 1D dimensions) prior to pruning

\end{description}

\item[{Returns}] \leavevmode\begin{description}
\item[{\sphinxstylestrong{pruned}}] \leavevmode{[}xarray DataArray{]}
The pruned array

\end{description}

\end{description}\end{quote}
\subsubsection*{Examples}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{A} \PYG{o}{=} \PYG{n}{xr}\PYG{o}{.}\PYG{n}{DataArray}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{random}\PYG{o}{.}\PYG{n}{normal}\PYG{p}{(}\PYG{n}{size}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} 
\PYG{g+gp}{... }                 \PYG{n}{coords}\PYG{o}{=}\PYG{p}{[}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{x}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{y}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{)}\PYG{p}{]}\PYG{p}{)}\PYG{o}{.}\PYG{n}{expand\PYGZus{}dims}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{z}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{A}\PYG{o}{.}\PYG{n}{coords}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{w}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{=} \PYG{l+m+mi}{1}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{doppyo}\PYG{o}{.}\PYG{n}{utils}\PYG{o}{.}\PYG{n}{prune}\PYG{p}{(}\PYG{n}{A}\PYG{p}{,} \PYG{n}{squeeze}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{)}
\PYG{g+go}{\PYGZlt{}xarray.DataArray (x: 3)\PYGZgt{}}
\PYG{g+go}{array([\PYGZhy{}1.323662,  1.464171,  0.480917])}
\PYG{g+go}{Coordinates:}
\PYG{g+go}{  * x        (x) int64 0 1 2}
\end{sphinxVerbatim}

\end{fulllineitems}

\index{get\_other\_dims() (in module utils)@\spxentry{get\_other\_dims()}\spxextra{in module utils}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{utils_doc:utils.get_other_dims}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{utils.}}\sphinxbfcode{\sphinxupquote{get\_other\_dims}}}{\emph{da}, \emph{dims\_exclude}}{}
Returns all dimensions in provided dataset excluding dim\_exclude

\begin{DUlineblock}{0em}
\item[] Author: Dougie Squire
\item[] Date: 22/04/2018
\end{DUlineblock}
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{description}
\item[{\sphinxstylestrong{da}}] \leavevmode{[}xarray DataArray{]}
Array to retreive dimensions from

\item[{\sphinxstylestrong{dims\_exclude}}] \leavevmode{[}str or sequence of str{]}
Dimensions to exclude

\end{description}

\item[{Returns}] \leavevmode\begin{description}
\item[{\sphinxstylestrong{dims}}] \leavevmode{[}str or sequence of str{]}
Dimensions of input array, excluding dims\_exclude

\end{description}

\end{description}\end{quote}
\subsubsection*{Examples}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{A} \PYG{o}{=} \PYG{n}{xr}\PYG{o}{.}\PYG{n}{DataArray}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{random}\PYG{o}{.}\PYG{n}{normal}\PYG{p}{(}\PYG{n}{size}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} \PYG{n}{coords}\PYG{o}{=}\PYG{p}{[}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{x}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} 
\PYG{g+gp}{... }                                                       \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{y}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{)}\PYG{p}{]}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{doppyo}\PYG{o}{.}\PYG{n}{utils}\PYG{o}{.}\PYG{n}{get\PYGZus{}other\PYGZus{}dims}\PYG{p}{(}\PYG{n}{A}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{y}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{g+go}{\PYGZsq{}x\PYGZsq{}}
\end{sphinxVerbatim}

\end{fulllineitems}

\index{cftime\_to\_datetime64() (in module utils)@\spxentry{cftime\_to\_datetime64()}\spxextra{in module utils}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{utils_doc:utils.cftime_to_datetime64}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{utils.}}\sphinxbfcode{\sphinxupquote{cftime\_to\_datetime64}}}{\emph{time}, \emph{shift\_year=0}}{}
Convert cftime object to datetime64 object, allowing for \sphinxtitleref{NOLEAP} calendar configuration

\begin{DUlineblock}{0em}
\item[] Author: Dougie Squire
\item[] Date: 04/09/2018
\end{DUlineblock}
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{description}
\item[{\sphinxstylestrong{time}}] \leavevmode{[}cftime or array\_like of cftime{]}
Times to be converted to datetime64

\item[{\sphinxstylestrong{shift\_year: values}}] \leavevmode
Number of years to shift times by. cftime objects are generated by xarray when times fall                     outside of the range 1678-2261. Shifting years to within this range enables conversion to                     datetime64 within an xarray object

\end{description}

\item[{Returns}] \leavevmode\begin{description}
\item[{\sphinxstylestrong{converted}}] \leavevmode{[}numpy datetime64 or array\_like of numpy datetime64{]}
Input times converted from cftime to numpy datetime64

\end{description}

\end{description}\end{quote}
\subsubsection*{Notes}

Times must be sequential and monotonic
\subsubsection*{Examples}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{A} \PYG{o}{=} \PYG{n}{xr}\PYG{o}{.}\PYG{n}{DataArray}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{random}\PYG{o}{.}\PYG{n}{normal}\PYG{p}{(}\PYG{n}{size}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{12}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} 
\PYG{g+gp}{... }                 \PYG{n}{coords}\PYG{o}{=}\PYG{p}{[}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{time}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{array}\PYG{p}{(}\PYG{p}{[}\PYG{n}{cftime}\PYG{o}{.}\PYG{n}{datetime}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,} \PYG{n}{m}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{)} \PYG{k}{for} \PYG{n}{m} \PYG{o+ow}{in} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{l+m+mi}{13}\PYG{p}{)}\PYG{p}{]}\PYG{p}{)}\PYG{p}{)}\PYG{p}{]}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{A}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{time}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{=} \PYG{n}{doppyo}\PYG{o}{.}\PYG{n}{utils}\PYG{o}{.}\PYG{n}{cftime\PYGZus{}to\PYGZus{}datetime64}\PYG{p}{(}\PYG{n}{A}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{time}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{,} \PYG{n}{shift\PYGZus{}year}\PYG{o}{=}\PYG{l+m+mi}{2000}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{A}
\PYG{g+go}{\PYGZlt{}xarray.DataArray (time: 12)\PYGZgt{}}
\PYG{g+go}{array([ 0.391673, \PYGZhy{}1.317681,  1.51771 , \PYGZhy{}0.195475,  0.525342,  0.390625,}
\PYG{g+go}{        1.426725, \PYGZhy{}0.261821,  1.021318,  1.205761, \PYGZhy{}0.907714,  1.009402])}
\PYG{g+go}{Coordinates:}
\PYG{g+go}{  * time     (time) datetime64[ns] 2000\PYGZhy{}01\PYGZhy{}01 2000\PYGZhy{}02\PYGZhy{}01 ... 2000\PYGZhy{}12\PYGZhy{}01}
\end{sphinxVerbatim}

\end{fulllineitems}

\index{get\_time\_name() (in module utils)@\spxentry{get\_time\_name()}\spxextra{in module utils}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{utils_doc:utils.get_time_name}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{utils.}}\sphinxbfcode{\sphinxupquote{get\_time\_name}}}{\emph{da}}{}
Returns name of time dimension in input array

\begin{DUlineblock}{0em}
\item[] Author: Dougie Squire
\item[] Date: 03/03/2018
\end{DUlineblock}
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{description}
\item[{\sphinxstylestrong{da}}] \leavevmode{[}xarray DataArray{]}
Array with coordinate corresponding to time

\end{description}

\item[{Returns}] \leavevmode\begin{description}
\item[{\sphinxstylestrong{name}}] \leavevmode{[}str{]}
Name of dimension corresponding to time

\end{description}

\end{description}\end{quote}
\subsubsection*{Examples}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{A} \PYG{o}{=} \PYG{n}{xr}\PYG{o}{.}\PYG{n}{DataArray}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{random}\PYG{o}{.}\PYG{n}{normal}\PYG{p}{(}\PYG{n}{size}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} 
\PYG{g+gp}{... }                 \PYG{n}{coords}\PYG{o}{=}\PYG{p}{[}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{lat}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{lon}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} 
\PYG{g+gp}{... }                         \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{depth}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{time}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{)}\PYG{p}{]}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{doppyo}\PYG{o}{.}\PYG{n}{utils}\PYG{o}{.}\PYG{n}{get\PYGZus{}time\PYGZus{}name}\PYG{p}{(}\PYG{n}{A}\PYG{p}{)}
\PYG{g+go}{\PYGZsq{}time\PYGZsq{}}
\end{sphinxVerbatim}

\end{fulllineitems}

\index{get\_lon\_name() (in module utils)@\spxentry{get\_lon\_name()}\spxextra{in module utils}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{utils_doc:utils.get_lon_name}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{utils.}}\sphinxbfcode{\sphinxupquote{get\_lon\_name}}}{\emph{da}}{}
Returns name of longitude dimension in input array

\begin{DUlineblock}{0em}
\item[] Author: Dougie Squire
\item[] Date: 03/03/2018
\end{DUlineblock}
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{description}
\item[{\sphinxstylestrong{da}}] \leavevmode{[}xarray DataArray{]}
Array with coordinate corresponding to longitude

\end{description}

\item[{Returns}] \leavevmode\begin{description}
\item[{\sphinxstylestrong{name}}] \leavevmode{[}str{]}
Name of dimension corresponding to longitude

\end{description}

\end{description}\end{quote}
\subsubsection*{Examples}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{A} \PYG{o}{=} \PYG{n}{xr}\PYG{o}{.}\PYG{n}{DataArray}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{random}\PYG{o}{.}\PYG{n}{normal}\PYG{p}{(}\PYG{n}{size}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} 
\PYG{g+gp}{... }                 \PYG{n}{coords}\PYG{o}{=}\PYG{p}{[}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{lat}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{lon}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} 
\PYG{g+gp}{... }                         \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{depth}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{level}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{)}\PYG{p}{]}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{doppyo}\PYG{o}{.}\PYG{n}{utils}\PYG{o}{.}\PYG{n}{get\PYGZus{}lon\PYGZus{}name}\PYG{p}{(}\PYG{n}{A}\PYG{p}{)}
\PYG{g+go}{\PYGZsq{}lon\PYGZsq{}}
\end{sphinxVerbatim}

\end{fulllineitems}

\index{get\_lat\_name() (in module utils)@\spxentry{get\_lat\_name()}\spxextra{in module utils}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{utils_doc:utils.get_lat_name}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{utils.}}\sphinxbfcode{\sphinxupquote{get\_lat\_name}}}{\emph{da}}{}
Returns name of latitude dimension in input array

\begin{DUlineblock}{0em}
\item[] Author: Dougie Squire
\item[] Date: 03/03/2018
\end{DUlineblock}
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{description}
\item[{\sphinxstylestrong{da}}] \leavevmode{[}xarray DataArray{]}
Array with coordinate corresponding to latitude

\end{description}

\item[{Returns}] \leavevmode\begin{description}
\item[{\sphinxstylestrong{name}}] \leavevmode{[}str{]}
Name of dimension corresponding to latitude

\end{description}

\end{description}\end{quote}
\subsubsection*{Examples}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{A} \PYG{o}{=} \PYG{n}{xr}\PYG{o}{.}\PYG{n}{DataArray}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{random}\PYG{o}{.}\PYG{n}{normal}\PYG{p}{(}\PYG{n}{size}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} 
\PYG{g+gp}{... }                 \PYG{n}{coords}\PYG{o}{=}\PYG{p}{[}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{lat}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{lon}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} 
\PYG{g+gp}{... }                         \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{depth}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{level}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{)}\PYG{p}{]}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{doppyo}\PYG{o}{.}\PYG{n}{utils}\PYG{o}{.}\PYG{n}{get\PYGZus{}lat\PYGZus{}name}\PYG{p}{(}\PYG{n}{A}\PYG{p}{)}
\PYG{g+go}{\PYGZsq{}lat\PYGZsq{}}
\end{sphinxVerbatim}

\end{fulllineitems}

\index{get\_depth\_name() (in module utils)@\spxentry{get\_depth\_name()}\spxextra{in module utils}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{utils_doc:utils.get_depth_name}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{utils.}}\sphinxbfcode{\sphinxupquote{get\_depth\_name}}}{\emph{da}}{}
Returns name of depth dimension in input array

\begin{DUlineblock}{0em}
\item[] Author: Thomas Moore
\item[] Date: 31/10/2018
\end{DUlineblock}
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{description}
\item[{\sphinxstylestrong{da}}] \leavevmode{[}xarray DataArray{]}
Array with coordinate corresponding to depth

\end{description}

\item[{Returns}] \leavevmode\begin{description}
\item[{\sphinxstylestrong{name}}] \leavevmode{[}str{]}
Name of dimension corresponding to depth

\end{description}

\end{description}\end{quote}
\subsubsection*{Examples}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{A} \PYG{o}{=} \PYG{n}{xr}\PYG{o}{.}\PYG{n}{DataArray}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{random}\PYG{o}{.}\PYG{n}{normal}\PYG{p}{(}\PYG{n}{size}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} 
\PYG{g+gp}{... }                 \PYG{n}{coords}\PYG{o}{=}\PYG{p}{[}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{lat}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{lon}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} 
\PYG{g+gp}{... }                         \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{depth}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{level}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{)}\PYG{p}{]}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{doppyo}\PYG{o}{.}\PYG{n}{utils}\PYG{o}{.}\PYG{n}{get\PYGZus{}depth\PYGZus{}name}\PYG{p}{(}\PYG{n}{A}\PYG{p}{)}
\PYG{g+go}{\PYGZsq{}depth\PYGZsq{}}
\end{sphinxVerbatim}

\end{fulllineitems}

\index{get\_level\_name() (in module utils)@\spxentry{get\_level\_name()}\spxextra{in module utils}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{utils_doc:utils.get_level_name}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{utils.}}\sphinxbfcode{\sphinxupquote{get\_level\_name}}}{\emph{da}}{}
Returns name of atmospheric level dimension in input array

\begin{DUlineblock}{0em}
\item[] Author: Dougie Squire
\item[] Date: 03/03/2018
\end{DUlineblock}
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{description}
\item[{\sphinxstylestrong{da}}] \leavevmode{[}xarray DataArray{]}
Array with coordinate corresponding to atmospheric level

\end{description}

\item[{Returns}] \leavevmode\begin{description}
\item[{\sphinxstylestrong{name}}] \leavevmode{[}str{]}
Name of dimension corresponding to atmospheric level

\end{description}

\end{description}\end{quote}
\subsubsection*{Examples}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{A} \PYG{o}{=} \PYG{n}{xr}\PYG{o}{.}\PYG{n}{DataArray}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{random}\PYG{o}{.}\PYG{n}{normal}\PYG{p}{(}\PYG{n}{size}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} 
\PYG{g+gp}{... }                 \PYG{n}{coords}\PYG{o}{=}\PYG{p}{[}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{lat}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{lon}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} 
\PYG{g+gp}{... }                         \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{depth}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{level}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{)}\PYG{p}{]}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{doppyo}\PYG{o}{.}\PYG{n}{utils}\PYG{o}{.}\PYG{n}{get\PYGZus{}level\PYGZus{}name}\PYG{p}{(}\PYG{n}{A}\PYG{p}{)}
\PYG{g+go}{\PYGZsq{}level\PYGZsq{}}
\end{sphinxVerbatim}

\end{fulllineitems}

\index{get\_plevel\_name() (in module utils)@\spxentry{get\_plevel\_name()}\spxextra{in module utils}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{utils_doc:utils.get_plevel_name}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{utils.}}\sphinxbfcode{\sphinxupquote{get\_plevel\_name}}}{\emph{da}}{}
Returns name of pressure level dimension in input array

\begin{DUlineblock}{0em}
\item[] Author: Dougie Squire
\item[] Date: 03/03/2018
\end{DUlineblock}
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{description}
\item[{\sphinxstylestrong{da}}] \leavevmode{[}xarray DataArray{]}
Array with coordinate corresponding to pressure level

\end{description}

\item[{Returns}] \leavevmode\begin{description}
\item[{\sphinxstylestrong{name}}] \leavevmode{[}str{]}
Name of dimension corresponding to pressure level

\end{description}

\end{description}\end{quote}
\subsubsection*{Examples}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{A} \PYG{o}{=} \PYG{n}{xr}\PYG{o}{.}\PYG{n}{DataArray}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{random}\PYG{o}{.}\PYG{n}{normal}\PYG{p}{(}\PYG{n}{size}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} 
\PYG{g+gp}{... }                 \PYG{n}{coords}\PYG{o}{=}\PYG{p}{[}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{lat}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{lon}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} 
\PYG{g+gp}{... }                         \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{depth}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{level}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{)}\PYG{p}{]}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{doppyo}\PYG{o}{.}\PYG{n}{utils}\PYG{o}{.}\PYG{n}{get\PYGZus{}plevel\PYGZus{}name}\PYG{p}{(}\PYG{n}{A}\PYG{p}{)}
\PYG{g+go}{\PYGZsq{}level\PYGZsq{}}
\end{sphinxVerbatim}

\end{fulllineitems}



\chapter{Indices and tables}
\label{\detokenize{index:indices-and-tables}}\begin{itemize}
\item {} 
\DUrole{xref,std,std-ref}{genindex}

\item {} 
\DUrole{xref,std,std-ref}{modindex}

\item {} 
\DUrole{xref,std,std-ref}{search}

\end{itemize}


\renewcommand{\indexname}{Python Module Index}
\begin{sphinxtheindex}
\let\bigletter\sphinxstyleindexlettergroup
\bigletter{d}
\item\relax\sphinxstyleindexentry{diagnostic}\sphinxstyleindexpageref{diagnostic_doc:\detokenize{module-diagnostic}}
\indexspace
\bigletter{s}
\item\relax\sphinxstyleindexentry{skill}\sphinxstyleindexpageref{skill_doc:\detokenize{module-skill}}
\indexspace
\bigletter{u}
\item\relax\sphinxstyleindexentry{utils}\sphinxstyleindexpageref{utils_doc:\detokenize{module-utils}}
\end{sphinxtheindex}

\renewcommand{\indexname}{Index}
\printindex
\end{document}